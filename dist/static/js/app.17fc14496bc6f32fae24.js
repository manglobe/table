webpackJsonp([1],{1e3:function(t,e,a){function n(t){a(917)}var s=a(19)(a(559),a(1021),n,null,null);t.exports=s.exports},1001:function(t,e,a){function n(t){a(918)}var s=a(19)(a(560),a(1022),n,null,null);t.exports=s.exports},1002:function(t,e,a){function n(t){a(916)}var s=a(19)(a(561),a(1020),n,"data-v-789a7ff7",null);t.exports=s.exports},1003:function(t,e,a){function n(t){a(907)}var s=a(19)(a(562),a(1011),n,null,null);t.exports=s.exports},1004:function(t,e,a){function n(t){a(910)}var s=a(19)(a(563),a(1014),n,null,null);t.exports=s.exports},1005:function(t,e,a){function n(t){a(909)}var s=a(19)(a(564),a(1013),n,null,null);t.exports=s.exports},1006:function(t,e,a){function n(t){a(913)}var s=a(19)(a(565),a(1017),n,null,null);t.exports=s.exports},1007:function(t,e,a){function n(t){a(912)}var s=a(19)(a(566),a(1016),n,null,null);t.exports=s.exports},1008:function(t,e,a){function n(t){a(911)}var s=a(19)(a(567),a(1015),n,null,null);t.exports=s.exports},1009:function(t,e,a){function n(t){a(919)}var s=a(19)(a(568),a(1023),n,null,null);t.exports=s.exports},1010:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"charts-box",attrs:{"data-option":t.options}},[a("div",{staticClass:"charts-controller"},[t._m(0),t._v(" "),a("ul",t._l(t.controllers,function(e){return a("li",{key:e.index,on:{click:function(a){t.changeHandle(e.value)}}},[t._v("\n        "+t._s(e.label)+"\n      ")])}))]),t._v(" "),a("div",{ref:"box",staticClass:"charts-display"})])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"controller-icons"},[a("i"),t._v(" "),a("i"),t._v(" "),a("i")])}]}},1011:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[a("w-header"),t._v(" "),a("w-sidebar"),t._v(" "),a("div",{staticClass:"content",attrs:{id:"content"}},[a("router-view"),t._v(" "),a("transition",{attrs:{name:"scroll"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.top>200,expression:"top > 200"}],staticClass:"scroll-to-up",on:{click:t.backToTop}},[a("i",{staticClass:"el-icon-caret-top"})])])],1)],1)},staticRenderFns:[]}},1012:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"spread-chart"},[a("IEcharts",{attrs:{option:t.spreadChart,notMerge:!0}}),t._v(" "),t.toggleEdit?a("div",{staticClass:"icon-wrap"},[a("i",{staticClass:"el-icon-check",staticStyle:{"margin-right":"5px"},on:{click:t.saveEdit}},[a("span",{staticClass:"icon-title-save"},[t._v("确认")])]),t._v(" "),a("i",{staticClass:"el-icon-close",on:{click:t.cancelEdit}},[a("span",{staticClass:"icon-title-cancel"},[t._v("取消")])])]):a("i",{staticClass:"el-icon-edit",on:{click:t.editTitle}},[a("span",{staticClass:"icon-title-edit"},[t._v("编辑标题")])]),t._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.toggleEdit,expression:"toggleEdit"}],attrs:{type:"textarea",autosize:{minRows:1},resize:"none",placeholder:"请输入标题"},model:{value:t.spreadTitle,callback:function(e){t.spreadTitle=e},expression:"spreadTitle"}})],1)},staticRenderFns:[]}},1013:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"gray-wrap"},[a("div",{staticClass:"preview",attrs:{id:"preview"}},[a("br"),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("div",{staticClass:"header"},[t._v("\n        树兰（杭州）医院"),a("br"),t._v("医院质量指标检测报告\n        "),a("span",{staticClass:"noprint print-btn",on:{click:t.htmlToCanvas}},[t._v("打印")])]),t._v(" "),a("div",{staticClass:"body"},[a("div",{staticClass:"paragraph"},[a("span",[t._v("1  指标名称：")]),t._v(" "),a("div",{staticClass:"content1"},[t._v(t._s(t.indicatorsInfo.quotaName||"暂无"))])]),t._v(" "),a("div",{staticClass:"paragraph"},[a("span",[t._v("2  指标类型：")]),t._v(" "),a("div",{staticClass:"content1"},[t._v(t._s(t.indicatorsInfo.quotaTypeName||"暂无"))])]),t._v(" "),a("div",{staticClass:"paragraph"},[a("div",[a("span",[t._v("3  指标定义：")]),t._v(" "),a("div",{staticClass:"content1"},t._l(t.indicatorsInfo.quotaDefinitions,function(e){return a("div",[t._v(t._s(e.quotaDefinitionName||"暂无"))])}))]),t._v(" "),a("div",{staticClass:"nav"},[a("span",[t._v("3.1  分子：")]),t._v(" "),a("div",{staticClass:"content1"},[t._v(t._s(t.indicatorsInfo.molecular||"暂无"))])]),t._v(" "),a("div",{staticClass:"nav"},[a("span",[t._v("3.2  分母：")]),t._v(" "),a("div",{staticClass:"content1"},[t._v(t._s(t.indicatorsInfo.denominator||"暂无"))])]),t._v(" "),a("div",{staticClass:"nav"},[a("span",[t._v("3.3  公式：")]),t._v(" "),a("div",{staticClass:"content1"},[t._v(t._s(t.formula))])])]),t._v(" "),a("div",{staticClass:"paragraph"},[a("span",[t._v("4  检测项目分析报告：")]),t._v(" "),t._l(t.indicatorsTable,function(e,n){return a("div",{staticClass:"figure-wrapper"},[a("div",{staticClass:"shen-table pdf-pagination"},[a("div",{staticClass:"table-title"},[t._v(t._s(e.tableName))]),t._v(" "),a("div",{staticClass:"table-body-wrapper"},[a("table",{staticClass:"table-body",attrs:{cellspacing:"0",cellpadding:"0"}},[a("thead",[a("tr",t._l(e.columns,function(e){return a("th",[t._v(t._s(e.columnName))])}))]),t._v(" "),a("tbody",t._l(e.rows,function(e){return a("tr",t._l(e.cellList,function(e){return a("td",[t._v(t._s(e.cellValue))])}))}))])])]),t._v(" "),"y"==e.isSelected?a("div",["0"!=e.imageType?a("div",{staticClass:"echarts pdf-pagination"},[a("IEcharts",{attrs:{option:t.charts[n]}})],1):t._e(),t._v(" "),t._l(t.spreadCharts[n],function(t,e){return a("div",{key:e,staticClass:"echarts pdf-pagination"},[a("IEcharts",{attrs:{option:t}})],1)})],2):t._e()])})],2),t._v(" "),a("div",{staticClass:"paragraph"},[a("span",[t._v("5  质量分析：")]),t._v(" "),0==t.qualityPics.length?a("span",[t._v("暂无")]):a("div",{staticClass:"content1"},t._l(t.qualityPics,function(t){return a("img",{attrs:{src:t}})}))]),t._v(" "),a("div",{staticClass:"paragraph"},[a("span",[t._v("6  原因分析：")]),t._v(" "),a("span",{staticClass:"editors",domProps:{innerHTML:t._s(t.reasonDOM)}})]),t._v(" "),a("div",{staticClass:"paragraph"},[a("span",[t._v("7  改进措施：")]),t._v(" "),a("span",{staticClass:"editors",domProps:{innerHTML:t._s(t.improveDOM)}})]),t._v(" "),a("div",{staticClass:"paragraph"},[a("span",[t._v("8  效果分析：")]),t._v(" "),0==t.effectivePics.length&&""==t.effectDOM?a("div",{staticClass:"content1"},[t._v("暂无")]):t._e(),t._v(" "),a("div",{staticClass:"content1"},[t._l(t.effectivePics,function(t){return a("img",{attrs:{src:t}})}),t._v(" "),a("span",{staticClass:"editors",domProps:{innerHTML:t._s(t.effectDOM)}})],2)])])])])},staticRenderFns:[]}},1014:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"side-bar"},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":t.currentPath,"unique-opened":"",router:""}},[a("el-menu-item",{attrs:{index:"/indicator/entr"},on:{click:t.initItem}},[a("i",{staticClass:"el-icon-edit"}),t._v("指标录入\n            ")]),t._v(" "),a("el-menu-item",{attrs:{index:"/indicator/libs"}},[a("i",{staticClass:"el-icon-menu"}),t._v("指标库\n            ")])],1)],1)},staticRenderFns:[]}},1015:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"steps"},[a("span",{staticClass:"step stepActive",on:{click:function(e){t.gotoStep(1)}}},[t._v("1、定义指标")]),t._v(" "),a("span",{staticClass:"step stepActive",on:{click:function(e){t.gotoStep(2)}}},[a("span",{staticClass:"arrow arrowActive"}),t._v("2、新增查检表")]),t._v(" "),t._m(0)]),t._v(" "),a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{size:"large",disabled:t.loading},on:{click:function(e){t.gotoStep(3)}}},[t._v("上一步")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"large",disabled:t.loading},on:{click:t.save}},[t._v("保 存")])],1),t._v(" "),a("div",{staticClass:"entry-step entry-step-4"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%",height:"100%"},attrs:{"element-loading-text":"拼命保存中"}}),t._v(" "),a("div",{staticClass:"entry-step-inner"},[a("div",{staticClass:"part"},[a("div",{staticClass:"title"},[t._v("质量分析：")]),t._v(" "),a("el-upload",{attrs:{action:"/file/upload",headers:t.headers,"before-upload":t.beforeAvatarUpload,"on-success":t.qualityAnalysisUploaded,"on-remove":t.removeQualityAnalysisPic,"file-list":t.filelist1,"list-type":"picture",multiple:""}},[a("el-button",{ref:"imgUpload",attrs:{type:"primary"}},[t._v("从文件中导入图片")])],1)],1),t._v(" "),a("div",{staticClass:"part"},[a("div",{staticClass:"title"},[t._v("原因分析：")]),t._v(" "),a("quill-editor",{ref:"editor",attrs:{options:t.editorOption},model:{value:t.oldResult.reasonAnalysis,callback:function(e){t.$set(t.oldResult,"reasonAnalysis",e)},expression:"oldResult.reasonAnalysis"}})],1),t._v(" "),a("div",{staticClass:"part"},[a("div",{staticClass:"title"},[t._v("改进措施：")]),t._v(" "),a("quill-editor",{attrs:{options:t.editorOption},model:{value:t.oldResult.improvementMeasure,callback:function(e){t.$set(t.oldResult,"improvementMeasure",e)},expression:"oldResult.improvementMeasure"}})],1),t._v(" "),a("div",{staticClass:"part"},[a("div",{staticClass:"title"},[t._v("效果分析：")]),t._v(" "),a("quill-editor",{staticStyle:{"margin-top":"20px"},attrs:{options:t.editorOption},model:{value:t.oldResult.effectiveAnalysis,callback:function(e){t.$set(t.oldResult,"effectiveAnalysis",e)},expression:"oldResult.effectiveAnalysis"}})],1)])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"step stepActive"},[a("span",{staticClass:"arrow arrowActive"}),t._v("3、分析结果")])}]}},1016:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"steps"},[a("span",{staticClass:"step stepActive",on:{click:function(e){t.confirmGotoStep(1)}}},[t._v("1、定义指标")]),t._v(" "),t._m(0),t._v(" "),a("span",{staticClass:"step",on:{click:function(e){t.confirmGotoStep(3)}}},[a("span",{staticClass:"arrow arrowActive"}),t._v("3、分析结果")])]),t._v(" "),a("div",{staticClass:"button-wrapper"},[a("div",{staticClass:"creat-excel-btn"},[a("el-button",{on:{click:t.addTable}},[a("i",{staticClass:"el-icon-plus",staticStyle:{"font-size":"16px","margin-right":"10px"}}),t._v("\n              新增表格\n            ")])],1),t._v(" "),a("el-button",{attrs:{size:"large"},on:{click:function(e){t.confirmGotoStep(1)}}},[t._v("上一步")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"large"},on:{click:function(e){t.confirmGotoStep(3)}}},[t._v("下一步")])],1),t._v(" "),a("div",{staticClass:"entry-step-2"},[a("div",{staticClass:"indicator-table"},t._l(t.indicatorsTable,function(e,n){return a("web-excel",{key:n,attrs:{"prop-table":e,id:n},on:{whetherSave:t.dependEdit}})}))]),t._v(" "),a("el-dialog",{attrs:{size:"tiny",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("i",{staticClass:"el-icon-warning",staticStyle:{"vertical-align":"top","margin-top":"10px","margin-right":"15px","font-size":"40px"}}),t._v(" "),a("div",{staticStyle:{display:"inline-block"}},[a("strong",{staticStyle:{"font-size":"18px"}},[t._v("您对表格有做修改，但尚未保存！")]),t._v(" "),a("div",{staticStyle:{"font-size":"15px","margin-top":"15px"}},[t._v("请点击表格右上角保存按钮进行保存")])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("知道了")])],1)])],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"step stepActive"},[a("span",{staticClass:"arrow arrowActive"}),t._v("2、新增图表")])}]}},1017:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"steps"},[a("span",{staticClass:"step stepActive"},[t._v("1、定义指标")]),t._v(" "),a("span",{staticClass:"step",on:{click:function(e){t.gotoStep(2)}}},[a("span",{staticClass:"arrow arrowActive"}),t._v("2、新增图表")]),t._v(" "),a("span",{staticClass:"step",on:{click:function(e){t.gotoStep(3)}}},[a("span",{staticClass:"arrow"}),t._v("3、分析结果")])]),t._v(" "),a("div",{staticClass:"entry-step entry-step-1"},[a("div",{staticClass:"qulity-form"},[a("div",{staticClass:"input-wrap",staticStyle:{"margin-right":"25px"}},[t._m(0),t._v(" "),a("el-select",{staticClass:"large-input",class:{warning:t.validate.floorId},attrs:{filterable:"",placeholder:"请选择"},on:{change:function(e){t.validate.floorId=!1}},model:{value:t.oldBaseInfo.floorId,callback:function(e){t.$set(t.oldBaseInfo,"floorId",e)},expression:"oldBaseInfo.floorId"}},t._l(t.floors,function(t){return a("el-option",{key:t.floorId,attrs:{label:t.floorName,value:t.floorId}})})),t._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.validate.floorId,expression:"validate.floorId"}],staticClass:"tips"},[t._v("请选择楼层")])])],1),t._v(" "),a("div",{staticClass:"input-wrap"},[t._m(1),t._v(" "),a("el-select",{staticClass:"large-input",class:{warning:t.validate.departmentId},attrs:{filterable:"",placeholder:"请选择"},on:{change:function(e){t.validate.departmentId=!1}},model:{value:t.oldBaseInfo.departmentId,callback:function(e){t.$set(t.oldBaseInfo,"departmentId",e)},expression:"oldBaseInfo.departmentId"}},t._l(t.depts,function(t){return a("el-option",{key:t.departmentId,attrs:{label:t.departmentName,value:t.departmentId}})})),t._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.validate.departmentId,expression:"validate.departmentId"}],staticClass:"tips"},[t._v("请选择专科")])])],1),t._v(" "),a("div",{staticClass:"input-wrap"},[t._m(2),t._v(" "),a("el-input",{staticClass:"large-input",class:{warning:t.validate.quotaName},attrs:{type:"textarea",autosize:{minRows:1},resize:"none",placeholder:"请输入"},on:{change:function(e){t.validate.quotaName=!1}},model:{value:t.oldBaseInfo.quotaName,callback:function(e){t.$set(t.oldBaseInfo,"quotaName",e)},expression:"oldBaseInfo.quotaName"}}),t._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.validate.quotaName,expression:"validate.quotaName"}],staticClass:"tips"},[t._v("请输入指标名称（不能超过600字）")])])],1),t._v(" "),a("div",{staticClass:"input-wrap"},[t._m(3),t._v(" "),a("el-select",{staticClass:"large-input",class:{warning:t.validate.quotaTypeId},attrs:{filterable:"",placeholder:"请选择"},on:{change:function(e){t.validate.quotaTypeId=!1}},model:{value:t.oldBaseInfo.quotaTypeId,callback:function(e){t.$set(t.oldBaseInfo,"quotaTypeId",e)},expression:"oldBaseInfo.quotaTypeId"}},t._l(t.types,function(t){return a("el-option",{key:t.quotaTypeId,attrs:{label:t.quotaTypeName,value:t.quotaTypeId}})})),t._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.validate.quotaTypeId,expression:"validate.quotaTypeId"}],staticClass:"tips"},[t._v("请选择指标类型")])])],1),t._v(" "),a("div",{staticClass:"input-wrap"},[t._m(4),t._v(" "),a("div",{staticClass:"definitions-list "},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},t._l(t.oldBaseInfo.quotaDefinitions,function(e,n){return a("div",{key:n,staticClass:"definition-item"},[a("el-input",{staticClass:"large-input",class:{warning:t.validate.quotaDefinitions[n]},attrs:{type:"textarea",autosize:{minRows:1},resize:"none",placeholder:"请输入"},on:{change:function(e){t.validate.quotaDefinitions[n]=!1}},model:{value:t.oldBaseInfo.quotaDefinitions[n],callback:function(e){t.$set(t.oldBaseInfo.quotaDefinitions,n,e)},expression:"oldBaseInfo.quotaDefinitions[index]"}}),t._v(" "),n==t.oldBaseInfo.quotaDefinitions.length-1?a("i",{staticClass:"el-icon-plus",staticStyle:{cursor:"pointer","margin-left":"10px","vertical-align":"top","margin-top":"9px",color:"#06AEA6","font-size":"16px"},on:{click:t.addQuotaDefinition}}):a("i",{staticClass:"el-icon-delete",staticStyle:{cursor:"pointer","margin-left":"10px","vertical-align":"top","margin-top":"9px",color:"#F36969","font-size":"16px"},on:{click:function(e){t.deleteQuotaDefinition(n)}}}),t._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.validate.quotaDefinitions[n],expression:"validate.quotaDefinitions[index]"}],staticClass:"tips"},[t._v("请输入指标定义（不能超过600字）")])])],1)}))],1)]),t._v(" "),a("div",{staticClass:"input-wrap"},[t._m(5),t._v(" "),a("el-input",{staticClass:"large-input",class:{warning:t.validate.molecular},attrs:{type:"textarea",autosize:{minRows:1},resize:"none",placeholder:"请输入"},on:{change:function(e){t.validate.molecular=!1}},model:{value:t.oldBaseInfo.molecular,callback:function(e){t.$set(t.oldBaseInfo,"molecular",e)},expression:"oldBaseInfo.molecular"}}),t._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.validate.molecular,expression:"validate.molecular"}],staticClass:"tips"},[t._v("请输入分子（不能超过600字）")])])],1),t._v(" "),a("div",{staticClass:"input-wrap"},[t._m(6),t._v(" "),a("el-input",{staticClass:"large-input",class:{warning:t.validate.denominator},attrs:{type:"textarea",autosize:{minRows:1},resize:"none",placeholder:"请输入"},on:{change:function(e){t.validate.denominator=!1}},model:{value:t.oldBaseInfo.denominator,callback:function(e){t.$set(t.oldBaseInfo,"denominator",e)},expression:"oldBaseInfo.denominator"}}),t._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.validate.denominator,expression:"validate.denominator"}],staticClass:"tips"},[t._v("请输入分母（不能超过600字）")])])],1),t._v(" "),a("div",{staticClass:"input-wrap",staticStyle:{display:"flex","align-items":"center"}},[t._m(7),t._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},[a("div",{staticClass:"formula-input"},[a("span",{staticClass:"bind-data",staticStyle:{"margin-left":"12px"}},[t.oldBaseInfo.molecular?a("span",[t._v(t._s(t.oldBaseInfo.molecular))]):a("span",{staticStyle:{color:"#ccc"}},[t._v("根据分子自动生成")])]),t._v("\n\t\t\t\t\t   /    \n\t\t\t\t\t"),a("span",{staticClass:"bind-data"},[t.oldBaseInfo.denominator?a("span",[t._v(t._s(t.oldBaseInfo.denominator))]):a("span",{staticStyle:{color:"#ccc"}},[t._v("根据分母自动生成")])])]),t._v(" "),a("span",{staticStyle:{"font-size":"20px","vertical-align":"middle","line-height":"30px",color:"#f36969"}},[t._v("*")]),t._v(" "),a("div",{staticStyle:{position:"relative",display:"inline-block",margin:"0 15px"}},[a("el-input",{class:{warning:t.validate.percentage},staticStyle:{width:"110px"},attrs:{placeholder:"请输入数字"},on:{change:function(e){t.validate.percentage=!1}},model:{value:t.oldBaseInfo.percentage,callback:function(e){t.$set(t.oldBaseInfo,"percentage",e)},expression:"oldBaseInfo.percentage"}}),t._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.validate.percentage,expression:"validate.percentage"}],staticClass:"tips",staticStyle:{width:"74px",left:"0px"}},[t._v("请输入数字（最多保留2位小数）")])])],1),t._v(" "),a("el-select",{staticClass:"percentage",attrs:{placeholder:"空"},model:{value:t.oldBaseInfo.formulaUnits,callback:function(e){t.$set(t.oldBaseInfo,"formulaUnits",e)},expression:"oldBaseInfo.formulaUnits"}},t._l(t.signs,function(t){return a("el-option",{key:t.key,attrs:{label:t.mark,value:t.key}})}))],1)],1),t._v(" "),a("el-button",{staticClass:"primary-btn",attrs:{type:"primary",size:"large"},on:{click:function(e){t.gotoStep(2)}}},[t._v("下一步")])],1)])])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"title2"},[a("span",{staticClass:"required"},[t._v("* ")]),t._v("楼层：")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"title2"},[a("span",{staticClass:"required"},[t._v("* ")]),t._v("专科：")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"title2 title-textarea"},[a("span",{staticClass:"required"},[t._v("* ")]),t._v("指标名称：")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"title2"},[a("span",{staticClass:"required"},[t._v("* ")]),t._v("指标类型：")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"title2 title-textarea",staticStyle:{"margin-top":"5px"}},[a("span",{staticClass:"required"},[t._v("* ")]),t._v("指标定义：\n\t\t\t\t\t")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"title2 title-textarea"},[a("span",{staticClass:"required"},[t._v("* ")]),t._v("分子：")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"title2 title-textarea"},[a("span",{staticClass:"required"},[t._v("* ")]),t._v("分母：")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"title2"},[a("span",{staticClass:"required"},[t._v("* ")]),t._v("公式：")])}]}},1018:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"shen"}},[a("router-view")],1)},staticRenderFns:[]}},1019:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"echart-item"},[a("div",{staticClass:"init-chart-wrapper"},[a("div",{staticStyle:{"margin-bottom":"10px","font-size":"16px"}},[t._v("基础图：如下图表由原始数据生成")]),t._v(" "),a("el-radio-group",{on:{change:t.changeBaseEChart},model:{value:t.whichChart,callback:function(e){t.whichChart=e},expression:"whichChart"}},[a("el-radio-button",{attrs:{label:"1"}},[t._v("折线图")]),t._v(" "),a("el-radio-button",{attrs:{label:"2"}},[t._v("柱状图")]),t._v(" "),a("el-radio-button",{attrs:{label:"0"}},[t._v("不生成图")])],1),t._v(" "),a("div",{staticStyle:{width:"540px",height:"300px"}},[t.toggleBaseEChart?a("IEcharts",{attrs:{option:t.chart}}):t._e()],1)],1),t._v(" "),a("div",{staticClass:"spread-chart-wrapper"},[a("div",{staticStyle:{"margin-bottom":"20px","font-size":"16px"}},[t._v("扩展图：选择如下不同的维度生成不同类别的图表")]),t._v(" "),a("el-checkbox-group",{on:{change:t.changeSpreadEChart},model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},[a("el-checkbox",{attrs:{label:"1"}},[t._v("以每行为维度分析")]),t._v(" "),a("el-checkbox",{attrs:{label:"2"}},[t._v("以每列为维度分析")]),t._v(" "),"generateTableFour"!=t.chart.tag?a("el-checkbox",{attrs:{label:"3"}},[t._v("柏拉图")]):t._e()],1),t._v(" "),t._l(t.spreadECharts,function(e,n){return a("echarts-spread",{key:n,attrs:{spreadChart:e},on:{eventToParent:t.eventOnChild}})})],2)])},staticRenderFns:[]}},1020:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"header"},[t._m(0),t._v(" "),a("div",{staticClass:"userinfo-wrap"},[a("img",{attrs:{src:"/static/imgs/Avatar.png"}}),t._v(" "),a("span",{staticStyle:{"margin-left":"10px","font-size":"12px"}},[t._v(t._s(t.userName))]),t._v(" "),a("span",{staticClass:"exit",on:{click:t.logout}},[t._v("退出")]),t._v(" "),a("form",{staticStyle:{display:"none"},attrs:{action:"/logout",method:"POST",id:"logoutForm"}},[a("input",{attrs:{type:"hidden",name:"_csrf"},domProps:{value:t.csrf}}),t._v(" "),a("input",{attrs:{type:"hidden",name:"_csrf_header",value:"X-XSRF-TOKEN"}}),t._v(" "),a("input",{staticClass:"login-submit",attrs:{type:"submit",value:"退出"}})])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"logo-wrap"},[a("img",{staticStyle:{"margin-left":"55px","margin-right":"66px"},attrs:{src:"/static/imgs/menuclose.png"}}),t._v(" "),a("img",{attrs:{src:"/static/imgs/logo.png"}}),t._v(" "),a("span",{staticClass:"line"},[t._v("质量指标系统")])])}]}},1021:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"mySelect",staticClass:"fake-select"},[t.svg?a("svg",{staticClass:"svg",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":t.svg}})]):t._e(),t._v(" "),a("span",[t._v(t._s(t.name))]),t._v(" "),a("i",{staticClass:"el-icon-arrow-down"}),t._v(" "),a("ul",t._l(t.options,function(e){return a("li",{key:e.index,on:{click:function(a){t.changeHandle(e.value)}}},[t._v("\n      "+t._s(e.label)+"\n    ")])}))])},staticRenderFns:[]}},1022:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isDelete?t._e():a("section",{ref:"excelWrap",staticClass:"excel-wrap"},[a("div",{staticClass:"flex-wrap"},[a("div",{staticClass:"btn-handle-2"},[a("el-button",{attrs:{type:"text",disabled:!t.isEdit,loading:t.saving},on:{click:t.saveTable}},[t._v("保存")]),t._v(" "),a("span",{staticClass:"line"}),t._v(" "),a("el-popover",{attrs:{trick:"click",placement:"top-end"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("p",[t._v("确定要删除该表格吗？")]),t._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.visible=!1}}},[t._v("\n            取消\n          ")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.deleteTable}},[t._v("\n            确定\n          ")])],1),t._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("删除表")])],1),t._v(" "),a("div",{staticClass:"tools"},[a("span",[t._v("fx")]),t._v(" "),a("input",{ref:"funcInput",attrs:{type:"text",readonly:""}}),t._v(" "),a("FakeSelect",{ref:"funcSelect",attrs:{svg:"#icon-gongshi",changeHandle:t.funcSelect,options:t.excelFunctionsOptions,name:"公式"}}),t._v(" "),a("FakeSelect",{attrs:{svg:"#icon-charutubiao",changeHandle:t.chartSelect,options:t.excelChartsOptions,name:"插入图表"}}),t._v(" "),a("FakeSelect",{attrs:{svg:"#icon-shengchengtubiao",changeHandle:t.chartSelectFull,options:t.excelChartsOptions,name:"自动生成图表"}})],1)],1),t._v(" "),a("div",{ref:"excel",staticClass:"hot htCenter handsontable htRowHeaders htColumnHeaders",attrs:{id:t.idName}}),t._v(" "),t._l(t.chartOptionsSourse,function(e,n){return a("div",{key:n,staticClass:"chart-wrap",class:{"title-editing":t.titleEditingIndex===n},on:{mouseenter:function(){return t.toggleChartsRange(e,!0)},mouseleave:function(){return t.toggleChartsRange(e,!1)}}},[a("div",{staticClass:"chart-layer",on:{click:function(){return t.quitChartEditor(n)}}}),t._v(" "),a("div",{staticClass:"chart-title-editor"},[a("input",{attrs:{type:"text",autofocus:""},domProps:{value:e.title},on:{keydown:function(e){return t.titleEditorKeydownHandle(e,n)},input:function(e){t.chartTitleEditorCacheValue=e.target.value}}}),t._v(" "),a("i",{staticClass:"el-icon-close",attrs:{title:"取消"},on:{click:function(){return t.quitChartEditor(n,!1)}}}),t._v(" "),a("i",{staticClass:"el-icon-check",attrs:{title:"保存"},on:{click:function(e){return t.quitChartEditor(n,!0)}}})]),t._v(" "),a("Charts",{attrs:{optionsSourse:e,changeHandle:function(e){return t.chartControllerHandle(e,n)},chartsUnit:t.excelCharts}})],1)})],2)])},staticRenderFns:[]}},1023:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"indicator-lib"},[a("section",{staticClass:"form-wrap"},[a("div",{staticClass:"handle-wrap"},[a("span",{staticClass:"input-title"},[t._v("指标名称：")]),t._v(" "),a("el-input",{staticClass:"large-input",attrs:{placeholder:"请输入"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.search(e):null}},model:{value:t.indicator,callback:function(e){t.indicator=e},expression:"indicator"}})],1),t._v(" "),a("div",{staticClass:"handle-wrap"},[a("span",[a("span",{staticClass:"input-title"},[t._v("楼层：")]),t._v(" "),a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:t.floorId,callback:function(e){t.floorId=e},expression:"floorId"}},t._l(t.floors,function(t){return a("el-option",{key:t.floorId,attrs:{label:t.floorName,value:t.floorId}})}))],1),t._v(" "),a("span",[a("span",{staticClass:"input-title"},[t._v("专科：")]),t._v(" "),a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:t.deptId,callback:function(e){t.deptId=e},expression:"deptId"}},t._l(t.depts,function(t){return a("el-option",{key:t.departmentId,attrs:{label:t.departmentName,value:t.departmentId}})}))],1)]),t._v(" "),a("div",{staticClass:"handle-wrap"},[a("span",{staticClass:"input-title"},[t._v("录入人员：")]),t._v(" "),a("el-input",{staticClass:"large-input",attrs:{placeholder:"请输入"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.search(e):null}},model:{value:t.person,callback:function(e){t.person=e},expression:"person"}})],1),t._v(" "),a("div",{staticClass:"handle-wrap"},[a("span",{staticClass:"input-title"},[t._v("录入时间：")]),t._v(" "),a("el-date-picker",{staticClass:"date-input large-input",attrs:{type:"daterange",placeholder:"开始时间 - 结束时间",clearable:""},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),t._v(" "),a("div",{staticStyle:{"text-align":"center","margin-bottom":"25px"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("\n\t\t\t查 询\n\t\t\t")]),t._v(" "),a("el-button",{on:{click:t.reset}},[t._v("\n\t\t\t重 置\n\t\t\t")])],1)]),t._v(" "),a("section",{staticClass:"display-wrap"},[a("div",{staticClass:"table-title"},[t._v("质量指标库")]),t._v(" "),a("div",{staticClass:"handle-table"},[a("el-button",{attrs:{type:"text"}},[t._v("导出")]),t._v(" "),a("span",{staticClass:"line"}),t._v(" "),a("el-button",{attrs:{type:"text"}},[t._v("打印")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticStyle:{width:"1082"},attrs:{data:t.tableData,"element-loading-text":"拼命加载中","empty-text":"没有您查询的结果，请重新输入条件查询",stripe:""}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{label:"序列",type:"index",width:"70"}}),t._v(" "),a("el-table-column",{attrs:{prop:"quotaName",label:"指标名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"录入人员"}}),t._v(" "),a("el-table-column",{attrs:{prop:"recordDate",label:"录入时间"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{"font-family":"Microsoft YaHei"},attrs:{type:"text"},on:{click:function(a){t.edit(e.row)}}},[t._v("\n\t\t\t\t\t编辑\n\t\t\t\t\t")]),t._v(" "),a("el-button",{staticStyle:{"font-family":"Microsoft YaHei"},attrs:{type:"text"},on:{click:function(a){t.deleteRow(e.row)}}},[t._v("\n\t\t\t\t\t删除\n\t\t\t\t\t")]),t._v(" "),a("router-link",{staticStyle:{"margin-left":"10px",color:"#06aea6","text-decoration":"none"},attrs:{to:{name:"preview",query:{quotaId:e.row.quotaId}},target:"_blank"}},[t._v("\n\t\t\t\t\t预览\n\t\t\t\t\t")])]}}])})],1),t._v(" "),a("el-pagination",{attrs:{"current-page":t.curPage,"page-sizes":[10,15,20,30],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.totalPages},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t._v(" "),a("el-dialog",{attrs:{title:"提示",visible:t.indicatorDialogVisible,top:"4%","show-close":!1},on:{"update:visible":function(e){t.indicatorDialogVisible=e}}},[a("span",[t._v("您确定要删除该指标么？")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.confirmDel}},[t._v("确定")]),t._v(" "),a("el-button",{on:{click:function(e){t.indicatorDialogVisible=!1}}},[t._v("取消")])],1)])],1)])},staticRenderFns:[]}},42:function(t,e,a){"use strict";var n=a(117),s=a.n(n),i=a(173),r=a.n(i),o={deepClone:function(t){var e=void 0,a=t.constructor===Array?[]:{};if("object"===(void 0===t?"undefined":r()(t))){if(window.JSON)e=s()(t),a=JSON.parse(e);else for(var n in t)a[n]="object"===r()(t[n])?clone(t[n]):t[n];return a}},toUrl:function(t){var e=[];for(var a in t){var n=t[a];e.push(a+"="+n)}return e.join("&")},uuid:function(){for(var t=[],e="0123456789abcdef",a=0;a<32;a++)t[a]=e.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=e.substr(3&t[19]|8,1),t.join("")},lineFeed:function(t,e){var a=t.length,n=Math.ceil(a/e);if(-1!=t.indexOf("\n"))return t;if(t.length>e){for(var s=t.split(""),i=1;i<n;i++)s.splice(e*i+(i-1),0,"\n");return s.join("")}return t}};e.a=o},524:function(t,e,a){"use strict";var n=a(27),s=a(1025),i=a(1003),r=a.n(i),o=a(1006),l=a.n(o),c=a(1007),u=a.n(c),d=a(1008),_=a.n(d),f=a(1009),p=a.n(f),h=a(1005),v=a.n(h);n.default.use(s.a),e.a=new s.a({routes:[{path:"/",redirect:"/indicator/entryStep1"},{path:"/indicator/entr",redirect:"/indicator/entryStep1"},{path:"/indicator",component:r.a,children:[{path:"entryStep1",name:"entryStep1",component:l.a},{path:"entryStep2",name:"entryStep2",component:u.a},{path:"entryStep3",name:"entryStep3",component:_.a},{path:"libs",name:"libs",component:p.a}]},{path:"/preview",name:"preview",component:v.a}]})},525:function(t,e,a){"use strict";var n=a(117),s=a.n(n),i=a(258),r=a.n(i),o=a(27),l=a(88),c=a(59);o.default.use(l.b);var u={userInfo:{},csrf:{},depts:[],floors:[],types:[],oldBaseInfo:{denominator:"",departmentId:"",floorId:"",molecular:"",percentage:"",quotaName:"",quotaTypeId:"",quotaDefinitions:[null],formulaUnits:"%"},indicatorsTable:[]},d=window.sessionStorage,_={loadUserInfo:function(t){var e=t.commit;c.a.getUserInfo().then(function(t){t.hasOwnProperty("userAdminInfo")?e("SET_USER_INFO",{userInfo:t.userAdminInfo}):(e("SET_USER_INFO",{userInfo:null}),r.a.error({title:"错误："+t,message:"获取用户信息失败!"}))})},loadDepts:function(t){var e=t.commit;c.a.getDepts().then(function(t){e("SET_DEPTS",{depts:t.result})})},loadFloors:function(t){var e=t.commit;c.a.getFloors().then(function(t){e("SET_FLOORS",{floors:t.result})})},loadTypes:function(t){var e=t.commit;c.a.getTypes().then(function(t){e("SET_TYPES",{types:t.responseData.resultList})})}},f={SET_USER_INFO:function(t,e){var a=e.userInfo;t.userInfo=a,d.setItem("userInfo",s()(t.userInfo))},CSRF:function(t,e){t.csrf=e},SET_DEPTS:function(t,e){var a=e.depts;t.depts=a},SET_FLOORS:function(t,e){var a=e.floors;t.floors=a},SET_TYPES:function(t,e){var a=e.types;t.types=a},SET_ECHARTS:function(t,e){t.indicatorsTable=e}},p={userInfoGetter:function(t){return 0==t.userInfo.length&&(t.userInfo=JSON.parse(d.getItem("userInfo"))),t.userInfo},quotaIdGetter:function(t){return t.quotaId}};e.a=new l.b.Store({state:u,getters:p,mutations:f,actions:_})},526:function(t,e,a){"use strict";var n={dateArrayFormat:function(t){var e=this;return t.map(function(t,a,n){return e.dateFormat(t)})},dateFormat:function(t){var e=t.getMonth()+1;e<10&&(e="0"+e);var a=t.getDate();return a<10&&(a="0"+a),t.getFullYear()+"-"+e+"-"+a},fullDateformat:function(t){var e=t.getMonth()+1;e<10&&(e="0"+e);var a=t.getDate();a<10&&(a="0"+a);var n=t.getHours();n<10&&(n="0"+n);var s=t.getMinutes();s<10&&(s="0"+s);var i=t.getSeconds();return i<10&&(i="0"+i),t.getFullYear()+"-"+e+"-"+a+" "+n+":"+s+":"+i}};e.a=n},527:function(t,e,a){"use strict";function n(t){var e=[],a=!0,n=!1,l=void 0;try{for(var c,u=d()(t);!(a=(c=u.next()).done);a=!0){var p=c.value,h={id:p.tableId,tag:p.tableModelFlag,mainType:p.imageType,spreadType:p.flagList,xaxisName:p.xaxisName,yaxisName:p.yaxisName,platoName:p.platoName,notPercentage:s(p.rows),color:f,title:{text:_.a.lineFeed(p.tableName,22),x:"center",width:200,textStyle:{fontSize:15,fontWeight:"normal",width:100},rich:{a:{width:100}}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:r(p.rows),top:35,formatter:function(t){return t.length>3&&-1==location.hash.indexOf("preview")?t.slice(0,3)+"...":t},tooltip:{show:!0}},xAxis:{data:i(p.columns),axisLabel:{interval:0,formatter:function(t){var e=t.length,a=Math.ceil(e/4);if(t.length>4){for(var n=t.split(""),s=1;s<a;s++)n.splice(4*s+(s-1),0,"\n");return n.join("")}return t}}},yAxis:[{type:"value",name:"",axisLabel:{formatter:s(p.rows)?"{value}%":"{value}"}}],series:o(p.rows,p.imageType)};e.push(h)}}catch(t){n=!0,l=t}finally{try{!a&&u.return&&u.return()}finally{if(n)throw l}}return e}function s(t){return t.some(function(t){var e=c()(t.cellList);e[0];return 1==e.slice(1).some(function(t){return-1!==(t.cellValue+"").indexOf("%")})})}function i(t){var e=[],a=c()(t),n=(a[0],a.slice(1)),s=!0,i=!1,r=void 0;try{for(var o,l=d()(n);!(s=(o=l.next()).done);s=!0){var u=o.value;e.push(u.columnName)}}catch(t){i=!0,r=t}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}return e}function r(t){var e=[],a=!0,n=!1,s=void 0;try{for(var i,r=d()(t);!(a=(i=r.next()).done);a=!0){var o=i.value,l=c()(o.cellList),u=l[0];l.slice(1);e.push(u.cellValue)}}catch(t){n=!0,s=t}finally{try{!a&&r.return&&r.return()}finally{if(n)throw s}}return e}function o(t,e){var a=[],n=!0,s=!1,i=void 0;try{for(var r,o=d()(t);!(n=(r=o.next()).done);n=!0){var l=r.value,u=c()(l.cellList),_=u[0],f=u.slice(1),h=[],v=!0,m=!1,g=void 0;try{for(var b,y=d()(f);!(v=(b=y.next()).done);v=!0){var C=b.value,E=C.cellValue?C.cellValue.replace("%",""):C.cellValue;h.push(E)}}catch(t){m=!0,g=t}finally{try{!v&&y.return&&y.return()}finally{if(m)throw g}}a.push({name:_.cellValue,type:p[e],data:h})}}catch(t){s=!0,i=t}finally{try{!n&&o.return&&o.return()}finally{if(s)throw i}}return a}e.a=n;var l=a(580),c=a.n(l),u=a(36),d=a.n(u),_=a(42),f=["#ffb847","#29cdff","#7dd97c","#00b4a9","#239af6","#fe6b28","#fd8b8f","#7a6cf7","#779de9","#c23030","#08b53f","#f8e81c"],p={1:"line",2:"bar",0:"pie"}},528:function(t,e,a){"use strict";function n(t,e){var a={type:e,id:t.id,color:_[parseInt(e)],title:{text:"1"!=e?"2"==e?d.a.lineFeed(t.yaxisName,22):d.a.lineFeed(t.platoName,22):d.a.lineFeed(t.xaxisName,22),x:"center",textStyle:{fontSize:15,fontWeight:"normal"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:{data:r(t,e),axisLabel:{interval:0,formatter:function(t){var e=t.length,a=Math.ceil(e/4);if(t.length>4){for(var n=t.split(""),s=1;s<a;s++)n.splice(4*s+(s-1),0,"\n");return n.join("")}return t}}},yAxis:[{type:"value",name:"次数",axisLabel:{formatter:t.notPercentage?"{value}%":"{value}"}}],series:o(t,e)};return"3"==e&&a.yAxis.push({type:"value",name:"累计百分比",axisLabel:{formatter:"{value}%"}}),a}function s(t){for(var e=[],a=0;a<t.series[0].data.length;a++){e[a]=0;for(var n=0;n<t.series.length;n++)e[a]+=Number(t.series[n].data[a])}return{data:e,type:"bar",barWidth:20}}function i(t){var e=[];return t.series.map(function(t){var a=t.data.reduce(function(t,e){return Number(t)+Number(e)});e.push(a)}),{data:e,type:"bar",barWidth:20}}function r(t,e){switch(e){case"1":return t.legend.data;case"2":return t.xAxis.data;case"3":return"generateTableTwo"==t.tag?l(i(t),t.legend.data)[1]:l(s(t),t.xAxis.data)[1]}}function o(t,e){switch(e){case"1":return i(t);case"2":return s(t);case"3":return"generateTableTwo"==t.tag?l(i(t),t.legend.data)[0]:l(s(t),t.xAxis.data)[0]}}function l(t,e){for(var a=d.a.deepClone(t.data),n=d.a.deepClone(e),s=0;s<a.length;s++)for(var i=0;i<a.length-1-s;i++)if(parseInt(a[i])<parseInt(a[i+1])){var r=a[i+1];a[i+1]=a[i],a[i]=r;var o=n[i+1];n[i+1]=n[i],n[i]=o}return[[{data:c(a),type:"bar",barCategoryGap:"0%",barWidth:""},{data:u(a),type:"line",yAxisIndex:1}],n]}function c(t){return t.map(function(t){return{value:t,itemStyle:{normal:{borderColor:""}}}})}function u(t){for(var e=t.reduce(function(t,e){return t+e}),a=[],n=0;n<t.length;n++)a[n]=0==n?parseInt(t[n])/e*100:parseInt(t[n])/e*100+parseFloat(a[n-1]);return a.map(function(t){return parseFloat(t.toFixed(2))})}e.a=n;var d=a(42),_=["#fe6b28",["#ffb847"],["#7a6cf7"],["#3398db","#fe6b28"]]},529:function(t,e,a){"use strict";var n={string:function(t){return!t||t.length>600},value:function(t){return!t},number:function(t){return!!(!t||isNaN(Number(t))||t.length>5)},array:function(t){var e=this;return t.map(function(t){return!(t&&!e.string(t))})},phone:function(t){if(!/^1[34578]\d{9}$/.test(t))return!0},chinese:function(t){return new RegExp("[\\u4E00-\\u9FFF]+","g").test(t)}};e.a=n},531:function(t,e){},532:function(t,e){},533:function(t,e){},534:function(t,e){},535:function(t,e,a){function n(t){a(914)}var s=a(19)(a(555),a(1018),n,null,null);t.exports=s.exports},536:function(t,e){!function(t){function e(){var t,e;t=document.createElement("div"),t.innerHTML=a,a=null,(e=t.getElementsByTagName("svg")[0])&&(e.setAttribute("aria-hidden","true"),e.style.position="absolute",e.style.width=0,e.style.height=0,e.style.overflow="hidden",r(e,document.body))}var a='<svg><symbol id="icon-zhuyi" viewBox="0 0 1024 1024"><path d="M512 0c282.752 0 512 229.248 512 512 0 282.794667-229.248 512-512 512S0 794.794667 0 512C0 229.290667 229.248 0 512 0z m0 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768z m-42.666667-298.538667v-341.333333h85.333334v341.333333h-85.333334z m0 170.666667v-85.333333h85.333334v85.333333h-85.333334z" fill="#FE9901" ></path></symbol><symbol id="icon-charutubiao" viewBox="0 0 1024 1024"><path d="M800 1024C678.4 1024 576 921.6 576 800S678.4 576 800 576s224 102.4 224 224-102.4 224-224 224z m0-384c-89.6 0-160 70.4-160 160s70.4 160 160 160 160-70.4 160-160-70.4-160-160-160zM512 768H384c-38.4 0-64-25.6-64-64V64c0-38.4 25.6-64 64-64h128c38.4 0 64 25.6 64 64v556.8l-6.4 6.4c-25.6 32-44.8 70.4-51.2 115.2L512 768zM384 64v640h76.8c12.8-38.4 25.6-76.8 51.2-108.8V64H384zM192 768H64c-38.4 0-64-25.6-64-64V256c0-38.4 25.6-64 64-64h128c38.4 0 64 25.6 64 64v448c0 38.4-25.6 64-64 64zM64 256v448h128V256H64z m0-32V256v-32z m576 332.8V320c0-38.4 25.6-64 64-64h128c38.4 0 64 25.6 64 64v204.8l-38.4-6.4c-57.6-12.8-121.6-6.4-172.8 19.2l-44.8 19.2zM704 320v140.8c38.4-12.8 83.2-12.8 128-12.8V320h-128z" fill="#CCCCCC" ></path><path d="M704 768h192v64h-192z" fill="#CCCCCC" ></path><path d="M768 704h64v192h-64z" fill="#CCCCCC" ></path></symbol><symbol id="icon-shanchu" viewBox="0 0 1024 1024"><path d="M256 0h512v128H256zM0 128h1024v128H0zM896 1024H128V256h768v768zM256 896h512V384H256v512z" fill="#F36969" ></path><path d="M384 448h64v320H384zM576 448h64v320H576z" fill="#F36969" ></path></symbol><symbol id="icon-hebingxingzhuang" viewBox="0 0 1097 1024"><path d="M928.914286 1024l-14.628572-73.142857c-36.571429-160.914286-168.228571-285.257143-336.457143-307.2V877.714286L0 438.857143l577.828571-438.857143v234.057143c270.628571 0 482.742857 204.8 482.742858 460.8 0 95.085714-29.257143 182.857143-87.771429 263.314286l-43.885714 65.828571zM504.685714 563.2h36.571429c182.857143 14.628571 343.771429 131.657143 409.6 292.571429 21.942857-51.2 36.571429-102.4 36.571428-160.914286 0-219.428571-182.857143-394.971429-416.914285-394.971429h-65.828572V138.971429L109.714286 438.857143l394.971428 299.885714V563.2z" fill="#979797" ></path></symbol><symbol id="icon-gongshi" viewBox="0 0 1024 1024"><path d="M512 1024c-281.6 0-512-230.4-512-512s230.4-512 512-512 512 230.4 512 512-230.4 512-512 512zM512 64C262.4 64 64 262.4 64 512s198.4 448 448 448 448-198.4 448-448-198.4-448-448-448z" fill="#CCCCCC" ></path><path d="M313.6 704V416h-51.2v-44.8h51.2v-32c0-19.2 0-38.4 6.4-51.2 0-12.8 12.8-25.6 25.6-38.4 12.8-6.4 32-12.8 57.6-12.8 12.8 0 32 0 51.2 6.4l-6.4 51.2h-32c-19.2-6.4-32 0-38.4 6.4s-12.8 19.2-12.8 38.4v32h64v44.8h-64V704h-51.2zM441.6 704l121.6-172.8L448 371.2h70.4L569.6 448c6.4 19.2 19.2 32 19.2 38.4 12.8-12.8 19.2-25.6 25.6-38.4l57.6-76.8h64L627.2 531.2l121.6 172.8h-70.4l-64-102.4-19.2-25.6-89.6 128h-64z" fill="#CCCCCC" ></path></symbol><symbol id="icon-shousuolan" viewBox="0 0 1228 1024"><path d="M0 0h1228.8v102.4H0zM409.6 460.8h819.2v102.4H409.6zM0 512l204.8-102.4v204.8zM0 921.6h1228.8v102.4H0z" fill="#bfbfbf" ></path></symbol><symbol id="icon-icon-zengjia" viewBox="0 0 1024 1024"><path d="M448 448V0h128v448h448v128H576v448H448V576H0V448h448z" fill="#06AEA6" ></path></symbol><symbol id="icon-icon-zhibiaoku" viewBox="0 0 1024 1024"><path d="M102.4 0h819.2a102.4 102.4 0 0 1 102.4 102.4v819.2a102.4 102.4 0 0 1-102.4 102.4H102.4a102.4 102.4 0 0 1-102.4-102.4V102.4a102.4 102.4 0 0 1 102.4-102.4z m51.2 409.6v460.8h102.4V409.6H153.6z m204.8-153.6v614.4h102.4V256H358.4z m204.8 256v358.4h102.4v-358.4h-102.4z m204.8 102.4v256h102.4v-256h-102.4z" fill="#06AEA6" ></path></symbol><symbol id="icon-icon-luruzhibiao" viewBox="0 0 1024 1024"><path d="M870.4 972.8l153.6 0 0 51.2-153.6 0 0-51.2Z" fill="#666666" ></path><path d="M665.6 972.8l153.6 0 0 51.2-153.6 0 0-51.2Z" fill="#666666" ></path><path d="M870.4 365.6704L212.0704 1024H102.4a102.4 102.4 0 0 1-102.4-102.4V102.4a102.4 102.4 0 0 1 102.4-102.4h665.6a102.4 102.4 0 0 1 102.4 102.4v263.2704zM204.8 153.6a51.2 51.2 0 1 0 0 102.4h307.2a51.2 51.2 0 0 0 0-102.4H204.8z m0 256a51.2 51.2 0 1 0 0 102.4h204.8a51.2 51.2 0 1 0 0-102.4H204.8z m0 256a51.2 51.2 0 0 0 0 102.4h102.4a51.2 51.2 0 0 0 0-102.4H204.8z" fill="#666666" ></path><path d="M204.8 870.4h153.6v153.6H204.8zM735.4368 635.5968l108.032 108.0832-217.1904 217.2416-108.032-108.0832 217.1904-217.2416z m108.5952-108.5952l108.0832 108.032-72.3968 72.448-108.032-108.032 72.3456-72.448z m-380.416 488.448l18.432-126.4128 108.032 108.032-126.464 18.432z" fill="#666666" ></path></symbol><symbol id="icon-CellCheck" viewBox="0 0 1210 1024"><path d="M139.636364 512L0 651.636364l372.363636 372.363636 837.818182-791.272727L1070.545455 93.090909 372.363636 744.727273z" fill="#06AEA6" ></path></symbol><symbol id="icon-close" viewBox="0 0 1024 1024"><path d="M1024 102.4L921.6 0 512 409.6 102.4 0 0 102.4 409.6 512 0 921.6 102.4 1024 512 614.4l409.6 409.6 102.4-102.4L614.4 512z" fill="#CCCCCC" ></path></symbol></svg>',n=function(){var t=document.getElementsByTagName("script");return t[t.length-1]}(),s=n.getAttribute("data-injectcss"),i=function(t,e){e.parentNode.insertBefore(t,e)},r=function(t,e){e.firstChild?i(t,e.firstChild):e.appendChild(t)};if(s&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(t){console&&console.log(t)}}!function(e){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(e,0);else{var a=function(){document.removeEventListener("DOMContentLoaded",a,!1),e()};document.addEventListener("DOMContentLoaded",a,!1)}else document.attachEvent&&function(t,e){var a=t.document,n=!1,s=function(){n||(n=!0,e())},i=function(){try{a.documentElement.doScroll("left")}catch(t){return void setTimeout(i,50)}s()};i(),a.onreadystatechange=function(){"complete"==a.readyState&&(a.onreadystatechange=null,s())}}(t,e)}(e)}(window)},555:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"shen"}},556:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(134),s=a.n(n);e.default={props:{optionsSourse:{type:Object},changeHandle:{type:Function},chartsUnit:{type:Object}},data:function(){return{chart:{},controllers:[{value:"transpose",label:"切换行/列"},{value:"editorTitle",label:"修改标题"},{value:"delete",label:"删除图表"}]}},computed:{options:function(){return this.chartsUnit[this.optionsSourse.type].func(this.optionsSourse)}},method:{},mounted:function(){this.chart=s.a.init(this.$refs.box),this.chart.setOption(this.options)},updated:function(){this.chart.clear(),this.chart.setOption(this.options)}}},557:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(154);e.default={props:{spreadChart:{type:Object}},components:{IEcharts:n.a},data:function(){return{toggleEdit:!1,spreadTitle:this.spreadChart.title.text,tempTitle:this.spreadChart.title.text}},methods:{editTitle:function(){this.toggleEdit=!this.toggleEdit},saveEdit:function(){var t=this;this.spreadChart.title.text=this.$handleObject.lineFeed(this.spreadTitle,22),this.tempTitle=this.spreadTitle,this.$store.state.indicatorsTable.map(function(e){if(e.tableId==t.spreadChart.id)switch(t.spreadChart.type){case"1":e.xaxisName=t.spreadTitle,t.$emit("eventToParent",{xaxisName:t.spreadTitle});break;case"2":e.yaxisName=t.spreadTitle,t.$emit("eventToParent",{yaxisName:t.spreadTitle});break;case"3":e.platoName=t.spreadTitle,t.$emit("eventToParent",{platoName:t.spreadTitle})}}),this.toggleEdit=!1},cancelEdit:function(){this.toggleEdit=!1,this.spreadTitle=this.tempTitle,this.spreadChart.title.text=this.tempTitle}}}},558:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(170),s=a.n(n),i=a(89),r=a.n(i),o=a(36),l=a.n(o),c=a(154),u=a(998),d=a.n(u),_=a(195),f=(a.n(_),a(203)),p=(a.n(f),a(207)),h=(a.n(p),a(225)),v=(a.n(h),a(231)),m=(a.n(v),a(230));a.n(m);e.default={props:{chart:{type:Object}},components:{IEcharts:c.a,echartsSpread:d.a},data:function(){return{whichChart:this.chart.mainType,chartsType:{1:"line",2:"bar",0:"pie"},checkList:this.chart.spreadType||[],toggleBaseEChart:"0"!=this.chart.mainType,spreadECharts:[],tableMap:{generateTableOne:{rowName:"月份",colName:"项目"},generateTableTwo:{rowName:"项目",colName:"月份"},generateTableThree:{rowName:"科室",colName:"项目"},generateTableFour:{rowName:"科室",colName:"月份"}}}},computed:{tempChart:function(){return this.chart}},created:function(){this.changeSpreadEChart()},methods:{changeBaseEChart:function(){var t=this;this.toggleBaseEChart="0"!=this.whichChart,this.$store.state.indicatorsTable.map(function(e){e.tableId==t.chart.id&&(e.imageType=t.whichChart)}),this.chart.series.map(function(e){e.type=t.chartsType[t.whichChart]})},eventOnChild:function(t){var e=!0,a=!1,n=void 0;try{for(var i,o=l()(r()(this.tempChart));!(e=(i=o.next()).done);e=!0){var c=i.value;c==r()(t)[0]&&(this.tempChart[c]=s()(t)[0])}}catch(t){a=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(a)throw n}}},changeSpreadEChart:function(){var t=this;this.spreadECharts=[],this.checkList.sort().map(function(e){t.spreadECharts.push(t.toSpreadEChart(t.tempChart,e))}),this.$store.state.indicatorsTable.map(function(e){e.tableId==t.chart.id&&(e.flagList=t.$handleObject.deepClone(t.checkList))})}}}},559:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["changeHandle","options","name","svg"],data:function(){return{}},methods:{}}},560:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__(117),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__=__webpack_require__(119),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator__=__webpack_require__(36),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator__),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_toConsumableArray__=__webpack_require__(172),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_toConsumableArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_toConsumableArray__),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for__=__webpack_require__(576),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for__),__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys__=__webpack_require__(89),__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_6_handsontable_pro__=__webpack_require__(920),__WEBPACK_IMPORTED_MODULE_6_handsontable_pro___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_handsontable_pro__),__WEBPACK_IMPORTED_MODULE_7_sheetclip__=__webpack_require__(994),__WEBPACK_IMPORTED_MODULE_7_sheetclip___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_sheetclip__),__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__=__webpack_require__(573),__WEBPACK_IMPORTED_MODULE_9__util_handleObject__=__webpack_require__(42),__WEBPACK_IMPORTED_MODULE_10_handsontable_pro_dist_handsontable_full_css__=__webpack_require__(902),__WEBPACK_IMPORTED_MODULE_10_handsontable_pro_dist_handsontable_full_css___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_10_handsontable_pro_dist_handsontable_full_css__),__WEBPACK_IMPORTED_MODULE_11__fakeSelect_vue__=__webpack_require__(1e3),__WEBPACK_IMPORTED_MODULE_11__fakeSelect_vue___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_11__fakeSelect_vue__),__WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__=__webpack_require__(569),__WEBPACK_IMPORTED_MODULE_13__components_echartsWrapper_vue__=__webpack_require__(999),__WEBPACK_IMPORTED_MODULE_13__components_echartsWrapper_vue___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_13__components_echartsWrapper_vue__),__WEBPACK_IMPORTED_MODULE_14_vue_echarts_v3_src_full_js__=__webpack_require__(996),__WEBPACK_IMPORTED_MODULE_15__components_echartsBox_vue__=__webpack_require__(997),__WEBPACK_IMPORTED_MODULE_15__components_echartsBox_vue___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_15__components_echartsBox_vue__);__webpack_exports__.default={components:{FakeSelect:__WEBPACK_IMPORTED_MODULE_11__fakeSelect_vue___default.a,IEcharts:__WEBPACK_IMPORTED_MODULE_14_vue_echarts_v3_src_full_js__.a,Charts:__WEBPACK_IMPORTED_MODULE_15__components_echartsBox_vue___default.a},props:{id:{type:[String,Number],default:""},propTable:{type:Object}},data:function data(){var self=this;return{excelCharts:__WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__.a,chartOptionsSourse:self.charts?JSON.parse(self.imgData):[],excelFunctionsOptions:__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default()(__WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__.b).map(function(t){return{value:t,label:__WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__.b[t].name}}),excelChartsOptions:__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default()(__WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__.a).map(function(t){return{value:t,label:__WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__.a[t].name}}),titleEditingIndex:"",drawStep:[],chartStep:[],funcStore:{},funcCache:"",visible:!1,isDelete:!1,hot1:"",isEdit:!1,saving:!1,tableName:self.propTable.tableName,tableId:self.propTable.tableId,new:self.propTable.new,clipboardCache:[],sheetclip:new __WEBPACK_IMPORTED_MODULE_7_sheetclip___default.a,firstSelectedRow:"",firstSelectedCol:"",lastSelectedRow:"",lastSelectedCol:"",chartTitleEditorCacheValue:"",hotSettings:{data:"string"==typeof self.propTable.tableData?JSON.parse(self.propTable.tableData):self.propTable.tableData,mergeCells:!0,comments:!0,colHeaders:!0,rowHeaders:!0,minCols:1,minRows:1,maxCols:15,colWidths:120,rowHeaderWidth:52,rowHeights:40,columnHeaderHeight:40,autoRowSize:{syncLimit:"40%"},outsideClickDeselects:function(t){return!self.$refs.funcSelect.$refs.mySelect.contains(t)&&!self.$refs.excel.contains(t)},className:"htCenter htMiddle",afterSelectionEnd:function(t,e,a,n){self.hot1[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("lastSelected")]=self.hot1.getSelected(),self.funcStore[t+"-"+e]&&/^=/.test(self.funcStore[t+"-"+e])?self.$refs.funcInput.value=self.funcStore[t+"-"+e]:self.$refs.funcInput.value=""},beforeChange:function beforeChange(changes,sourse){var controlStore=function(t,e){var a=self.funcStore;return!1===e?void delete a[t]:a[t]&&a[t].autoFill?void(a[t]=a[t].autoFill):/^=/.test(e)?void(a[t]=e):void delete a[t]},bracketsComplete=function(t){var e=t.match(/\(/g)?t.match(/\(/g).length:0,a=t.match(/\)/g)?t.match(/\)/g).length:0;if(e-a>0)for(var n=0;n<e-a;n++)t+=")";return t},filterNameFunc=function(t){var e=t;return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default()(__WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__.b).forEach(function(t){if(e.toUpperCase().indexOf(t)>0){var a=new RegExp(t+"\\((\\(.*?\\)|[^\\(\\)])*\\)?","g");e=e.replace(a,function(e){return __WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__.b[t].func(e)})}}),e},computeValue=function computeValue(row,col,value){if(controlStore([row+"-"+col],value),/^=/.test(value)){var newVal=filterNameFunc(bracketsComplete(value));try{var thisCell=""+String.fromCharCode(col+65)+(row+1);if(newVal.toUpperCase().indexOf(thisCell)>0)throw"choose self";var expression=newVal.replace(/\=/,"").replace(/([a-z]+)(\d+)/gi,function(t,e,a){return self.hot1.getDataAtCell(a-1,e.toUpperCase().charCodeAt(0)-65)||0});newVal=eval(expression)}catch(t){newVal="#VALUE!","choose self"===t?(self.$alert("公式中的单元格引用了公式的结果，从而创建了循环引用,请重新选择。","范围选择错误",{confirmButtonText:"确定"}),controlStore([row+"-"+col],!1),newVal=null):"funcRender"!==sourse&&self.$alert("你是否要输入公式文本? \n当第一个字符是 = 时，表格会认为它是公式，为避免这个问题，请在 = 号前输入'，例如：'=1+1，则此时单元格会显示：=1+1","公式输入异常",{confirmButtonText:"确定"})}return"Infinity"===newVal?"#DIV/0!":newVal}return/^'=/.test(value)?value.replace(/^'/,""):value};changes.forEach(function(t,e){var a=changes[e][3],n=changes[e][0],s=changes[e][1],i=computeValue(n,s,a);changes[e][3]=i})},afterBeginEditing:function(t,e){self.quitEditor();var a=self.hot1.getActiveEditor(),n=a.TEXTAREA;self.editArea=n,/^=/.test(n.value)&&(n.value="'"+n.value),self.funcStore[t+"-"+e]&&(n.value=self.funcStore[t+"-"+e]);var s=self.inputNode;s.row=t,s.col=e;var i=function(){/^\=/.test(n.value)&&(self.hot1.destroyEditor(!0),self.drawInput(n.value))};i(),n.addEventListener("input",i)},afterChange:function(t,e){"funcRender"!==e&&self.funcRender(),t&&(self.isEdit=!0,self.$emit("whetherSave",self.isEdit,self.id))},afterCopy:function(t,e){var a=self.hot1.getPlugin("MergeCells").mergedCellsCollection.mergedCells;self.pasteMergeCache=[],a.filter(function(t){if(t.row>=e[0].startRow&&t.col>=e[0].startCol&&e[0].startRow+t.rowspan-1<=e[0].endRow&&e[0].startCol+t.colspan-1<=e[0].endCol)return self.pasteMergeCache.push({rowReduce:t.row-e[0].startRow,colReduce:t.col-e[0].startCol,rowspan:t.rowspan,colspan:t.colspan}),!0}),self.clipboardCache=self.sheetclip.stringify(t)},afterCut:function(t){self.clipboardCache=self.sheetclip.stringify(t)},afterPaste:function(t,e){self.pasteMergeCache.length&&self.pasteMergeCache.forEach(function(t){self.hot1.getPlugin("MergeCells").merge(e[0].startRow+t.rowReduce,e[0].startCol+t.colReduce,e[0].startRow+t.rowReduce+t.rowspan-1,e[0].startCol+t.colReduce+t.colspan-1)}),self.clipboardCache=self.sheetclip.stringify(t)},afterContextMenuShow:function(t){self.firstSelectedRow=this.getSelectedRange()[0].from.row,self.firstSelectedCol=this.getSelectedRange()[0].from.col,self.lastSelectedRow=this.getSelectedRange()[0].to.row,self.lastSelectedCol=this.getSelectedRange()[0].to.col;for(var e=self.firstSelectedRow;e<=self.lastSelectedRow;e++)for(var a=self.firstSelectedCol;a<=self.lastSelectedCol;a++)self.selectedData[e][a]=this.getDataAtCell(e,a)},afterSelection:function(t,e,a,n){self.selectedRange=[t,e,a,n]},beforeAutofillInsidePopulate:function(t,e,a,n,s,i){var r=(a[t.row%a.length][t.col%a[0].length],self.selectedRange),o=[];switch(e){case"left":o=[r[0],r[1]-i.col];break;case"right":o=[r[0],r[1]+1];break;case"up":o=[r[0]-i.row,r[1]];break;case"down":o=[r[0]+1,r[1]];break;default:throw error("direction is undefined")}!function(e){if(e){var a=e.replace(/([A-Z]+)([0-9]+)/gi,function(e,a,n){return String.fromCharCode(a.charCodeAt(0)+t.col+o[1]-r[1])+(+n+t.row+o[0]-r[0])});self.funcStore[o[0]+t.row+"-"+(o[1]+t.col)]={autoFill:a}}}(function(t,e){return!!/^\=/.test(self.funcStore[t+"-"+e])&&self.funcStore[t+"-"+e]}(r[0]+t.row%a.length,r[1]+t.col%a[0].length))},afterMergeCells:function(t){self.hot1.setDataAtCell(t.from.row,t.from.col,this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("mergeData")])},beforeUndo:function(t){console.log(t)}}}},watch:{"hotSettings.data":function(t,e){this.isEdit=!0,this.$emit("whetherSave",this.isEdit,this.id)}},computed:{selectedData:function(){for(var t=[],e=0;e<12;e++){for(var a=[],n=0;n<20;n++)a.push("");t.push(a)}return t},idName:function(){return"excel"+this.id}},methods:{chartSelect:function(t,e){var a=this,n=this.hot1[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("lastSelected")],s=n.map(function(t){var e;return(e=a.hot1).getData.apply(e,__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_toConsumableArray___default()(t))});console.log(n,s);var i=s[0];s.length>0&&"Array"===s[0][0].constructor.name&&(i=s[0].map(function(t,e){var a=[],n=!0,i=!1,r=void 0;try{for(var o,l=__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default()(s);!(n=(o=l.next()).done);n=!0){var c=o.value;a=[].concat(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_toConsumableArray___default()(a),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_toConsumableArray___default()(c[e]))}}catch(t){i=!0,r=t}finally{try{!n&&l.return&&l.return()}finally{if(i)throw r}}return a})),this.chartOptionsSourse.push({data:i,type:t,title:"图表标题",transpose:!1,range:n})},chartSelectFull:function(t){this.chartOptionsSourse.push({data:JSON.parse(this.getExcelData().tableData),type:t,title:"图表标题",transpose:!1,range:"full"})},chartControllerHandle:function(t,e){var a=this;switch(t){case"transpose":this.chartOptionsSourse.splice(e,1,__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default()({},this.chartOptionsSourse[e],{transpose:!this.chartOptionsSourse[e].transpose}));break;case"editorTitle":this.titleEditingIndex=e;break;case"delete":this.$confirm(this.$createElement("p",{class:"confirm-message"},[this.$createElement("svg",null,[this.$createElement("use",{attrs:{"xlink:href":"#icon-zhuyi"},class:"xxx"},null)]),this.$createElement("span",null,"确定要删除该表格吗？")]),{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){a.chartOptionsSourse.splice(e,1)}).catch(function(){return!1});break;default:console.log("chartControllerHandle error")}},quitChartEditor:function(t,e){this.titleEditingIndex="",e&&this.chartOptionsSourse.splice(t,1,__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default()({},this.chartOptionsSourse[t],{title:this.chartTitleEditorCacheValue}))},titleEditorKeydownHandle:function(t,e){13===t.keyCode&&this.quitChartEditor(e,!0),27===t.keyCode&&this.quitChartEditor(e)},toggleChartsRange:function(t,e){var a=this;e?"full"===t.range?this.addDrawStep("full","chartStep"):t.range.forEach(function(t){a.addDrawStep.apply(a,__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_toConsumableArray___default()(t).concat(["chartStep"]))}):this.chartStep=[],this.drawCanvas()},addDrawStep:function addDrawStep(r,c,r2,c2,type){var _this=this,rowsHeight=_this.hot1.getPlugin("autoRowSize").heights.map(function(t){return t<_this.hotSettings.rowHeights?_this.hotSettings.rowHeights:t});"full"===r&&_this[c].push({render:function render(ctx,color){ctx.strokeStyle=color,ctx.strokeRect(_this.hotSettings.rowHeaderWidth,_this.hotSettings.columnHeaderHeight,_this.$refs.excel.clientWidth-_this.hotSettings.rowHeaderWidth,eval(rowsHeight.join("+")))}}),this[type||"drawStep"].push({render:function render(ctx,color){ctx.strokeStyle=color,ctx.strokeRect(_this.hotSettings.rowHeaderWidth+c*_this.hotSettings.colWidths,_this.hotSettings.columnHeaderHeight+(eval(rowsHeight.slice(0,r).join("+"))||0),(c2-c+1)*_this.hotSettings.colWidths,eval(rowsHeight.slice(r,r2+1).join("+")))}})},funcSelect:function(t){var e=void 0,a=this.inputNode;e="block"===a.style.display?[a.row,a.col]:this.hot1.getSelectedLast(),a.row=e[0],a.col=e[1],this.drawInput("="+t.toUpperCase()+"(",!0)},funcRender:function(){var t=this,e=__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default()(this.funcStore).map(function(e){var a=t.funcStore[e],n=e.match(/\d+/g);return[+n[0],+n[1],a]});this.hot1&&this.hot1.setDataAtRowProp(e,"funcRender")},createCanvas:function(t){var e=document.createElement("canvas");return t.appendChild(e),this.canvasNode=e,this.createInput(t),e},quitFunctionEditor:function(){this.drawStep=[];var t=this.canvasNode,e=t.getContext("2d"),a=this.inputNode;a.value="",e.clearRect(0,0,t.width,t.height),a.style.display="none",this.inputDisplay.style.display="none"},quitEditor:function(t,e){var a=this,n=this.inputNode;t&&this.hot1.setDataAtCell(n.row,n.col,n.value),this.quitFunctionEditor();for(var s in n.quitCallbacks)n.quitCallbacks.hasOwnProperty(s)&&n.quitCallbacks[s]();e&&setTimeout(function(){a.hot1.selectCell(n.row,n.col,n.row,n.col)})},createInput:function(t){var e=this,a=document.createElement("textarea"),n=document.createElement("div");a.classList.add("layer-input"),n.classList.add("layer-input-display"),this.inputNode=a,this.inputDisplay=n,t.insertBefore(a,this.canvasNode),t.insertBefore(n,this.canvasNode),a.quitCallbacks={},a.addEventListener("keydown",function(t){13!==t.keyCode||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),e.quitEditor(!0,a.isSelecting)),27===t.keyCode&&(t.preventDefault(),e.quitEditor(!1,!0))}),a.addEventListener("input",this.drawFromInput),a.changeVal=function(t){a.value=t,e.drawFromInput()}},drawCanvas:function(){var t=["#71a1e6","#008000","#9900cc","#800000","#00cc33","#c60","#c09"],e=this.canvasNode;e.width=e.clientWidth,e.height=e.clientHeight;var a=e.getContext("2d");a.clearRect(0,0,e.width,e.height),this.drawStep.forEach(function(e,n){e.render(a,t[n%7])}),this.chartStep.forEach(function(e,n){e.render(a,t[n%7])})},drawInput:function drawInput(value,startEdit){var _this8=this,Input=this.inputNode,InputDisplay=this.inputDisplay,row=Input.row,col=Input.col,rowsHeight=this.hot1.getPlugin("autoRowSize").heights.map(function(t){return t<_this8.hotSettings.rowHeights?_this8.hotSettings.rowHeights:t});Input.style.top=this.hotSettings.columnHeaderHeight+(eval(rowsHeight.slice(0,row).join("+"))||0)+"px",Input.style.left=this.hotSettings.rowHeaderWidth+col*this.hotSettings.colWidths+"px",Input.style.width=this.hotSettings.colWidths+2+"px",Input.style.height=rowsHeight[row]+"px",InputDisplay.style.top=Input.style.top,InputDisplay.style.left=Input.style.left,InputDisplay.style.width=Input.style.width,InputDisplay.style.height=Input.style.height,Input.changeVal(value),Input.style.display="block",InputDisplay.style.display="block",this.hot1.deselectCell(),Input.focus();var cacheValue=value,selectRange=function(t,e,a,n){return t===a&&e===n?""+String.fromCharCode(e+65)+(t+1):""+String.fromCharCode(Math.min(e,n)+65)+(Math.min(t,a)+1)+":"+String.fromCharCode(Math.max(e,n)+65)+(Math.max(t,a)+1)},selectCall=function t(e,a,n,s){var i=void 0,r=void 0,o=void 0;if(r=Input.value.slice(0,Input.selectionStart),o=Input.value.slice(Input.selectionEnd),t.callback=!1,!Input.selectionStart===Input.selectionEnd)i=Input.value.slice(Input.selectionStart,Input.selectionEnd),/([a-z]\d+\:[a-z]\d+|[a-z]\d+)/i.test(i)&&(t.callback=function(t){Input.changeVal(r+t+o)});else{if(/([a-z]\d+\:[a-z]\d+|[a-z]\d+)$/i.test(r)){var l=r.match(/([a-z]\d+\:[a-z]\d+|[a-z]\d+)$/i)[0],c=new RegExp(l+"$");t.callback=function(t){Input.changeVal(r.replace(c,t)+o)}}(/[\*\/\-\+\(\:\^]{1}$/.test(r)||/^\=$/.test(r))&&(t.callback=function(t){Input.changeVal(r+t+o)})}var u=Input.value.length-Input.selectionStart,d=Input.value.length-Input.selectionEnd,_=selectRange(e,a,n,s);t.callback&&t.callback(_),t.callback&&Input.setSelectionRange(Input.value.length-u,Input.value.length-d),Input.focus()},checkToStartSelect=function(){if(Input.isSelecting=!1,_this8.hot1.removeHook("afterSelectionEnd",selectCall),Input.style.height=Input.scrollHeight+4+"px",_this8.inputDisplay.style.height=Input.style.height,!/^=/.test(Input.value))return!1;Input.isSelecting=!0,_this8.hot1.addHook("afterSelectionEnd",selectCall),Input.quitCallbacks.clearSelect=function(){Input.isSelecting=!1,_this8.hot1.removeHook("afterSelectionEnd",selectCall)}};checkToStartSelect(),Input.addEventListener("input",checkToStartSelect);var clickHandle=function(t){return"block"===Input.style.display&&t.target!==Input&&(_this8.$refs.excel.contains(t.target)?void(Input.isSelecting||_this8.quitEditor(!0)):void _this8.quitEditor(!0,!0))};return setTimeout(function(){return window.addEventListener("click",clickHandle)}),Input},drawFromInput:function(){var t=this;if(!/^=/.test(this.inputNode.value))return this.inputDisplay.innerHTML=this.inputNode.value,!1;var e=this.inputNode.value.replace(/([a-z]+\d+\:[a-z]+\d+|[a-z]+\d+)/gi,"<span>$1</span>");this.inputDisplay.innerHTML=e,this.drawStep=[];try{this.inputNode.value.match(/([a-z]+\d+\:[a-z]+\d+|[a-z]+\d+)/gi).forEach(function(e){if(/\:/.test(e)){var a=e.match(/[a-z]/gi)[0].toUpperCase().charCodeAt(0)-65,n=e.match(/[a-z]/gi)[1].toUpperCase().charCodeAt(0)-65,s=e.match(/\d+/g)[0]-1,i=e.match(/\d+/g)[1]-1;t.addDrawStep(s,a,i,n)}else{var r=e.match(/[a-z]/gi)[0].toUpperCase().charCodeAt(0)-65,o=e.match(/\d+/g)[0]-1;t.addDrawStep(o,r,o,r)}}),this.drawCanvas()}catch(t){console.log(t)}},changeCellType:function(t){for(var e=this,a=e.firstSelectedRow;a<=e.lastSelectedRow;a++)for(var n=e.firstSelectedCol;n<=e.lastSelectedCol;n++)if(e.hotSettings.data[a][n]&&!isNaN(parseFloat(e.hotSettings.data[a][n])))switch(t){case 0:case 1:e.$set(e.hotSettings.data[a],n,e.formatNumber(e.selectedData[a][n],null));break;case 2:e.$set(e.hotSettings.data[a],n,e.formatNumber(e.selectedData[a][n],2));break;case 3:e.$set(e.hotSettings.data[a],n,e.formatPercentage(e.selectedData[a][n],null));break;case 4:e.$set(e.hotSettings.data[a],n,e.formatPercentage(e.selectedData[a][n],2))}},formatNumber:function(t,e){if(t){if(t.toString().indexOf("%")<0)return e?parseFloat(t).toFixed(2):t;var a=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(t).div(1);return e?a.toFixed(2):a}return""},formatPercentage:function(t,e){if(t){if(t.toString().indexOf("%")>0)return e?parseFloat(t).toFixed(2)+"%":parseFloat(t).toFixed(0)+"%";var a=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(t).mul(100);return e?a.toFixed(2)+"%":a+"%"}return""},calculateRow:function(t){var e=this;switch(t){case"add":for(var a=e.firstSelectedRow;a<=e.lastSelectedRow;a++){for(var n=e.selectedData[a][e.firstSelectedCol],s=e.firstSelectedCol+1;s<=e.lastSelectedCol;s++){var i=e.selectedData[a][s]||0;n=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(n).add(i)}e.$set(e.hotSettings.data[a],e.lastSelectedCol+1,n)}break;case"sub":for(var r=e.firstSelectedRow;r<=e.lastSelectedRow;r++){for(var o=e.selectedData[r][e.firstSelectedCol],l=e.firstSelectedCol+1;l<=e.lastSelectedCol;l++){var c=e.selectedData[r][l]||0;o=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(o).sub(c)}e.$set(e.hotSettings.data[r],e.lastSelectedCol+1,o)}break;case"div":for(var u=e.firstSelectedRow;u<=e.lastSelectedRow;u++){for(var d=e.selectedData[u][e.firstSelectedCol],_=e.firstSelectedCol+1;_<=e.lastSelectedCol;_++){var f=e.selectedData[u][_]||0;d=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(d).div(f)}e.$set(e.hotSettings.data[u],e.lastSelectedCol+1,d)}break;case"mul":for(var p=e.firstSelectedRow;p<=e.lastSelectedRow;p++){for(var h=e.selectedData[p][e.firstSelectedCol],v=e.firstSelectedCol+1;v<=e.lastSelectedCol;v++){var m=e.selectedData[p][v]||0;h=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(h).mul(m)}e.$set(e.hotSettings.data[p],e.lastSelectedCol+1,h)}break;case"average":for(var g=e.firstSelectedRow;g<=e.lastSelectedRow;g++){for(var b=e.selectedData[g][e.firstSelectedCol],y=1,C=e.firstSelectedCol+1;C<=e.lastSelectedCol;C++){var E=e.selectedData[g][C]||0;b=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(b).add(E),y++}var I=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(parseFloat(b)).div(y);b.toString().indexOf("%")>0&&(I+="%"),e.$set(e.hotSettings.data[g],e.lastSelectedCol+1,I)}}},calculateCol:function(t){var e=this,a=e.hotSettings.data.length,n=e.hotSettings.data[0].length;switch(e.lastSelectedRow+1===a&&e.hotSettings.data.push(new Array(n)),t){case"add":for(var s=e.firstSelectedCol;s<=e.lastSelectedCol;s++){for(var i=e.selectedData[e.firstSelectedRow][s],r=e.firstSelectedRow+1;r<=e.lastSelectedRow;r++){var o=e.selectedData[r][s]||0;i=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(i).add(o)}e.$set(e.hotSettings.data[e.lastSelectedRow+1],s,i)}break;case"sub":for(var l=e.firstSelectedCol;l<=e.lastSelectedCol;l++){for(var c=e.selectedData[e.firstSelectedRow][l],u=e.firstSelectedRow+1;u<=e.lastSelectedRow;u++){var d=e.selectedData[u][l]||0;c=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(c).sub(d)}e.$set(e.hotSettings.data[e.lastSelectedRow+1],l,c)}break;case"div":for(var _=e.firstSelectedCol;_<=e.lastSelectedCol;_++){for(var f=e.selectedData[e.firstSelectedRow][_],p=e.firstSelectedRow+1;p<=e.lastSelectedRow;p++){var h=e.selectedData[p][_]||0;f=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(f).div(h)}e.$set(e.hotSettings.data[e.lastSelectedRow+1],_,f)}break;case"mul":for(var v=e.firstSelectedCol;v<=e.lastSelectedCol;v++){for(var m=e.selectedData[e.firstSelectedRow][v],g=e.firstSelectedRow+1;g<=e.lastSelectedRow;g++){var b=e.selectedData[g][v]||0;m=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(m).mul(b)}e.$set(e.hotSettings.data[e.lastSelectedRow+1],v,m)}break;case"average":for(var y=e.firstSelectedCol;y<=e.lastSelectedCol;y++){for(var C=e.selectedData[e.firstSelectedRow][y],E=1,I=e.firstSelectedRow+1;I<=e.lastSelectedRow;I++){var w=e.selectedData[I][y]||0;C=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(C).add(w),E++}var S=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(parseFloat(C)).div(E);C.toString().indexOf("%")>0&&(S+="%"),e.$set(e.hotSettings.data[e.lastSelectedRow+1],y,S)}}},getExcelData:function(){__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.hotSettings.data);return{tableData:__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.hotSettings.data),cellInfo:__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.hot1.getPlugin("MergeCells").mergedCellsCollection.mergedCells),quotaId:this.$route.query.quotaId,tableId:this.tableId,tableName:this.tableName}},saveTable:function(){var t=this,e=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default()({},this.getExcelData(),{imgData:__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.chartOptionsSourse)});this.saving=!0,this.isEdit=!1,this.new?this.$service.saveTable(e).then(function(e){"0"==e.responseCode&&(t.new=!1,t.tableId=e.result.tableId,t.saving=!1,t.isEdit=!1,t.$message.success("保存成功！"),t.$emit("whetherSave",t.isEdit,t.id))}):this.$service.updateTable(e).then(function(e){"0"==e.responseCode&&(t.saving=!1,t.isEdit=!1,t.$message.success("保存成功！"),t.$emit("whetherSave",t.isEdit,t.id))})},deleteTable:function(){var t=this,e={tableId:this.tableId};this.tableId?this.$service.deleteTable(e).then(function(e){"0"==e.responseCode&&(t.$message.success("删除成功"),t.isDelete=!0,t.$emit("whetherSave","del",t.id))}):(this.$message.success("删除成功"),this.isDelete=!0,this.$emit("whetherSave","del",this.id))}},mounted:function(){var t=this,e=document.getElementById(""+this.idName),a=this.createCanvas(e);this.canvas=a,t.hot1=new __WEBPACK_IMPORTED_MODULE_6_handsontable_pro___default.a(e,t.hotSettings),t.hot1.updateSettings({contextMenu:{items:{row_above:{name:"向上插入一行"},row_below:{name:"向下插入一行"},col_left:{name:"向左插入一列"},col_right:{name:"向右插入一列"},remove_row:{name:"删除行"},remove_col:{name:"删除列"},mergeCells:{name:function(){var t=this.getSelectedLast();if(t){var e=this.getPlugin("MergeCells").mergedCellsCollection.get(t[0],t[1]);if(e.row===t[0]&&e.col===t[1]&&e.row+e.rowspan-1===t[2]&&e.col+e.colspan-1===t[3])return this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("useMerge")]=!1,"取消合并单元格"}return this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("useMerge")]=!0,"合并单元格"},callback:function(e,a){var n=this,s=[a[0].start.row,a[0].start.col,a[0].end.row,a[0].end.col];if(!this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("useMerge")]){var i;return void(i=this.getPlugin("MergeCells")).unmerge.apply(i,s)}var r=this.getData.apply(this,s),o=[];if(r.forEach(function(t){o=[].concat(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_toConsumableArray___default()(o),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_toConsumableArray___default()(t))}),o=o.filter(function(t){return t}),o.length>1)t.$confirm("合并后的单元格将只保留左/上单元格中的值，确定合并吗？","合并单元格",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var t;n[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("mergeData")]=o[0],(t=n.getPlugin("MergeCells")).merge.apply(t,s)}).catch(function(){return!1});else{var l;this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("mergeData")]=o[0],(l=this.getPlugin("MergeCells")).merge.apply(l,s)}}},cellsType:{key:"types",name:"设置单元格格式",submenu:{items:[{key:"types:normal",name:"常规",callback:function(e,a){t.changeCellType(0),t.hot1.render()}},{key:"types:numbers",name:"数字",callback:function(e,a){t.changeCellType(1),t.hot1.render()}},{key:"types:numbersWithDecimal",name:"数字(保留两位小数)",callback:function(e,a){t.changeCellType(2),t.hot1.render()}},{key:"types:percentage",name:"百分比",callback:function(e,a){t.changeCellType(3),t.hot1.render()}},{key:"types:percentageWithDecimal",name:"百分比(保留两位小数)",callback:function(e,a){t.changeCellType(4),t.hot1.render()}}]}},copy:{name:"复制"},cut:{name:"剪切"},paste:{name:"粘贴",disabled:function(){return 0===t.clipboardCache.length},callback:function(){var e=t.hot1.getPlugin("copyPaste");t.hot1.listen(),e.paste(t.clipboardCache)}}}}})}}},561:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"header",computed:{userName:function(){return window.user?window.user.userName:"管理员"},csrf:function(){return this.$store.state.csrf["X-XSRF-TOKEN"]}},methods:{logout:function(){document.querySelector("#logoutForm").submit()}}}},562:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(1002),s=a.n(n),i=a(1004),r=a.n(i);e.default={components:{wHeader:s.a,wSidebar:r.a},data:function(){return{top:""}},mounted:function(){var t=this;this.$nextTick(function(){document.getElementById("content").addEventListener("scroll",t.onScroll)})},methods:{onScroll:function(){this.top=document.getElementById("content").scrollTop},backToTop:function(){document.getElementById("content").scrollTop=0}}}},563:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(89),s=a.n(n),i=a(36),r=a.n(i);e.default={data:function(){return{}},computed:{currentPath:function(){return this.$route.path.slice(0,15)}},methods:{initItem:function(){var t=!0,e=!1,a=void 0;try{for(var n,i=r()(s()(this.$store.state.oldBaseInfo));!(t=(n=i.next()).done);t=!0){var o=n.value;this.$store.state.oldBaseInfo[o]="quotaDefinitions"==o?[null]:"formulaUnits"==o?"%":""}}catch(t){e=!0,a=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw a}}}}}},564:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(36),s=a.n(n),i=a(579),r=a.n(i),o=a(154),l=a(59);e.default={components:{IEcharts:o.a},data:function(){return{indicatorsInfo:"",indicatorsTable:[],indicatorsResult:"",charts:[],spreadCharts:[],qualityPics:[],effectivePics:[],reasonDOM:"",improveDOM:"",effectDOM:""}},computed:{formula:function(){return this.indicatorsInfo.molecular+" / "+this.indicatorsInfo.denominator+" * "+this.indicatorsInfo.percentage+" "+this.indicatorsInfo.formulaUnits}},beforeRouteEnter:function(t,e,a){l.a.previewData(t.query.quotaId).then(function(t){a(function(e){var a=t.result,n=r()(a.quotaBaseInfoDOs,1);e.indicatorsInfo=n[0],e.indicatorsTable=a.quotaTables;var s=r()(a.quotaResultAnalysisDOs,1);if(e.indicatorsResult=s[0],e.reasonDOM=e.indicatorsResult.reasonAnalysis||"暂无",e.improveDOM=e.indicatorsResult.improvementMeasure||"暂无",e.effectDOM=e.indicatorsResult.effectiveAnalysis||"暂无文字说明",e.indicatorsResult){var i=e.indicatorsResult,o=i.qualityAnalysisFbzId,l=i.effectiveAnalysisFbzId;e.loadPics(o,e.qualityPics),e.loadPics(l,e.effectivePics)}e.charts=e.toBaseEChart(e.indicatorsTable),e.charts.map(function(t){e.spreadCharts.push(t.spreadType.map(function(a){return e.toSpreadEChart(t,a)}))})})})},methods:{loadPics:function(t,e){if(t){var a=t.split(","),n=!0,i=!1,r=void 0;try{for(var o,l=s()(a);!(n=(o=l.next()).done);n=!0){var c=o.value;e.push("/getphotobyte?fileId="+c)}}catch(t){i=!0,r=t}finally{try{!n&&l.return&&l.return()}finally{if(i)throw r}}}},htmlToCanvas:function(){this.pagination(),window.print()},pagination:function(){for(var t=document.getElementsByClassName("pdf-pagination"),e=0,a=0;a<t.length;a++)1500-(t[a].offsetTop-e)<=t[a].offsetHeight&&(e=t[a].offsetTop,t[a-1].className=t[a-1].className+" pagination")}}}},565:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(170),s=a.n(n),i=a(89),r=a.n(i),o=a(36),l=a.n(o),c=a(119),u=a.n(c),d=a(88),_=a(59),f=a(164),p=a.n(f);a(42);e.default={data:function(){return{floorId:"",deptId:"",indicatorDef:"",defaultSign:"%",signs:[{key:"%",mark:"%"},{key:"‰",mark:"‰"}],validate:{floorId:!1,departmentId:!1,quotaName:!1,quotaTypeId:!1,molecular:!1,denominator:!1,percentage:!1,quotaDefinitions:[]},stepNum:""}},computed:u()({},a.i(d.a)(["floors","depts","types"]),{oldBaseInfo:function(){return this.$store.state.oldBaseInfo}}),beforeRouteEnter:function(t,e,a){t.query.quotaId?_.a.getOldBaseInfo(t.query.quotaId).then(function(t){a(function(e){if(t.responseData){var a=!0,n=!1,s=void 0;try{for(var i,o=l()(r()(e.$store.state.oldBaseInfo));!(a=(i=o.next()).done);a=!0){var c=i.value;e.$store.state.oldBaseInfo[c]=t.responseData[c]}}catch(t){n=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(n)throw s}}}})}):a()},methods:{addQuotaDefinition:function(){if(this.oldBaseInfo.quotaDefinitions.length>=10)return void this.$message.error("指标定义请不要超过10条！");this.oldBaseInfo.quotaDefinitions.push(null)},deleteQuotaDefinition:function(t){this.oldBaseInfo.quotaDefinitions.splice(t,1)},gotoStep:function(t){var e=this;this.validate={floorId:this.$validate.value(this.oldBaseInfo.floorId),departmentId:this.$validate.value(this.oldBaseInfo.departmentId),quotaName:this.$validate.string(this.oldBaseInfo.quotaName),quotaTypeId:this.$validate.value(this.oldBaseInfo.quotaTypeId),quotaDefinitions:this.$validate.array(this.oldBaseInfo.quotaDefinitions),molecular:this.$validate.string(this.oldBaseInfo.molecular),denominator:this.$validate.string(this.oldBaseInfo.denominator),percentage:this.$validate.number(this.oldBaseInfo.percentage)};var a=!0,n=!1,i=void 0;try{for(var r,o=l()(s()(this.validate));!(a=(r=o.next()).done);a=!0){var c=r.value;if(c.constructor==Array){var u=!0,d=!1,_=void 0;try{for(var f,h=l()(c);!(u=(f=h.next()).done);u=!0){if(f.value)return!1}}catch(t){d=!0,_=t}finally{try{!u&&h.return&&h.return()}finally{if(d)throw _}}}else if(c)return!1}}catch(t){n=!0,i=t}finally{try{!a&&o.return&&o.return()}finally{if(n)throw i}}this.stepNum=2;var v={denominator:this.oldBaseInfo.denominator,departmentId:this.oldBaseInfo.departmentId,floorId:this.oldBaseInfo.floorId,molecular:this.oldBaseInfo.molecular,percentage:this.oldBaseInfo.percentage,quotaName:this.oldBaseInfo.quotaName,quotaTypeId:this.oldBaseInfo.quotaTypeId,quotaDefinitions:this.oldBaseInfo.quotaDefinitions,quotaId:this.$route.query.quotaId||"",formulaUnits:this.oldBaseInfo.formulaUnits};p.a.start(),this.$route.query.quotaId?this.$service.editBaseInfo(v).then(function(a){"0"==a.responseCode?e.$router.push({name:"entryStep"+t,query:{quotaId:e.$route.query.quotaId,isEdit:e.$route.query.isEdit}}):p.a.end()}):this.$service.createBaseInfo(v).then(function(a){"0"==a.responseCode?e.$router.push({name:"entryStep"+t,query:{quotaId:a.responseData.quotaId}}):p.a.end()})}}}},566:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(118),s=a.n(n),i=a(59),r=a(1001),o=a.n(r);e.default={components:{webExcel:o.a},data:function(){return{tableData:[[{x:2,y:1,content:"xx"},{x:1,y:1,content:"xx2"}],[{x:1,y:1,content:"yy"}]],indicatorsTable:[],args:[],dialogVisible:!1}},beforeRouteEnter:function(t,e,a){i.a.getOldTable(t.query.quotaId).then(function(t){a(function(e){t.result&&(e.indicatorsTable=t.result,console.log(t.result))})})},methods:{confirmGotoStep:function(t){var e=this.args.some(function(t){return!0===t});console.log(e),e?this.dialogVisible=!0:this.gotoStep(t)},gotoStep:function(t){var e=this.$route.query.isEdit?s()({quotaId:this.$route.query.quotaId},{isEdit:this.$route.query.isEdit}):{quotaId:this.$route.query.quotaId};this.$router.push({name:"entryStep"+t,query:e})},dependEdit:function(t,e){"del"!=t?this.$set(this.args,parseInt(e),t):this.args.splice(e,1)},addTable:function(){this.indicatorsTable.push({tableData:function(t,e){for(var a=[],n=0;n<8;n++){for(var s=[],i=0;i<10;i++)s.push("");a.push(s)}return a}(),cellInfo:!0,tableId:"",new:!0,tableName:"表格名称"})}}}},567:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(581),s=a.n(n),i=a(578),r=a.n(i),o=a(118),l=a.n(o),c=a(904),u=(a.n(c),a(905)),d=(a.n(u),a(903)),_=(a.n(d),a(1024)),f=(a.n(_),a(59)),p=a(42);e.default={data:function(){return{tempData:{},reason:"",improve:"",result:"",loading:!1,qualityAnalysisUid:[],effectiveAnalysisUid:[],qualityIsClicked:!1,effectIsClicked:!1,filelist1:[],filelist2:[],oldResult:{effectiveAnalysis:"",effectiveAnalysisFbzId:"",improvementMeasure:"",qualityAnalysisFbzId:"",reasonAnalysis:""},editorOption:{placeholder:"请输入内容",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["image"]]}},headers:{Accept:"application/json, text/plain, */*","X-XSRF-TOKEN":this.$store.state.csrf["X-XSRF-TOKEN"]}}},computed:{qualityAnalysisFbzId:function(){return this.oldResult.qualityAnalysisFbzId?this.oldResult.qualityAnalysisFbzId.split(","):[]},effectiveAnalysisFbzId:function(){return this.oldResult.effectiveAnalysisFbzId?this.oldResult.effectiveAnalysisFbzId.split(","):[]}},beforeRouteEnter:function(t,e,a){t.query.isEdit?f.a.getOldResult(t.query.quotaId).then(function(t){a(function(e){t.responseData&&(e.oldResult=p.a.deepClone(t.responseData),""!=e.oldResult.qualityAnalysisFbzId&&(e.filelist1=e.oldResult.qualityAnalysisFbzId.split(",").map(function(t){return{url:"/getphotobyte?fileId="+t}})),""!=e.oldResult.effectiveAnalysisFbzId&&(e.filelist2=e.oldResult.effectiveAnalysisFbzId.split(",").map(function(t){return{url:"/getphotobyte?fileId="+t}})))})}):a()},methods:{gotoStep:function(t){var e=this.$route.query.isEdit?l()({quotaId:this.$route.query.quotaId},{isEdit:this.$route.query.isEdit}):{quotaId:this.$route.query.quotaId};this.$router.push({name:"entryStep"+t,query:e})},save:function(){var t=this,e={effectiveAnalysis:this.oldResult.effectiveAnalysis,effectiveAnalysisFbzId:this.effectiveAnalysisFbzId.join(","),improvementMeasure:this.oldResult.improvementMeasure,qualityAnalysisFbzId:this.qualityAnalysisFbzId.join(","),quotaId:this.$route.query.quotaId,reasonAnalysis:this.oldResult.reasonAnalysis};this.loading=!0,this.$route.query.isEdit?this.$service.saveOldEntryInfo(e).then(function(e){"0"==e.responseCode&&(t.$message.success("保存成功！"),t.$router.push({path:"/indicator/libs"})),t.loading=!1}):this.$service.saveNewEntryInfo(e).then(function(e){"0"==e.responseCode&&(t.$message.success("保存成功！"),t.$router.push({path:"/indicator/libs"})),t.loading=!1})},qualityAnalysisUploaded:function(t,e,a){var n=this;if(0!=t.responseCode||0!=t.code)return void this.$message.error(t.responseMessage);this.$message.success(t.responseMessage),a.map(function(t){n.qualityAnalysisUid.includes(t.uid)||n.qualityAnalysisUid.push(t.uid)}),this.qualityAnalysisFbzId.push(t.results.fileId),this.qualityIsClicked=!0},removeQualityAnalysisPic:function(t,e){if(this.qualityIsClicked){var a=this.qualityAnalysisUid.indexOf(t.uid);this.qualityAnalysisFbzId.splice(a,1),this.qualityAnalysisUid.splice(a,1)}else for(var n=0;n<this.qualityAnalysisFbzId.length;n++)this.qualityAnalysisFbzId[n]==t.url.substr(-32)&&this.qualityAnalysisFbzId.splice(n,1)},beforeAvatarUpload:function(t){var e="image/jpeg"==t.type||"image/png"==t.type,a=t.size/1024/1024<1;return e||this.$message.error("上传图片只能是jpg/jpeg/png格式！"),a||this.$message.error("上传图片大小不能超过1MB！"),e&&a},effectiveAnalysisUploaded:function(t,e,a){var n=this;if(0!=t.responseCode||0!=t.code)return void this.$message.error(t.responseMessage);this.$message.success(t.responseMessage),a.map(function(t){n.effectiveAnalysisUid.includes(t.uid)||n.effectiveAnalysisUid.push(t.uid)}),this.effectiveAnalysisFbzId.push(t.results.fileId),this.effectIsClicked=!0},removeEffectiveAnalysisPic:function(t){if(this.effectIsClicked){var e=this.qualityAnalysisUid.indexOf(t.uid);this.effectiveAnalysisFbzId.splice(e,1),this.effectiveAnalysisUid.splice(e,1)}else for(var a=0;a<this.effectiveAnalysisFbzId.length;a++)this.effectiveAnalysisFbzId[a]==t.url.substr(-32)&&this.effectiveAnalysisFbzId.splice(a,1)}},components:{quillEditor:_.quillEditor},mounted:function(){var t=this,e=function(){var e=r()(s.a.mark(function e(a){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.addImgRange=t.$refs.editor.quill.getSelection(),a&&(n=t.$refs.imgUpload,console.log(n),n.$el.click());case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}();t.$refs.editor.quill.getModule("toolbar").addHandler("image",e)}}},568:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(119),s=a.n(n),i=a(88);e.default={data:function(){return{tableData:[],indicator:"",floorId:"",deptId:"",person:"",dateRange:[],tableLoading:!0,indicatorDialogVisible:!1,visible2:!1,params:{},totalPages:0,pageSize:10,curPage:1,delId:""}},computed:s()({},a.i(i.a)(["floors","depts"]),{tableIndex:function(){}}),created:function(){this.loadIndicators()},methods:{search:function(){this.curPage=1,this.loadIndicators()},reset:function(){this.indicator="",this.floorId="",this.deptId="",this.person="",this.dateRange=[],this.pageSize=10,this.curPage=1,this.loadIndicators()},deleteRow:function(t){this.indicatorDialogVisible=!0,this.delId=t.quotaId},edit:function(t){this.$router.push({path:"/indicator/entryStep1",query:{quotaId:t.quotaId,isEdit:!0}})},confirmDel:function(){var t=this;this.indicatorDialogVisible=!1,this.tableLoading=!0,this.$service.deleteIndicator(this.delId).then(function(e){0!=e.responseCode?(t.tableLoading=!1,t.$message.error(e.responseMessage)):(t.$message.success("删除成功！"),t.loadIndicators())})},loadIndicators:function(){var t=this;this.tableLoading=!0,this.params={quotaName:this.indicator,floorId:this.floorId,departmentId:this.deptId,userName:this.person,recordStartDate:null!=this.dateRange[0]&&0!=this.dateRange.length?this.$dateHandle.dateArrayFormat(this.dateRange)[0]+" 00:00:00":"",recordEndDate:null!=this.dateRange[0]&&0!=this.dateRange.length?this.$dateHandle.dateArrayFormat(this.dateRange)[1]+" 23:59:59":"",startIndex:this.curPage-1,pageSize:this.pageSize},this.$service.getIndicators(this.params).then(function(e){t.tableLoading=!1;var a=[e.responseData.resultList,e.responseData.totalCount];t.tableData=a[0],t.totalPages=a[1]})},handleSizeChange:function(t){this.pageSize=t,this.loadIndicators()},handleCurrentChange:function(t){this.curPage=t,this.loadIndicators()}}}},569:function(t,e,a){"use strict";a.d(e,"b",function(){return _}),a.d(e,"a",function(){return v});var n=a(172),s=a.n(n),i=a(36),r=a.n(i),o=a(116),l=a.n(o),c=a(134),u=a.n(c),d=function(t){var e=t.toUpperCase().match(/([A-Z]+|[0-9]+)/g),a=e[1],n=e[0].charCodeAt(0),s=e[3],i=e[2].charCodeAt(0),r=l()({length:s-a+1},function(t,e){return+a+e}),o=l()({length:i-n+1},function(t,e){return String.fromCharCode(+n+e)}),c=[];return r.forEach(function(t){o.forEach(function(e){c.push(e+t)})}),c},_={SUM:{name:"求和",func:function(t){return t.replace(/sum/i,"").replace(/[a-z]+\d+\:[a-z]+\d+/gi,function(t){return"("+d(t).join("+")+")"}).replace(/,/g,"+")}},SUBTRACTION:{name:"求差",func:function(t){return t.replace(/subtraction/i,"").replace(/[a-z]+\d+\:[a-z]+\d+/gi,function(t){return"("+d(t).join("+")+")"}).replace(/,/g,"-")}},QUOTIENT:{name:"求商",func:function(t){return t.replace(/quotient/i,"").replace(/[a-z]+\d+\:[a-z]+\d+/gi,function(t){return"("+d(t).join("+")+")"}).replace(/,/g,"/")}},AVERAGE:{name:"求平均数",func:function(t){var e=t.replace(/AVERAGE/i,"").replace(/[a-z]+\d+\:[a-z]+\d+/gi,function(t){return"("+d(t).join("+")+")"}).replace(/,/g,"+");return"("+e+"/"+e.match(/[a-z]+\d+/gi).length+")"}}},f=function(t){return t[0].map(function(e,a){var n=[],i=!0,o=!1,l=void 0;try{for(var c,u=r()(t);!(i=(c=u.next()).done);i=!0){var d=c.value;n=[].concat(s()(n),[d[a]])}}catch(t){o=!0,l=t}finally{try{!i&&u.return&&u.return()}finally{if(o)throw l}}return n})},p=function(t){var e=[],a=[],n=[],s=!0,i=!1,o=void 0;try{for(var l,c=r()(t);!(s=(l=c.next()).done);s=!0){var u=l.value,d=!0,_=!1,f=void 0;try{for(var p,h=r()(u);!(d=(p=h.next()).done);d=!0){var v=p.value;/^\d+(\.\d+)?$/.test(String(v))?e.push(v):/^\d+(\.\d+)?%$/.test(String(v))?a.push(v):n.push(v)}}catch(t){_=!0,f=t}finally{try{!d&&h.return&&h.return()}finally{if(_)throw f}}}}catch(t){i=!0,o=t}finally{try{!s&&c.return&&c.return()}finally{if(i)throw o}}return n.length>0?{type:"error",msg:"您选中的单元格包含了不合法的字符，请确保除首行首列外，其余的单元格均为数字或百分数"}:0===e.length?{type:"precent"}:{type:"mix"}},h=function(t){var e=t.filter(function(t){return""!==t.join("")});e=f(f(e).filter(function(t){return""!==t.join("")}));var a=e.map(function(t){return t[0]}),n=e[0],s=e,i=function(t){return/^\d+(\.\d+)?%?$/.test(String(t))};null===e[0][0]?(s=s.slice(1).map(function(t){return t.slice(1)}),n=n.slice(1),a=a.slice(1)):i(n[n.length-1])?i(a[a.length-1])?a=a.map(function(t,e){return"系列"+(e+1)}):(n=n.slice(1),s=s.map(function(t){return t.slice(1)})):(a=a.slice(1),s=s.slice(1),i(a[a.length-1])?a=a.map(function(t,e){return"系列"+(e+1)}):(n=n.slice(1),s=s.map(function(t){return t.slice(1)})));var r=p(s);return"error"===r.type?r.msg:{column:a,row:n,data:s,type:r.type}},v={sum:{name:"折线图",func:function(t){var e=h(t.transpose?f(t.data):t.data);return{title:{top:10,left:"center",text:t.title},legend:{type:"scroll",bottom:10,data:e.column,formatter:function(t){return u.a.format.truncateText(t,120,"14px Microsoft Yahei","…")},tooltip:{show:!0}},tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:e.row},yAxis:{type:"value"},series:e.data.map(function(t,a){return{data:t,type:"line",name:e.column[a]}})}}},reduce:{name:"柱状图（簇形）",func:function(t){var e=h(t.transpose?f(t.data):t.data);return{title:{top:10,left:"center",text:"图表标题"},legend:{bottom:10,data:e.column},tooltip:{trigger:"axis"},calculable:!0,xAxis:[{type:"category",data:e.row}],yAxis:[{type:"value"}],series:e.data.map(function(t,a){return{data:t,type:"bar",name:e.column[a]}})}}},quotient:{name:"饼图",func:function(t){var e=h(t.transpose?f(t.data):t.data);return{title:{top:10,left:"center",text:"图表标题"},legend:{bottom:10,data:e.column},tooltip:{trigger:"axis"},series:e.data.map(function(t,a){return{data:t,type:"pie",name:e.column[a]}})}}},average:{name:"柏拉图",func:function(){console.log(arguments)}},diy:{name:"自定义",func:function(){console.log(arguments)}}}},570:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(531),s=(a.n(n),a(530)),i=a.n(s),r=a(27),o=a(535),l=a.n(o),c=a(524),u=a(525),d=a(59),_=a(42),f=a(526),p=a(527),h=a(528),v=a(529),m=a(534),g=(a.n(m),a(533)),b=(a.n(g),a(164)),y=a.n(b),C=a(532),E=(a.n(C),a(88),a(536));a.n(E);r.default.config.productionTip=!1,r.default.use(i.a),r.default.prototype.$service=d.a,r.default.prototype.$handleObject=_.a,r.default.prototype.$dateHandle=f.a,r.default.prototype.$validate=v.a,r.default.prototype.toBaseEChart=p.a,r.default.prototype.toSpreadEChart=h.a;var I={};window._csrf||(window._csrf={headerName:"X-XSRF-TOKEN",token:"global"});var w=window._csrf.headerName,S=window._csrf.token;I[w]=S,u.a.commit("CSRF",I),c.a.beforeEach(function(t,e,a){y.a.start(),a()}),c.a.afterEach(function(t,e,a){y.a.done()}),new r.default({el:"#app",router:c.a,store:u.a,template:"<App/>",components:{App:l.a},beforeCreate:function(){u.a.dispatch("loadDepts"),u.a.dispatch("loadFloors"),u.a.dispatch("loadTypes")}})},571:function(t,e,a){"use strict";e.a={userInfoAddr:"/user/info/get",floorsAddr:"/quality/floor/list",deptsAddr:"/quality/department/list",typesAddr:"/quality/quotaType/list",createBaseInfoAddr:"/quality/quotaBaseInfo/create",editBaseInfoAddr:"/quality/quotaBaseInfo/edit",generateTableAddr:"/quality/quotaTable/generateQuotaTable",oldBaseInfoAddr:"/quality/quotaBaseInfo/detail?quotaId=",oldTableInfoAddr:"/quality/quotaTable/getNewQuotaTable?quotaId=",saveTableAddr:"/quality/quotaTable/saveQuotaTable",updateTableAddr:"/quality/quotaTable/updateQuotaTable",deleteTableAddr:"/quality/quotaTable/deleteNewQuotaTable",saveOldEntryInfoAddr:"/quality/result/analysis/edit",saveNewEntryInfoAddr:"/quality/result/analysis/create",saveOldChartsAddr:"/quality/quotaTable/updateQuotaTableElement",fileUploadAddr:"/file/upload",oldResultAddr:"/quality/result/analysis/detail?quotaId=",indicatorsAddr:"/quality/quotaBaseInfo/list?",deleteIndicatorAddr:"/quality/quotaBaseInfo/delete?quotaId=",previewAddr:"/quality/pdf/view?quotaIds="}},572:function(t,e,a){"use strict";var n=a(171),s=a.n(n),i=a(257),r=a.n(i),o=a(537),l=a.n(o);l.a.interceptors.response.use(function(t){return"0"!=t.data.responseCode&&r.a.error(t.data.responseMessage),t.data},function(t){switch(t.response.status){case 401:window.location.href="/login";break;case 404:r.a.error("找不到网络资源！"+t.response.status);break;case 500:r.a.error("服务器错误！"+t.response.status);break;case-1:r.a.error("服务器无响应！"+t.response.status)}return console.log(t.response),s.a.reject(t.response)}),e.a=l.a},573:function(t,e,a){"use strict";var n=function(t){return new s(t)},s=function(t){this.value=t},i=function(t){var e=r(t).toString(),a=0;return e.indexOf(".")>0&&(a=e.split(".")[1].length),a},r=function(t){return t.toString().indexOf("%")>0?parseFloat(t)/100:t};s.prototype.add=function(t){var e=i(this.value),a=i(t),n=e>a?e:a,s=(Math.pow(10,n)*r(this.value)+Math.pow(10,n)*r(t))/Math.pow(10,n);return this.value.toString().indexOf("%")>0&&t.toString().indexOf("%")>0?100*s+"%":s},s.prototype.sub=function(t){var e=i(this.value),a=i(t),n=e>a?e:a,s=(Math.pow(10,n)*r(this.value)-Math.pow(10,n)*r(t))/Math.pow(10,n);return this.value.toString().indexOf("%")>0&&t.toString().indexOf("%")>0?100*s+"%":s},s.prototype.div=function(t){var e=i(this.value),a=i(t),n=e>a?e:a,s=Math.pow(10,n)*r(this.value)/(Math.pow(10,n)*r(t));return this.value.toString().indexOf("%")>0&&t.toString().indexOf("%")>0?100*s+"%":s},s.prototype.mul=function(t){var e=i(this.value),a=i(t),n=e>a?e:a,s=Math.pow(10,n)*r(this.value)*Math.pow(10,n)*r(t)/Math.pow(10,2*n);return this.value.toString().indexOf("%")>0&&t.toString().indexOf("%")>0?100*s+"%":s},e.a=n},59:function(t,e,a){"use strict";var n=a(173),s=a.n(n),i=a(572),r=a(571),o=a(42);i.a.defaults.baseURL="";var l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";"object"==(void 0===e?"undefined":s()(e))&&(e=o.a.toUrl(e));var n={url:t+e,method:"GET"};return a.i(i.a)(n).then(function(t){return t}).catch(function(t){return t.status})},c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={url:t,method:"POST",data:e};return a.i(i.a)(n).then(function(t){return t}).catch(function(t){return t.response.status})},u={getUserInfo:function(){return l(r.a.userInfoAddr)},getDepts:function(){return l(r.a.deptsAddr)},getFloors:function(){return l(r.a.floorsAddr)},getTypes:function(){return l(r.a.typesAddr)},createBaseInfo:function(t){return c(r.a.createBaseInfoAddr,t)},editBaseInfo:function(t){return c(r.a.editBaseInfoAddr,t)},getOldBaseInfo:function(t){return l(r.a.oldBaseInfoAddr,t)},generateTable:function(t){return c(r.a.generateTableAddr,t)},getOldTable:function(t){return l(r.a.oldTableInfoAddr,t)},saveTable:function(t){return c(r.a.saveTableAddr,t)},updateTable:function(t){return c(r.a.updateTableAddr,t)},deleteTable:function(t){return c(r.a.deleteTableAddr,t)},saveOldEntryInfo:function(t){return c(r.a.saveOldEntryInfoAddr,t)},saveNewEntryInfo:function(t){return c(r.a.saveNewEntryInfoAddr,t)},saveOldCharts:function(t){return c(r.a.saveOldChartsAddr,t)},getIndicators:function(t){return l(r.a.indicatorsAddr,t)},deleteIndicator:function(t){return l(r.a.deleteIndicatorAddr,t)},upload:function(t){return c(r.a.fileUploadAddr,t)},getOldResult:function(t){return l(r.a.oldResultAddr,t)},previewData:function(t){return l(r.a.previewAddr,t)}};e.a=u},902:function(t,e){},903:function(t,e){},904:function(t,e){},905:function(t,e){},906:function(t,e){},907:function(t,e){},908:function(t,e){},909:function(t,e){},910:function(t,e){},911:function(t,e){},912:function(t,e){},913:function(t,e){},914:function(t,e){},915:function(t,e){},916:function(t,e){},917:function(t,e){},918:function(t,e){},919:function(t,e){},925:function(t,e,a){function n(t){return a(s(t))}function s(t){var e=i[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var i={"./af":262,"./af.js":262,"./ar":269,"./ar-dz":263,"./ar-dz.js":263,"./ar-kw":264,"./ar-kw.js":264,"./ar-ly":265,"./ar-ly.js":265,"./ar-ma":266,"./ar-ma.js":266,"./ar-sa":267,"./ar-sa.js":267,"./ar-tn":268,"./ar-tn.js":268,"./ar.js":269,"./az":270,"./az.js":270,"./be":271,"./be.js":271,"./bg":272,"./bg.js":272,"./bm":273,"./bm.js":273,"./bn":274,"./bn.js":274,"./bo":275,"./bo.js":275,"./br":276,"./br.js":276,"./bs":277,"./bs.js":277,"./ca":278,"./ca.js":278,"./cs":279,"./cs.js":279,"./cv":280,"./cv.js":280,"./cy":281,"./cy.js":281,"./da":282,"./da.js":282,"./de":285,"./de-at":283,"./de-at.js":283,"./de-ch":284,"./de-ch.js":284,"./de.js":285,"./dv":286,"./dv.js":286,"./el":287,"./el.js":287,"./en-au":288,"./en-au.js":288,"./en-ca":289,"./en-ca.js":289,"./en-gb":290,"./en-gb.js":290,"./en-ie":291,"./en-ie.js":291,"./en-nz":292,"./en-nz.js":292,"./eo":293,"./eo.js":293,"./es":296,"./es-do":294,"./es-do.js":294,"./es-us":295,"./es-us.js":295,"./es.js":296,"./et":297,"./et.js":297,"./eu":298,"./eu.js":298,"./fa":299,"./fa.js":299,"./fi":300,"./fi.js":300,"./fo":301,"./fo.js":301,"./fr":304,"./fr-ca":302,"./fr-ca.js":302,"./fr-ch":303,"./fr-ch.js":303,"./fr.js":304,"./fy":305,"./fy.js":305,"./gd":306,"./gd.js":306,"./gl":307,"./gl.js":307,"./gom-latn":308,"./gom-latn.js":308,"./gu":309,"./gu.js":309,"./he":310,"./he.js":310,"./hi":311,"./hi.js":311,"./hr":312,"./hr.js":312,"./hu":313,"./hu.js":313,"./hy-am":314,"./hy-am.js":314,"./id":315,"./id.js":315,"./is":316,"./is.js":316,"./it":317,"./it.js":317,"./ja":318,"./ja.js":318,"./jv":319,"./jv.js":319,"./ka":320,"./ka.js":320,"./kk":321,"./kk.js":321,"./km":322,"./km.js":322,"./kn":323,"./kn.js":323,"./ko":324,"./ko.js":324,"./ky":325,"./ky.js":325,"./lb":326,"./lb.js":326,"./lo":327,"./lo.js":327,"./lt":328,"./lt.js":328,"./lv":329,"./lv.js":329,"./me":330,"./me.js":330,"./mi":331,"./mi.js":331,"./mk":332,"./mk.js":332,"./ml":333,"./ml.js":333,"./mr":334,"./mr.js":334,"./ms":336,"./ms-my":335,"./ms-my.js":335,"./ms.js":336,"./mt":337,"./mt.js":337,"./my":338,"./my.js":338,"./nb":339,"./nb.js":339,"./ne":340,"./ne.js":340,"./nl":342,"./nl-be":341,"./nl-be.js":341,"./nl.js":342,"./nn":343,"./nn.js":343,"./pa-in":344,"./pa-in.js":344,"./pl":345,"./pl.js":345,"./pt":347,"./pt-br":346,"./pt-br.js":346,"./pt.js":347,"./ro":348,"./ro.js":348,"./ru":349,"./ru.js":349,"./sd":350,"./sd.js":350,"./se":351,"./se.js":351,"./si":352,"./si.js":352,"./sk":353,"./sk.js":353,"./sl":354,"./sl.js":354,"./sq":355,"./sq.js":355,"./sr":357,"./sr-cyrl":356,"./sr-cyrl.js":356,"./sr.js":357,"./ss":358,"./ss.js":358,"./sv":359,"./sv.js":359,"./sw":360,"./sw.js":360,"./ta":361,"./ta.js":361,"./te":362,"./te.js":362,"./tet":363,"./tet.js":363,"./th":364,"./th.js":364,"./tl-ph":365,"./tl-ph.js":365,"./tlh":366,"./tlh.js":366,"./tr":367,"./tr.js":367,"./tzl":368,"./tzl.js":368,"./tzm":370,"./tzm-latn":369,"./tzm-latn.js":369,"./tzm.js":370,"./uk":371,"./uk.js":371,"./ur":372,"./ur.js":372,"./uz":374,"./uz-latn":373,"./uz-latn.js":373,"./uz.js":374,"./vi":375,"./vi.js":375,"./x-pseudo":376,"./x-pseudo.js":376,"./yo":377,"./yo.js":377,"./zh-cn":378,"./zh-cn.js":378,"./zh-hk":379,"./zh-hk.js":379,"./zh-tw":380,"./zh-tw.js":380};n.keys=function(){return Object.keys(i)},n.resolve=s,t.exports=n,n.id=925},988:function(t,e,a){function n(t){return a(s(t))}function s(t){var e=i[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var i={"./af":381,"./af.js":381,"./ar":388,"./ar-dz":382,"./ar-dz.js":382,"./ar-kw":383,"./ar-kw.js":383,"./ar-ly":384,"./ar-ly.js":384,"./ar-ma":385,"./ar-ma.js":385,"./ar-sa":386,"./ar-sa.js":386,"./ar-tn":387,"./ar-tn.js":387,"./ar.js":388,"./az":389,"./az.js":389,"./be":390,"./be.js":390,"./bg":391,"./bg.js":391,"./bm":392,"./bm.js":392,"./bn":393,"./bn.js":393,"./bo":394,"./bo.js":394,"./br":395,"./br.js":395,"./bs":396,"./bs.js":396,"./ca":397,"./ca.js":397,"./cs":398,"./cs.js":398,"./cv":399,"./cv.js":399,"./cy":400,"./cy.js":400,"./da":401,"./da.js":401,"./de":404,"./de-at":402,"./de-at.js":402,"./de-ch":403,"./de-ch.js":403,"./de.js":404,"./dv":405,"./dv.js":405,"./el":406,"./el.js":406,"./en-au":407,"./en-au.js":407,"./en-ca":408,"./en-ca.js":408,"./en-gb":409,"./en-gb.js":409,"./en-ie":410,"./en-ie.js":410,"./en-il":411,"./en-il.js":411,"./en-nz":412,"./en-nz.js":412,"./eo":413,"./eo.js":413,"./es":416,"./es-do":414,"./es-do.js":414,"./es-us":415,"./es-us.js":415,"./es.js":416,"./et":417,"./et.js":417,"./eu":418,"./eu.js":418,"./fa":419,"./fa.js":419,"./fi":420,"./fi.js":420,"./fo":421,"./fo.js":421,"./fr":424,"./fr-ca":422,"./fr-ca.js":422,"./fr-ch":423,"./fr-ch.js":423,"./fr.js":424,"./fy":425,"./fy.js":425,"./gd":426,"./gd.js":426,"./gl":427,"./gl.js":427,"./gom-latn":428,"./gom-latn.js":428,"./gu":429,"./gu.js":429,"./he":430,"./he.js":430,"./hi":431,"./hi.js":431,"./hr":432,"./hr.js":432,"./hu":433,"./hu.js":433,"./hy-am":434,"./hy-am.js":434,"./id":435,"./id.js":435,"./is":436,"./is.js":436,"./it":437,"./it.js":437,"./ja":438,"./ja.js":438,"./jv":439,"./jv.js":439,"./ka":440,"./ka.js":440,"./kk":441,"./kk.js":441,"./km":442,"./km.js":442,"./kn":443,"./kn.js":443,"./ko":444,"./ko.js":444,"./ky":445,"./ky.js":445,"./lb":446,"./lb.js":446,"./lo":447,"./lo.js":447,"./lt":448,"./lt.js":448,"./lv":449,"./lv.js":449,"./me":450,"./me.js":450,"./mi":451,"./mi.js":451,"./mk":452,"./mk.js":452,"./ml":453,"./ml.js":453,"./mn":454,"./mn.js":454,"./mr":455,"./mr.js":455,"./ms":457,"./ms-my":456,"./ms-my.js":456,"./ms.js":457,"./mt":458,"./mt.js":458,"./my":459,"./my.js":459,"./nb":460,"./nb.js":460,"./ne":461,"./ne.js":461,"./nl":463,"./nl-be":462,"./nl-be.js":462,"./nl.js":463,"./nn":464,"./nn.js":464,"./pa-in":465,"./pa-in.js":465,"./pl":466,"./pl.js":466,"./pt":468,"./pt-br":467,"./pt-br.js":467,"./pt.js":468,"./ro":469,"./ro.js":469,"./ru":470,"./ru.js":470,"./sd":471,"./sd.js":471,"./se":472,"./se.js":472,"./si":473,"./si.js":473,"./sk":474,"./sk.js":474,"./sl":475,"./sl.js":475,"./sq":476,"./sq.js":476,"./sr":478,"./sr-cyrl":477,"./sr-cyrl.js":477,"./sr.js":478,"./ss":479,"./ss.js":479,"./sv":480,"./sv.js":480,"./sw":481,"./sw.js":481,"./ta":482,"./ta.js":482,"./te":483,"./te.js":483,"./tet":484,"./tet.js":484,"./tg":485,"./tg.js":485,"./th":486,"./th.js":486,"./tl-ph":487,"./tl-ph.js":487,"./tlh":488,"./tlh.js":488,"./tr":489,"./tr.js":489,"./tzl":490,"./tzl.js":490,"./tzm":492,"./tzm-latn":491,"./tzm-latn.js":491,"./tzm.js":492,"./ug-cn":493,"./ug-cn.js":493,"./uk":494,"./uk.js":494,"./ur":495,"./ur.js":495,"./uz":497,"./uz-latn":496,"./uz-latn.js":496,"./uz.js":497,"./vi":498,"./vi.js":498,"./x-pseudo":499,"./x-pseudo.js":499,"./yo":500,"./yo.js":500,"./zh-cn":501,"./zh-cn.js":501,"./zh-hk":502,"./zh-hk.js":502,"./zh-tw":503,"./zh-tw.js":503};n.keys=function(){return Object.keys(i)},n.resolve=s,t.exports=n,n.id=988},997:function(t,e,a){function n(t){a(906)}var s=a(19)(a(556),a(1010),n,null,null);t.exports=s.exports},998:function(t,e,a){function n(t){a(908)}var s=a(19)(a(557),a(1012),n,null,null);t.exports=s.exports},999:function(t,e,a){function n(t){a(915)}var s=a(19)(a(558),a(1019),n,"data-v-69a150b9",null);t.exports=s.exports}},[570]);
//# sourceMappingURL=app.17fc14496bc6f32fae24.js.map