webpackJsonp([1],{1e3:function(e,t){},1001:function(e,t){},1002:function(e,t){},1003:function(e,t){},1004:function(e,t){},1005:function(e,t){},1006:function(e,t){},1068:function(e,t,a){function n(e){return a(s(e))}function s(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var r={"./af":335,"./af.js":335,"./ar":342,"./ar-dz":336,"./ar-dz.js":336,"./ar-kw":337,"./ar-kw.js":337,"./ar-ly":338,"./ar-ly.js":338,"./ar-ma":339,"./ar-ma.js":339,"./ar-sa":340,"./ar-sa.js":340,"./ar-tn":341,"./ar-tn.js":341,"./ar.js":342,"./az":343,"./az.js":343,"./be":344,"./be.js":344,"./bg":345,"./bg.js":345,"./bm":346,"./bm.js":346,"./bn":347,"./bn.js":347,"./bo":348,"./bo.js":348,"./br":349,"./br.js":349,"./bs":350,"./bs.js":350,"./ca":351,"./ca.js":351,"./cs":352,"./cs.js":352,"./cv":353,"./cv.js":353,"./cy":354,"./cy.js":354,"./da":355,"./da.js":355,"./de":358,"./de-at":356,"./de-at.js":356,"./de-ch":357,"./de-ch.js":357,"./de.js":358,"./dv":359,"./dv.js":359,"./el":360,"./el.js":360,"./en-au":361,"./en-au.js":361,"./en-ca":362,"./en-ca.js":362,"./en-gb":363,"./en-gb.js":363,"./en-ie":364,"./en-ie.js":364,"./en-nz":365,"./en-nz.js":365,"./eo":366,"./eo.js":366,"./es":369,"./es-do":367,"./es-do.js":367,"./es-us":368,"./es-us.js":368,"./es.js":369,"./et":370,"./et.js":370,"./eu":371,"./eu.js":371,"./fa":372,"./fa.js":372,"./fi":373,"./fi.js":373,"./fo":374,"./fo.js":374,"./fr":377,"./fr-ca":375,"./fr-ca.js":375,"./fr-ch":376,"./fr-ch.js":376,"./fr.js":377,"./fy":378,"./fy.js":378,"./gd":379,"./gd.js":379,"./gl":380,"./gl.js":380,"./gom-latn":381,"./gom-latn.js":381,"./gu":382,"./gu.js":382,"./he":383,"./he.js":383,"./hi":384,"./hi.js":384,"./hr":385,"./hr.js":385,"./hu":386,"./hu.js":386,"./hy-am":387,"./hy-am.js":387,"./id":388,"./id.js":388,"./is":389,"./is.js":389,"./it":390,"./it.js":390,"./ja":391,"./ja.js":391,"./jv":392,"./jv.js":392,"./ka":393,"./ka.js":393,"./kk":394,"./kk.js":394,"./km":395,"./km.js":395,"./kn":396,"./kn.js":396,"./ko":397,"./ko.js":397,"./ky":398,"./ky.js":398,"./lb":399,"./lb.js":399,"./lo":400,"./lo.js":400,"./lt":401,"./lt.js":401,"./lv":402,"./lv.js":402,"./me":403,"./me.js":403,"./mi":404,"./mi.js":404,"./mk":405,"./mk.js":405,"./ml":406,"./ml.js":406,"./mr":407,"./mr.js":407,"./ms":409,"./ms-my":408,"./ms-my.js":408,"./ms.js":409,"./mt":410,"./mt.js":410,"./my":411,"./my.js":411,"./nb":412,"./nb.js":412,"./ne":413,"./ne.js":413,"./nl":415,"./nl-be":414,"./nl-be.js":414,"./nl.js":415,"./nn":416,"./nn.js":416,"./pa-in":417,"./pa-in.js":417,"./pl":418,"./pl.js":418,"./pt":420,"./pt-br":419,"./pt-br.js":419,"./pt.js":420,"./ro":421,"./ro.js":421,"./ru":422,"./ru.js":422,"./sd":423,"./sd.js":423,"./se":424,"./se.js":424,"./si":425,"./si.js":425,"./sk":426,"./sk.js":426,"./sl":427,"./sl.js":427,"./sq":428,"./sq.js":428,"./sr":430,"./sr-cyrl":429,"./sr-cyrl.js":429,"./sr.js":430,"./ss":431,"./ss.js":431,"./sv":432,"./sv.js":432,"./sw":433,"./sw.js":433,"./ta":434,"./ta.js":434,"./te":435,"./te.js":435,"./tet":436,"./tet.js":436,"./th":437,"./th.js":437,"./tl-ph":438,"./tl-ph.js":438,"./tlh":439,"./tlh.js":439,"./tr":440,"./tr.js":440,"./tzl":441,"./tzl.js":441,"./tzm":443,"./tzm-latn":442,"./tzm-latn.js":442,"./tzm.js":443,"./uk":444,"./uk.js":444,"./ur":445,"./ur.js":445,"./uz":447,"./uz-latn":446,"./uz-latn.js":446,"./uz.js":447,"./vi":448,"./vi.js":448,"./x-pseudo":449,"./x-pseudo.js":449,"./yo":450,"./yo.js":450,"./zh-cn":451,"./zh-cn.js":451,"./zh-hk":452,"./zh-hk.js":452,"./zh-tw":453,"./zh-tw.js":453};n.keys=function(){return Object.keys(r)},n.resolve=s,e.exports=n,n.id=1068},1140:function(e,t,a){function n(e){return a(s(e))}function s(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var r={"./af":460,"./af.js":460,"./ar":467,"./ar-dz":461,"./ar-dz.js":461,"./ar-kw":462,"./ar-kw.js":462,"./ar-ly":463,"./ar-ly.js":463,"./ar-ma":464,"./ar-ma.js":464,"./ar-sa":465,"./ar-sa.js":465,"./ar-tn":466,"./ar-tn.js":466,"./ar.js":467,"./az":468,"./az.js":468,"./be":469,"./be.js":469,"./bg":470,"./bg.js":470,"./bm":471,"./bm.js":471,"./bn":472,"./bn.js":472,"./bo":473,"./bo.js":473,"./br":474,"./br.js":474,"./bs":475,"./bs.js":475,"./ca":476,"./ca.js":476,"./cs":477,"./cs.js":477,"./cv":478,"./cv.js":478,"./cy":479,"./cy.js":479,"./da":480,"./da.js":480,"./de":483,"./de-at":481,"./de-at.js":481,"./de-ch":482,"./de-ch.js":482,"./de.js":483,"./dv":484,"./dv.js":484,"./el":485,"./el.js":485,"./en-au":486,"./en-au.js":486,"./en-ca":487,"./en-ca.js":487,"./en-gb":488,"./en-gb.js":488,"./en-ie":489,"./en-ie.js":489,"./en-il":490,"./en-il.js":490,"./en-nz":491,"./en-nz.js":491,"./eo":492,"./eo.js":492,"./es":495,"./es-do":493,"./es-do.js":493,"./es-us":494,"./es-us.js":494,"./es.js":495,"./et":496,"./et.js":496,"./eu":497,"./eu.js":497,"./fa":498,"./fa.js":498,"./fi":499,"./fi.js":499,"./fo":500,"./fo.js":500,"./fr":503,"./fr-ca":501,"./fr-ca.js":501,"./fr-ch":502,"./fr-ch.js":502,"./fr.js":503,"./fy":504,"./fy.js":504,"./gd":505,"./gd.js":505,"./gl":506,"./gl.js":506,"./gom-latn":507,"./gom-latn.js":507,"./gu":508,"./gu.js":508,"./he":509,"./he.js":509,"./hi":510,"./hi.js":510,"./hr":511,"./hr.js":511,"./hu":512,"./hu.js":512,"./hy-am":513,"./hy-am.js":513,"./id":514,"./id.js":514,"./is":515,"./is.js":515,"./it":516,"./it.js":516,"./ja":517,"./ja.js":517,"./jv":518,"./jv.js":518,"./ka":519,"./ka.js":519,"./kk":520,"./kk.js":520,"./km":521,"./km.js":521,"./kn":522,"./kn.js":522,"./ko":523,"./ko.js":523,"./ky":524,"./ky.js":524,"./lb":525,"./lb.js":525,"./lo":526,"./lo.js":526,"./lt":527,"./lt.js":527,"./lv":528,"./lv.js":528,"./me":529,"./me.js":529,"./mi":530,"./mi.js":530,"./mk":531,"./mk.js":531,"./ml":532,"./ml.js":532,"./mn":533,"./mn.js":533,"./mr":534,"./mr.js":534,"./ms":536,"./ms-my":535,"./ms-my.js":535,"./ms.js":536,"./mt":537,"./mt.js":537,"./my":538,"./my.js":538,"./nb":539,"./nb.js":539,"./ne":540,"./ne.js":540,"./nl":542,"./nl-be":541,"./nl-be.js":541,"./nl.js":542,"./nn":543,"./nn.js":543,"./pa-in":544,"./pa-in.js":544,"./pl":545,"./pl.js":545,"./pt":547,"./pt-br":546,"./pt-br.js":546,"./pt.js":547,"./ro":548,"./ro.js":548,"./ru":549,"./ru.js":549,"./sd":550,"./sd.js":550,"./se":551,"./se.js":551,"./si":552,"./si.js":552,"./sk":553,"./sk.js":553,"./sl":554,"./sl.js":554,"./sq":555,"./sq.js":555,"./sr":557,"./sr-cyrl":556,"./sr-cyrl.js":556,"./sr.js":557,"./ss":558,"./ss.js":558,"./sv":559,"./sv.js":559,"./sw":560,"./sw.js":560,"./ta":561,"./ta.js":561,"./te":562,"./te.js":562,"./tet":563,"./tet.js":563,"./tg":564,"./tg.js":564,"./th":565,"./th.js":565,"./tl-ph":566,"./tl-ph.js":566,"./tlh":567,"./tlh.js":567,"./tr":568,"./tr.js":568,"./tzl":569,"./tzl.js":569,"./tzm":571,"./tzm-latn":570,"./tzm-latn.js":570,"./tzm.js":571,"./ug-cn":572,"./ug-cn.js":572,"./uk":573,"./uk.js":573,"./ur":574,"./ur.js":574,"./uz":576,"./uz-latn":575,"./uz-latn.js":575,"./uz.js":576,"./vi":577,"./vi.js":577,"./x-pseudo":578,"./x-pseudo.js":578,"./yo":579,"./yo.js":579,"./zh-cn":580,"./zh-cn.js":580,"./zh-hk":581,"./zh-hk.js":581,"./zh-tw":582,"./zh-tw.js":582};n.keys=function(){return Object.keys(r)},n.resolve=s,e.exports=n,n.id=1140},1156:function(e,t,a){function n(e){a(995)}var s=a(20)(a(644),a(1168),n,null,null);e.exports=s.exports},1157:function(e,t,a){function n(e){a(1002)}var s=a(20)(a(645),a(1175),n,"data-v-69a150b9",null);e.exports=s.exports},1158:function(e,t,a){function n(e){a(1004)}var s=a(20)(a(646),a(1177),n,null,null);e.exports=s.exports},1159:function(e,t,a){function n(e){a(1003)}var s=a(20)(a(648),a(1176),n,"data-v-789a7ff7",null);e.exports=s.exports},1160:function(e,t,a){function n(e){a(994)}var s=a(20)(a(649),a(1167),n,null,null);e.exports=s.exports},1161:function(e,t,a){function n(e){a(997)}var s=a(20)(a(650),a(1170),n,null,null);e.exports=s.exports},1162:function(e,t,a){function n(e){a(1e3)}var s=a(20)(a(652),a(1173),n,null,null);e.exports=s.exports},1163:function(e,t,a){function n(e){a(999)}var s=a(20)(a(653),a(1172),n,null,null);e.exports=s.exports},1164:function(e,t,a){function n(e){a(998)}var s=a(20)(a(654),a(1171),n,null,null);e.exports=s.exports},1165:function(e,t,a){function n(e){a(1006)}var s=a(20)(a(655),a(1179),n,null,null);e.exports=s.exports},1166:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"charts-box",attrs:{"data-option":e.options}},[e.readonly?a("div",{staticClass:"charts-controller"},[e._m(0),e._v(" "),a("ul",e._l(e.controllers,function(t){return a("li",{key:t.index,on:{click:function(a){e.changeHandle(t.value)}}},[e._v("\n        "+e._s(t.label)+"\n      ")])}))]):e._e(),e._v(" "),a("div",{ref:"box",staticClass:"charts-display"})])},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"controller-icons"},[a("i"),e._v(" "),a("i"),e._v(" "),a("i")])}]}},1167:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("w-header"),e._v(" "),a("w-sidebar"),e._v(" "),a("div",{staticClass:"content",attrs:{id:"content"}},[a("router-view"),e._v(" "),a("transition",{attrs:{name:"scroll"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.top>200,expression:"top > 200"}],staticClass:"scroll-to-up",on:{click:e.backToTop}},[a("i",{staticClass:"el-icon-caret-top"})])])],1)],1)},staticRenderFns:[]}},1168:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"spread-chart"},[a("IEcharts",{attrs:{option:e.spreadChart,notMerge:!0}}),e._v(" "),e.toggleEdit?a("div",{staticClass:"icon-wrap"},[a("i",{staticClass:"el-icon-check",staticStyle:{"margin-right":"5px"},on:{click:e.saveEdit}},[a("span",{staticClass:"icon-title-save"},[e._v("确认")])]),e._v(" "),a("i",{staticClass:"el-icon-close",on:{click:e.cancelEdit}},[a("span",{staticClass:"icon-title-cancel"},[e._v("取消")])])]):a("i",{staticClass:"el-icon-edit",on:{click:e.editTitle}},[a("span",{staticClass:"icon-title-edit"},[e._v("编辑标题")])]),e._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:e.toggleEdit,expression:"toggleEdit"}],attrs:{type:"textarea",autosize:{minRows:1},resize:"none",placeholder:"请输入标题"},model:{value:e.spreadTitle,callback:function(t){e.spreadTitle=t},expression:"spreadTitle"}})],1)},staticRenderFns:[]}},1169:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"gray-wrap"},[a("div",{staticClass:"preview",attrs:{id:"preview"}},[a("br"),e._v(" "),a("br"),e._v(" "),a("br"),e._v(" "),a("br"),e._v(" "),a("div",{staticClass:"header"},[e._v("\n        树兰（杭州）医院"),a("br"),e._v("医院质量指标检测报告\n        "),a("span",{staticClass:"noprint print-btn",on:{click:e.htmlToCanvas}},[e._v("打印")])]),e._v(" "),a("div",{staticClass:"body"},[a("div",{staticClass:"paragraph"},[a("span",[e._v("1  指标名称：")]),e._v(" "),a("div",{staticClass:"content1"},[e._v(e._s(e.indicatorsInfo.quotaName||"暂无"))])]),e._v(" "),a("div",{staticClass:"paragraph"},[a("span",[e._v("2  指标类型：")]),e._v(" "),a("div",{staticClass:"content1"},[e._v(e._s(e.indicatorsInfo.quotaTypeName||"暂无"))])]),e._v(" "),a("div",{staticClass:"paragraph"},[a("div",[a("span",[e._v("3  指标定义：")]),e._v(" "),a("div",{staticClass:"content1"},e._l(e.indicatorsInfo.quotaDefinitions,function(t){return a("div",[e._v(e._s(t.quotaDefinitionName||"暂无"))])}))]),e._v(" "),a("div",{staticClass:"nav"},[a("span",[e._v("3.1  分子：")]),e._v(" "),a("div",{staticClass:"content1"},[e._v(e._s(e.indicatorsInfo.molecular||"暂无"))])]),e._v(" "),a("div",{staticClass:"nav"},[a("span",[e._v("3.2  分母：")]),e._v(" "),a("div",{staticClass:"content1"},[e._v(e._s(e.indicatorsInfo.denominator||"暂无"))])]),e._v(" "),a("div",{staticClass:"nav"},[a("span",[e._v("3.3  公式：")]),e._v(" "),a("div",{staticClass:"content1"},[e._v(e._s(e.formula))])])]),e._v(" "),a("div",{staticClass:"paragraph"},[a("span",[e._v("4  检测项目分析报告：")]),e._v(" "),e._l(e.indicatorsTable,function(t,n){return a("div",{key:n,staticStyle:{padding:"20px 0"}},[a("web-excel",{key:n,attrs:{editorAble:!1,"prop-table":t,id:n,allChartsFinished:e.allChartsFinished}})],1)})],2),e._v(" "),a("div",{staticClass:"paragraph"},[a("span",[e._v("5  质量分析：")]),e._v(" "),a("span",{staticClass:"editors",domProps:{innerHTML:e._s(e.resultDom)}})]),e._v(" "),a("div",{staticClass:"paragraph"},[a("span",[e._v("6  原因分析：")]),e._v(" "),a("span",{staticClass:"editors",domProps:{innerHTML:e._s(e.reasonDOM)}})]),e._v(" "),a("div",{staticClass:"paragraph"},[a("span",[e._v("7  改进措施：")]),e._v(" "),a("span",{staticClass:"editors",domProps:{innerHTML:e._s(e.improveDOM)}})]),e._v(" "),a("div",{staticClass:"paragraph"},[a("span",[e._v("8  效果分析：")]),e._v(" "),0==e.effectivePics.length&&""==e.effectDOM?a("div",{staticClass:"content1"},[e._v("暂无")]):e._e(),e._v(" "),a("div",{staticClass:"content1"},[e._l(e.effectivePics,function(e){return a("img",{attrs:{src:e}})}),e._v(" "),a("span",{staticClass:"editors",domProps:{innerHTML:e._s(e.effectDOM)}})],2)])])])])},staticRenderFns:[]}},1170:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"side-bar"},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.currentPath,"unique-opened":"",router:""}},[a("el-menu-item",{attrs:{index:"/indicator/entr"},on:{click:e.initItem}},[a("i",{staticClass:"el-icon-edit"}),e._v("指标录入\n            ")]),e._v(" "),a("el-menu-item",{attrs:{index:"/indicator/libs"}},[a("i",{staticClass:"el-icon-menu"}),e._v("指标库\n            ")])],1)],1)},staticRenderFns:[]}},1171:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"steps"},[a("span",{staticClass:"step stepActive",on:{click:function(t){e.gotoStep(1)}}},[e._v("1、定义指标")]),e._v(" "),a("span",{staticClass:"step stepActive",on:{click:function(t){e.gotoStep(2)}}},[a("span",{staticClass:"arrow arrowActive"}),e._v("2、新增查检表")]),e._v(" "),e._m(0)]),e._v(" "),a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{size:"large",disabled:e.loading},on:{click:function(t){e.gotoStep(2)}}},[e._v("上一步")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"large",disabled:e.loading},on:{click:e.save}},[e._v("保 存")])],1),e._v(" "),a("div",{staticClass:"entry-step entry-step-4"},[a("el-upload",{attrs:{action:"/api/file/upload",headers:e.headers,"before-upload":e.beforeUpload,"on-success":e.uploadedCallback}},[a("el-button",{ref:"imgUpload",attrs:{type:"primary"}},[e._v("从文件中导入图片")])],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",height:"100%"},attrs:{"element-loading-text":"拼命保存中"}}),e._v(" "),a("div",{staticClass:"entry-step-inner"},[a("div",{staticClass:"part"},[a("div",{staticClass:"title"},[e._v("结果分析")]),e._v(" "),a("quill-editor",{ref:"editor",attrs:{options:e.editorOption},model:{value:e.oldResult.resultAnalysis,callback:function(t){e.$set(e.oldResult,"resultAnalysis",t)},expression:"oldResult.resultAnalysis"}})],1),e._v(" "),a("div",{staticClass:"part"},[a("div",{staticClass:"title"},[e._v("原因分析：")]),e._v(" "),a("quill-editor",{ref:"editor2",attrs:{options:e.editorOption},model:{value:e.oldResult.reasonAnalysis,callback:function(t){e.$set(e.oldResult,"reasonAnalysis",t)},expression:"oldResult.reasonAnalysis"}})],1),e._v(" "),a("div",{staticClass:"part"},[a("div",{staticClass:"title"},[e._v("改进措施：")]),e._v(" "),a("quill-editor",{ref:"editor3",attrs:{options:e.editorOption},model:{value:e.oldResult.improvementMeasure,callback:function(t){e.$set(e.oldResult,"improvementMeasure",t)},expression:"oldResult.improvementMeasure"}})],1),e._v(" "),a("div",{staticClass:"part"},[a("div",{staticClass:"title"},[e._v("效果分析：")]),e._v(" "),a("quill-editor",{ref:"editor4",staticStyle:{"margin-top":"20px"},attrs:{options:e.editorOption},model:{value:e.oldResult.effectiveAnalysis,callback:function(t){e.$set(e.oldResult,"effectiveAnalysis",t)},expression:"oldResult.effectiveAnalysis"}})],1)])],1)])},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"step stepActive"},[a("span",{staticClass:"arrow arrowActive"}),e._v("3、分析结果")])}]}},1172:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"steps"},[a("span",{staticClass:"step stepActive",on:{click:function(t){e.confirmGotoStep(1)}}},[e._v("1、定义指标")]),e._v(" "),e._m(0),e._v(" "),a("span",{staticClass:"step",on:{click:function(t){e.confirmGotoStep(3)}}},[a("span",{staticClass:"arrow arrowActive"}),e._v("3、分析结果")])]),e._v(" "),a("div",{staticClass:"button-wrapper"},[a("div",{staticClass:"creat-excel-btn"},[a("el-button",{on:{click:e.addTable}},[a("i",{staticClass:"el-icon-plus",staticStyle:{"font-size":"16px","margin-right":"10px"}}),e._v("\n            新增表格\n          ")])],1),e._v(" "),e.indicatorsTable.length>1?a("el-pagination",{ref:"pagonation",staticClass:"pagonation",attrs:{"current-page":e.currentPage,"page-size":1,layout:"total,prev, pager, next",total:e.indicatorsTable.length},on:{"current-change":e.changePage}}):e._e(),e._v(" "),a("el-button",{attrs:{size:"large"},on:{click:function(t){e.confirmGotoStep(1)}}},[e._v("上一步")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"large"},on:{click:function(t){e.confirmGotoStep(3)}}},[e._v("下一步")])],1),e._v(" "),a("div",{staticClass:"entry-step-2"},[a("div",{staticClass:"indicator-table"},[e.currentTableData?a("web-excel",{attrs:{"prop-table":e.currentTableData,id:e.currentPage-1,save:e.save,delete:e.del},on:{whetherSave:e.dependEdit}}):e._e()],1)])])},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"step stepActive"},[a("span",{staticClass:"arrow arrowActive"}),e._v("2、新增图表")])}]}},1173:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"steps"},[a("span",{staticClass:"step stepActive"},[e._v("1、定义指标")]),e._v(" "),a("span",{staticClass:"step",on:{click:function(t){e.gotoStep(2)}}},[a("span",{staticClass:"arrow arrowActive"}),e._v("2、新增图表")]),e._v(" "),a("span",{staticClass:"step",on:{click:function(t){e.gotoStep(3)}}},[a("span",{staticClass:"arrow"}),e._v("3、分析结果")])]),e._v(" "),a("div",{staticClass:"entry-step entry-step-1"},[a("div",{staticClass:"qulity-form"},[a("div",{staticClass:"input-wrap",staticStyle:{"margin-right":"25px"}},[e._m(0),e._v(" "),a("el-select",{staticClass:"large-input",class:{warning:e.validate.floorId},attrs:{filterable:"",placeholder:"请选择"},on:{change:function(t){e.validate.floorId=!1}},model:{value:e.oldBaseInfo.floorId,callback:function(t){e.$set(e.oldBaseInfo,"floorId",t)},expression:"oldBaseInfo.floorId"}},e._l(e.floors,function(e){return a("el-option",{key:e.floorId,attrs:{label:e.floorName,value:e.floorId}})})),e._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.validate.floorId,expression:"validate.floorId"}],staticClass:"tips"},[e._v("请选择楼层")])])],1),e._v(" "),a("div",{staticClass:"input-wrap"},[e._m(1),e._v(" "),a("el-select",{staticClass:"large-input",class:{warning:e.validate.departmentId},attrs:{filterable:"",placeholder:"请选择"},on:{change:function(t){e.validate.departmentId=!1}},model:{value:e.oldBaseInfo.departmentId,callback:function(t){e.$set(e.oldBaseInfo,"departmentId",t)},expression:"oldBaseInfo.departmentId"}},e._l(e.depts,function(e){return a("el-option",{key:e.departmentId,attrs:{label:e.departmentName,value:e.departmentId}})})),e._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.validate.departmentId,expression:"validate.departmentId"}],staticClass:"tips"},[e._v("请选择专科")])])],1),e._v(" "),a("div",{staticClass:"input-wrap"},[e._m(2),e._v(" "),a("el-input",{staticClass:"large-input",class:{warning:e.validate.quotaName},attrs:{type:"textarea",autosize:{minRows:1},resize:"none",placeholder:"请输入"},on:{change:function(t){e.validate.quotaName=!1}},model:{value:e.oldBaseInfo.quotaName,callback:function(t){e.$set(e.oldBaseInfo,"quotaName",t)},expression:"oldBaseInfo.quotaName"}}),e._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.validate.quotaName,expression:"validate.quotaName"}],staticClass:"tips"},[e._v("请输入指标名称（不能超过600字）")])])],1),e._v(" "),a("div",{staticClass:"input-wrap"},[e._m(3),e._v(" "),a("el-select",{staticClass:"large-input",class:{warning:e.validate.quotaTypeId},attrs:{filterable:"",placeholder:"请选择"},on:{change:function(t){e.validate.quotaTypeId=!1}},model:{value:e.oldBaseInfo.quotaTypeId,callback:function(t){e.$set(e.oldBaseInfo,"quotaTypeId",t)},expression:"oldBaseInfo.quotaTypeId"}},e._l(e.types,function(e){return a("el-option",{key:e.quotaTypeId,attrs:{label:e.quotaTypeName,value:e.quotaTypeId}})})),e._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.validate.quotaTypeId,expression:"validate.quotaTypeId"}],staticClass:"tips"},[e._v("请选择指标类型")])])],1),e._v(" "),a("div",{staticClass:"input-wrap"},[e._m(4),e._v(" "),a("div",{staticClass:"definitions-list "},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},e._l(e.oldBaseInfo.quotaDefinitions,function(t,n){return a("div",{key:n,staticClass:"definition-item"},[a("el-input",{staticClass:"large-input",class:{warning:e.validate.quotaDefinitions[n]},attrs:{type:"textarea",autosize:{minRows:1},resize:"none",placeholder:"请输入"},on:{change:function(t){e.validate.quotaDefinitions[n]=!1}},model:{value:e.oldBaseInfo.quotaDefinitions[n],callback:function(t){e.$set(e.oldBaseInfo.quotaDefinitions,n,t)},expression:"oldBaseInfo.quotaDefinitions[index]"}}),e._v(" "),n==e.oldBaseInfo.quotaDefinitions.length-1?a("i",{staticClass:"el-icon-plus",staticStyle:{cursor:"pointer","margin-left":"10px","vertical-align":"top","margin-top":"9px",color:"#06AEA6","font-size":"16px"},on:{click:e.addQuotaDefinition}}):a("i",{staticClass:"el-icon-delete",staticStyle:{cursor:"pointer","margin-left":"10px","vertical-align":"top","margin-top":"9px",color:"#F36969","font-size":"16px"},on:{click:function(t){e.deleteQuotaDefinition(n)}}}),e._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.validate.quotaDefinitions[n],expression:"validate.quotaDefinitions[index]"}],staticClass:"tips"},[e._v("请输入指标定义（不能超过600字）")])])],1)}))],1)]),e._v(" "),a("div",{staticClass:"input-wrap"},[e._m(5),e._v(" "),a("el-input",{staticClass:"large-input",class:{warning:e.validate.molecular},attrs:{type:"textarea",autosize:{minRows:1},resize:"none",placeholder:"请输入"},on:{change:function(t){e.validate.molecular=!1}},model:{value:e.oldBaseInfo.molecular,callback:function(t){e.$set(e.oldBaseInfo,"molecular",t)},expression:"oldBaseInfo.molecular"}}),e._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.validate.molecular,expression:"validate.molecular"}],staticClass:"tips"},[e._v("请输入分子（不能超过600字）")])])],1),e._v(" "),a("div",{staticClass:"input-wrap"},[e._m(6),e._v(" "),a("el-input",{staticClass:"large-input",class:{warning:e.validate.denominator},attrs:{type:"textarea",autosize:{minRows:1},resize:"none",placeholder:"请输入"},on:{change:function(t){e.validate.denominator=!1}},model:{value:e.oldBaseInfo.denominator,callback:function(t){e.$set(e.oldBaseInfo,"denominator",t)},expression:"oldBaseInfo.denominator"}}),e._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.validate.denominator,expression:"validate.denominator"}],staticClass:"tips"},[e._v("请输入分母（不能超过600字）")])])],1),e._v(" "),a("div",{staticClass:"input-wrap",staticStyle:{display:"flex","align-items":"center"}},[e._m(7),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},[a("div",{staticClass:"formula-input"},[a("span",{staticClass:"bind-data",staticStyle:{"margin-left":"12px"}},[e.oldBaseInfo.molecular?a("span",[e._v(e._s(e.oldBaseInfo.molecular))]):a("span",{staticStyle:{color:"#ccc"}},[e._v("根据分子自动生成")])]),e._v("\n\t\t\t\t\t   /    \n\t\t\t\t\t"),a("span",{staticClass:"bind-data"},[e.oldBaseInfo.denominator?a("span",[e._v(e._s(e.oldBaseInfo.denominator))]):a("span",{staticStyle:{color:"#ccc"}},[e._v("根据分母自动生成")])])]),e._v(" "),a("span",{staticStyle:{"font-size":"20px","vertical-align":"middle","line-height":"30px",color:"#f36969"}},[e._v("*")]),e._v(" "),a("div",{staticStyle:{position:"relative",display:"inline-block",margin:"0 15px"}},[a("el-input",{class:{warning:e.validate.percentage},staticStyle:{width:"110px"},attrs:{placeholder:"请输入数字"},on:{change:function(t){e.validate.percentage=!1}},model:{value:e.oldBaseInfo.percentage,callback:function(t){e.$set(e.oldBaseInfo,"percentage",t)},expression:"oldBaseInfo.percentage"}}),e._v(" "),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.validate.percentage,expression:"validate.percentage"}],staticClass:"tips",staticStyle:{width:"74px",left:"0px"}},[e._v("请输入数字（最多保留2位小数）")])])],1),e._v(" "),a("el-select",{staticClass:"percentage",attrs:{placeholder:"空"},model:{value:e.oldBaseInfo.formulaUnits,callback:function(t){e.$set(e.oldBaseInfo,"formulaUnits",t)},expression:"oldBaseInfo.formulaUnits"}},e._l(e.signs,function(e){return a("el-option",{key:e.key,attrs:{label:e.mark,value:e.key}})}))],1)],1),e._v(" "),a("el-button",{staticClass:"primary-btn",attrs:{type:"primary",size:"large"},on:{click:function(t){e.gotoStep(2)}}},[e._v("下一步")])],1)])])},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"title2"},[a("span",{staticClass:"required"},[e._v("* ")]),e._v("楼层：")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"title2"},[a("span",{staticClass:"required"},[e._v("* ")]),e._v("专科：")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"title2 title-textarea"},[a("span",{staticClass:"required"},[e._v("* ")]),e._v("指标名称：")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"title2"},[a("span",{staticClass:"required"},[e._v("* ")]),e._v("指标类型：")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"title2 title-textarea",staticStyle:{"margin-top":"5px"}},[a("span",{staticClass:"required"},[e._v("* ")]),e._v("指标定义：\n\t\t\t\t\t")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"title2 title-textarea"},[a("span",{staticClass:"required"},[e._v("* ")]),e._v("分子：")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"title2 title-textarea"},[a("span",{staticClass:"required"},[e._v("* ")]),e._v("分母：")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"title2"},[a("span",{staticClass:"required"},[e._v("* ")]),e._v("公式：")])}]}},1174:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"shen"}},[a("router-view")],1)},staticRenderFns:[]}},1175:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"echart-item"},[a("div",{staticClass:"init-chart-wrapper"},[a("div",{staticStyle:{"margin-bottom":"10px","font-size":"16px"}},[e._v("基础图：如下图表由原始数据生成")]),e._v(" "),a("el-radio-group",{on:{change:e.changeBaseEChart},model:{value:e.whichChart,callback:function(t){e.whichChart=t},expression:"whichChart"}},[a("el-radio-button",{attrs:{label:"1"}},[e._v("折线图")]),e._v(" "),a("el-radio-button",{attrs:{label:"2"}},[e._v("柱状图")]),e._v(" "),a("el-radio-button",{attrs:{label:"0"}},[e._v("不生成图")])],1),e._v(" "),a("div",{staticStyle:{width:"540px",height:"300px"}},[e.toggleBaseEChart?a("IEcharts",{attrs:{option:e.chart}}):e._e()],1)],1),e._v(" "),a("div",{staticClass:"spread-chart-wrapper"},[a("div",{staticStyle:{"margin-bottom":"20px","font-size":"16px"}},[e._v("扩展图：选择如下不同的维度生成不同类别的图表")]),e._v(" "),a("el-checkbox-group",{on:{change:e.changeSpreadEChart},model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[a("el-checkbox",{attrs:{label:"1"}},[e._v("以每行为维度分析")]),e._v(" "),a("el-checkbox",{attrs:{label:"2"}},[e._v("以每列为维度分析")]),e._v(" "),"generateTableFour"!=e.chart.tag?a("el-checkbox",{attrs:{label:"3"}},[e._v("柏拉图")]):e._e()],1),e._v(" "),e._l(e.spreadECharts,function(t,n){return a("echarts-spread",{key:n,attrs:{spreadChart:t},on:{eventToParent:e.eventOnChild}})})],2)])},staticRenderFns:[]}},1176:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header"},[e._m(0),e._v(" "),a("div",{staticClass:"userinfo-wrap"},[a("img",{attrs:{src:"/static/imgs/Avatar.png"}}),e._v(" "),a("span",{staticStyle:{"margin-left":"10px","font-size":"12px"}},[e._v(e._s(e.userName))]),e._v(" "),a("span",{staticClass:"exit",on:{click:e.logout}},[e._v("退出")]),e._v(" "),a("form",{staticStyle:{display:"none"},attrs:{action:"/logout",method:"POST",id:"logoutForm"}},[a("input",{attrs:{type:"hidden",name:"_csrf"},domProps:{value:e.csrf}}),e._v(" "),a("input",{attrs:{type:"hidden",name:"_csrf_header",value:"X-XSRF-TOKEN"}}),e._v(" "),a("input",{staticClass:"login-submit",attrs:{type:"submit",value:"退出"}})])])])},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"logo-wrap"},[a("img",{staticStyle:{"margin-left":"55px","margin-right":"66px"},attrs:{src:"/static/imgs/menuclose.png"}}),e._v(" "),a("img",{attrs:{src:"/static/imgs/logo.png"}}),e._v(" "),a("span",{staticClass:"line"},[e._v("质量指标系统")])])}]}},1177:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"mySelect",staticClass:"fake-select"},[e.svg?a("svg",{staticClass:"svg",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":e.svg}})]):e._e(),e._v(" "),a("span",[e._v(e._s(e.name))]),e._v(" "),a("i",{staticClass:"el-icon-arrow-down"}),e._v(" "),a("ul",e._l(e.options,function(t){return a("li",{key:t.index,on:{click:function(a){e.changeHandle(t.value)}}},[e._v("\n      "+e._s(t.label)+"\n    ")])}))])},staticRenderFns:[]}},1178:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{ref:"excelWrap",class:{"excel-wrap":e.editorAble,"excel-display":!e.editorAble}},[a("div",{staticClass:"flex-wrap"},[e.editorAble?a("div",{staticClass:"btn-handle-2"},[a("span",{staticClass:"excel-undo",on:{click:e.undo}},[a("svg",{attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-hebingxingzhuang"}})]),e._v("\n        撤销\n      ")]),e._v(" "),a("span",{staticClass:"excel-redo",on:{click:e.redo}},[a("svg",{attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-hebingxingzhuang"}})]),e._v("\n        重做\n      ")]),e._v(" "),a("el-button",{attrs:{type:"text",disabled:!e.isEdit,loading:e.saving},on:{click:e.saveTable}},[e._v("保存")]),e._v(" "),a("span",{staticClass:"line"}),e._v(" "),a("el-popover",{attrs:{trick:"click",placement:"top-end"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("p",[e._v("确定要删除该表格吗？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.visible=!1}}},[e._v("\n            取消\n          ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.deleteTable}},[e._v("\n            确定\n          ")])],1),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除表")])],1),e._v(" "),a("div",{staticClass:"tools"},[a("span",[e._v("fx")]),e._v(" "),a("input",{ref:"funcInput",attrs:{type:"text",readonly:""}}),e._v(" "),a("FakeSelect",{ref:"funcSelect",attrs:{svg:"#icon-gongshi",changeHandle:e.funcSelect,options:e.excelFunctionsOptions,name:"公式"}}),e._v(" "),a("FakeSelect",{attrs:{svg:"#icon-charutubiao",changeHandle:e.chartSelect,options:e.excelChartsOptions,name:"插入图表"}}),e._v(" "),a("FakeSelect",{attrs:{svg:"#icon-shengchengtubiao",changeHandle:e.chartSelectFull,options:e.excelChartsOptions,name:"自动生成图表"}})],1)],1):e._e(),e._v(" "),a("div",{ref:"excel",staticClass:"hot htCenter handsontable htRowHeaders htColumnHeaders",attrs:{id:e.idName}}),e._v(" "),a("div",{staticClass:"charts"},e._l(e.chartOptionsSourse,function(t,n){return a("div",{key:n,staticClass:"chart-wrap",class:{"title-editing":e.titleEditingIndex===n},on:{mouseenter:function(){return e.toggleChartsRange(t,!0)},mouseleave:function(){return e.toggleChartsRange(t,!1)}}},[a("div",{staticClass:"chart-layer",on:{click:function(){return e.quitChartEditor(n)}}}),e._v(" "),a("div",{staticClass:"chart-title-editor"},[a("input",{attrs:{type:"text",autofocus:""},domProps:{value:t.title},on:{keydown:function(t){return e.titleEditorKeydownHandle(t,n)},input:function(t){e.chartTitleEditorCacheValue=t.target.value}}}),e._v(" "),a("i",{staticClass:"el-icon-close",attrs:{title:"取消"},on:{click:function(){return e.quitChartEditor(n,!1)}}}),e._v(" "),a("i",{staticClass:"el-icon-check",attrs:{title:"保存"},on:{click:function(t){return e.quitChartEditor(n,!0)}}})]),e._v(" "),a("Charts",{attrs:{readonly:e.editorAble,optionsSourse:t,changeHandle:function(t){return e.chartControllerHandle(t,n)},chartsUnit:e.excelCharts,finishedHandle:e.chartsFinishedHandle}})],1)}))])])},staticRenderFns:[]}},1179:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"indicator-lib"},[a("div",{staticClass:"pdf-preview"},[a("Preview",{attrs:{previewData:e.previewData,updatedCallBack:e.addPdf}})],1),e._v(" "),a("section",{staticClass:"form-wrap"},[a("div",{staticClass:"handle-wrap"},[a("span",{staticClass:"input-title"},[e._v("指标名称：")]),e._v(" "),a("el-input",{staticClass:"large-input",attrs:{placeholder:"请输入"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.search(t):null}},model:{value:e.indicator,callback:function(t){e.indicator=t},expression:"indicator"}})],1),e._v(" "),a("div",{staticClass:"handle-wrap"},[a("span",[a("span",{staticClass:"input-title"},[e._v("楼层：")]),e._v(" "),a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.floorId,callback:function(t){e.floorId=t},expression:"floorId"}},e._l(e.floors,function(e){return a("el-option",{key:e.floorId,attrs:{label:e.floorName,value:e.floorId}})}))],1),e._v(" "),a("span",[a("span",{staticClass:"input-title"},[e._v("专科：")]),e._v(" "),a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.deptId,callback:function(t){e.deptId=t},expression:"deptId"}},e._l(e.depts,function(e){return a("el-option",{key:e.departmentId,attrs:{label:e.departmentName,value:e.departmentId}})}))],1)]),e._v(" "),a("div",{staticClass:"handle-wrap"},[a("span",{staticClass:"input-title"},[e._v("录入人员：")]),e._v(" "),a("el-input",{staticClass:"large-input",attrs:{placeholder:"请输入"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.search(t):null}},model:{value:e.person,callback:function(t){e.person=t},expression:"person"}})],1),e._v(" "),a("div",{staticClass:"handle-wrap"},[a("span",{staticClass:"input-title"},[e._v("录入时间：")]),e._v(" "),a("el-date-picker",{staticClass:"date-input large-input",attrs:{type:"daterange",placeholder:"开始时间 - 结束时间",clearable:""},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-bottom":"25px"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("\n\t\t\t\t查 询\n\t\t\t\t")]),e._v(" "),a("el-button",{on:{click:e.reset}},[e._v("\n\t\t\t\t重 置\n\t\t\t\t")])],1)]),e._v(" "),a("section",{staticClass:"display-wrap"},[a("div",{staticClass:"table-title"},[e._v("质量指标库")]),e._v(" "),a("div",{staticClass:"handle-table"},[a("el-button",{attrs:{type:"text"},on:{click:e.pdf}},[e._v("导出")]),e._v(" "),a("span",{staticClass:"line"}),e._v(" "),a("el-button",{attrs:{type:"text"}},[e._v("打印")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"1082"},attrs:{data:e.tableData,"element-loading-text":"拼命加载中","empty-text":"没有您查询的结果，请重新输入条件查询",stripe:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"序列",type:"index",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"quotaName",label:"指标名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"录入人员"}}),e._v(" "),a("el-table-column",{attrs:{prop:"recordDate",label:"录入时间"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{"font-family":"Microsoft YaHei"},attrs:{type:"text"},on:{click:function(a){e.edit(t.row)}}},[e._v("\n\t\t\t\t\t\t编辑\n\t\t\t\t\t\t")]),e._v(" "),a("el-button",{staticStyle:{"font-family":"Microsoft YaHei"},attrs:{type:"text"},on:{click:function(a){e.deleteRow(t.row)}}},[e._v("\n\t\t\t\t\t\t删除\n\t\t\t\t\t\t")]),e._v(" "),a("router-link",{staticStyle:{"margin-left":"10px",color:"#06aea6","text-decoration":"none"},attrs:{to:{name:"preview",query:{quotaId:t.row.quotaId}},target:"_blank"}},[e._v("\n\t\t\t\t\t\t预览\n\t\t\t\t\t\t")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.curPage,"page-sizes":[10,15,20,30],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalPages},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("el-dialog",{attrs:{title:"提示",visible:e.indicatorDialogVisible,top:"4%","show-close":!1},on:{"update:visible":function(t){e.indicatorDialogVisible=t}}},[a("span",[e._v("您确定要删除该指标么？")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDel}},[e._v("确定")]),e._v(" "),a("el-button",{on:{click:function(t){e.indicatorDialogVisible=!1}}},[e._v("取消")])],1)])],1)])},staticRenderFns:[]}},1223:function(e,t){},1224:function(e,t){},46:function(e,t,a){"use strict";var n=a(214),s=a.n(n),r=a(659),i=a(658),o=a(47);r.a.defaults.baseURL="";var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";"object"==(void 0===t?"undefined":s()(t))&&(t=o.a.toUrl(t));var n={url:e+t,method:"GET"};return a.i(r.a)(n).then(function(e){return e}).catch(function(e){return e.status})},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={url:e,method:"POST",data:t};return a.i(r.a)(n).then(function(e){return e}).catch(function(e){return e.response.status})},u={getUserInfo:function(){return l(i.a.userInfoAddr)},getDepts:function(){return l(i.a.deptsAddr)},getFloors:function(){return l(i.a.floorsAddr)},getTypes:function(){return l(i.a.typesAddr)},createBaseInfo:function(e){return c(i.a.createBaseInfoAddr,e)},editBaseInfo:function(e){return c(i.a.editBaseInfoAddr,e)},getOldBaseInfo:function(e){return l(i.a.oldBaseInfoAddr,e)},generateTable:function(e){return c(i.a.generateTableAddr,e)},getOldTable:function(e){return l(i.a.oldTableInfoAddr,e)},saveTable:function(e){return c(i.a.saveTableAddr,e)},updateTable:function(e){return c(i.a.updateTableAddr,e)},deleteTable:function(e){return c(i.a.deleteTableAddr,e)},saveOldEntryInfo:function(e){return c(i.a.saveOldEntryInfoAddr,e)},saveNewEntryInfo:function(e){return c(i.a.saveNewEntryInfoAddr,e)},saveOldCharts:function(e){return c(i.a.saveOldChartsAddr,e)},getIndicators:function(e){return l(i.a.indicatorsAddr,e)},deleteIndicator:function(e){return l(i.a.deleteIndicatorAddr,e)},upload:function(e){return c(i.a.fileUploadAddr,e)},getOldResult:function(e){return l(i.a.oldResultAddr,e)},previewData:function(e){return l(i.a.previewAddr,e)}};t.a=u},47:function(e,t,a){"use strict";var n=a(108),s=a.n(n),r=a(214),i=a.n(r),o={deepClone:function(e){var t=void 0,a=e.constructor===Array?[]:{};if("object"===(void 0===e?"undefined":i()(e))){if(window.JSON)t=s()(e),a=JSON.parse(t);else for(var n in e)a[n]="object"===i()(e[n])?clone(e[n]):e[n];return a}},toUrl:function(e){var t=[];for(var a in e){var n=e[a];t.push(a+"="+n)}return t.join("&")},uuid:function(){for(var e=[],t="0123456789abcdef",a=0;a<32;a++)e[a]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e.join("")},lineFeed:function(e,t){var a=e.length,n=Math.ceil(a/t);if(-1!=e.indexOf("\n"))return e;if(e.length>t){for(var s=e.split(""),r=1;r<n;r++)s.splice(t*r+(r-1),0,"\n");return s.join("")}return e}};t.a=o},589:function(e,t,a){function n(e){a(993)}var s=a(20)(a(643),a(1166),n,null,null);e.exports=s.exports},590:function(e,t,a){function n(e){a(1005)}var s=a(20)(a(647),a(1178),n,null,null);e.exports=s.exports},591:function(e,t,a){function n(e){a(996)}var s=a(20)(a(651),a(1169),n,null,null);e.exports=s.exports},611:function(e,t,a){"use strict";var n=a(29),s=a(1181),r=a(1160),i=a.n(r),o=a(1162),l=a.n(o),c=a(1163),u=a.n(c),d=a(1164),_=a.n(d),f=a(1165),p=a.n(f),h=a(591),v=a.n(h);n.default.use(s.a),t.a=new s.a({routes:[{path:"/",redirect:"/indicator/entryStep1"},{path:"/indicator/entr",redirect:"/indicator/entryStep1"},{path:"/indicator",component:i.a,children:[{path:"entryStep1",name:"entryStep1",component:l.a},{path:"entryStep2",name:"entryStep2",component:u.a},{path:"entryStep3",name:"entryStep3",component:_.a},{path:"libs",name:"libs",component:p.a}]},{path:"/preview",name:"preview",component:v.a}]})},612:function(e,t,a){"use strict";var n=a(108),s=a.n(n),r=a(301),i=a.n(r),o=a(29),l=a(106),c=a(46);o.default.use(l.b);var u={userInfo:{},csrf:{},depts:[],floors:[],types:[],oldBaseInfo:{denominator:"",departmentId:"",floorId:"",molecular:"",percentage:"",quotaName:"",quotaTypeId:"",quotaDefinitions:[null],formulaUnits:"%"},indicatorsTable:[]},d=window.sessionStorage,_={loadUserInfo:function(e){var t=e.commit;c.a.getUserInfo().then(function(e){e.hasOwnProperty("userAdminInfo")?t("SET_USER_INFO",{userInfo:e.userAdminInfo}):(t("SET_USER_INFO",{userInfo:null}),i.a.error({title:"错误："+e,message:"获取用户信息失败!"}))})},loadDepts:function(e){var t=e.commit;c.a.getDepts().then(function(e){t("SET_DEPTS",{depts:e.result})})},loadFloors:function(e){var t=e.commit;c.a.getFloors().then(function(e){t("SET_FLOORS",{floors:e.result})})},loadTypes:function(e){var t=e.commit;c.a.getTypes().then(function(e){t("SET_TYPES",{types:e.responseData.resultList})})}},f={SET_USER_INFO:function(e,t){var a=t.userInfo;e.userInfo=a,d.setItem("userInfo",s()(e.userInfo))},CSRF:function(e,t){e.csrf=t},SET_DEPTS:function(e,t){var a=t.depts;e.depts=a},SET_FLOORS:function(e,t){var a=t.floors;e.floors=a},SET_TYPES:function(e,t){var a=t.types;e.types=a},SET_ECHARTS:function(e,t){e.indicatorsTable=t}},p={userInfoGetter:function(e){return 0==e.userInfo.length&&(e.userInfo=JSON.parse(d.getItem("userInfo"))),e.userInfo},quotaIdGetter:function(e){return e.quotaId}};t.a=new l.b.Store({state:u,getters:p,mutations:f,actions:_})},613:function(e,t,a){"use strict";var n={dateArrayFormat:function(e){var t=this;return e.map(function(e,a,n){return t.dateFormat(e)})},dateFormat:function(e){var t=e.getMonth()+1;t<10&&(t="0"+t);var a=e.getDate();return a<10&&(a="0"+a),e.getFullYear()+"-"+t+"-"+a},fullDateformat:function(e){var t=e.getMonth()+1;t<10&&(t="0"+t);var a=e.getDate();a<10&&(a="0"+a);var n=e.getHours();n<10&&(n="0"+n);var s=e.getMinutes();s<10&&(s="0"+s);var r=e.getSeconds();return r<10&&(r="0"+r),e.getFullYear()+"-"+t+"-"+a+" "+n+":"+s+":"+r}};t.a=n},614:function(e,t,a){"use strict";function n(e){var t=[],a=!0,n=!1,l=void 0;try{for(var c,u=d()(e);!(a=(c=u.next()).done);a=!0){var p=c.value,h={id:p.tableId,tag:p.tableModelFlag,mainType:p.imageType,spreadType:p.flagList,xaxisName:p.xaxisName,yaxisName:p.yaxisName,platoName:p.platoName,notPercentage:s(p.rows),color:f,title:{text:_.a.lineFeed(p.tableName,22),x:"center",width:200,textStyle:{fontSize:15,fontWeight:"normal",width:100},rich:{a:{width:100}}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:i(p.rows),top:35,formatter:function(e){return e.length>3&&-1==location.hash.indexOf("preview")?e.slice(0,3)+"...":e},tooltip:{show:!0}},xAxis:{data:r(p.columns),axisLabel:{interval:0,formatter:function(e){var t=e.length,a=Math.ceil(t/4);if(e.length>4){for(var n=e.split(""),s=1;s<a;s++)n.splice(4*s+(s-1),0,"\n");return n.join("")}return e}}},yAxis:[{type:"value",name:"",axisLabel:{formatter:s(p.rows)?"{value}%":"{value}"}}],series:o(p.rows,p.imageType)};t.push(h)}}catch(e){n=!0,l=e}finally{try{!a&&u.return&&u.return()}finally{if(n)throw l}}return t}function s(e){return e.some(function(e){var t=c()(e.cellList);t[0];return 1==t.slice(1).some(function(e){return-1!==(e.cellValue+"").indexOf("%")})})}function r(e){var t=[],a=c()(e),n=(a[0],a.slice(1)),s=!0,r=!1,i=void 0;try{for(var o,l=d()(n);!(s=(o=l.next()).done);s=!0){var u=o.value;t.push(u.columnName)}}catch(e){r=!0,i=e}finally{try{!s&&l.return&&l.return()}finally{if(r)throw i}}return t}function i(e){var t=[],a=!0,n=!1,s=void 0;try{for(var r,i=d()(e);!(a=(r=i.next()).done);a=!0){var o=r.value,l=c()(o.cellList),u=l[0];l.slice(1);t.push(u.cellValue)}}catch(e){n=!0,s=e}finally{try{!a&&i.return&&i.return()}finally{if(n)throw s}}return t}function o(e,t){var a=[],n=!0,s=!1,r=void 0;try{for(var i,o=d()(e);!(n=(i=o.next()).done);n=!0){var l=i.value,u=c()(l.cellList),_=u[0],f=u.slice(1),h=[],v=!0,m=!1,g=void 0;try{for(var b,y=d()(f);!(v=(b=y.next()).done);v=!0){var C=b.value,E=C.cellValue?C.cellValue.replace("%",""):C.cellValue;h.push(E)}}catch(e){m=!0,g=e}finally{try{!v&&y.return&&y.return()}finally{if(m)throw g}}a.push({name:_.cellValue,type:p[t],data:h})}}catch(e){s=!0,r=e}finally{try{!n&&o.return&&o.return()}finally{if(s)throw r}}return a}t.a=n;var l=a(666),c=a.n(l),u=a(67),d=a.n(u),_=a(47),f=["#ffb847","#29cdff","#7dd97c","#00b4a9","#239af6","#fe6b28","#fd8b8f","#7a6cf7","#779de9","#c23030","#08b53f","#f8e81c"],p={1:"line",2:"bar",0:"pie"}},615:function(e,t,a){"use strict";function n(e,t){var a={type:t,id:e.id,color:_[parseInt(t)],title:{text:"1"!=t?"2"==t?d.a.lineFeed(e.yaxisName,22):d.a.lineFeed(e.platoName,22):d.a.lineFeed(e.xaxisName,22),x:"center",textStyle:{fontSize:15,fontWeight:"normal"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:{data:i(e,t),axisLabel:{interval:0,formatter:function(e){var t=e.length,a=Math.ceil(t/4);if(e.length>4){for(var n=e.split(""),s=1;s<a;s++)n.splice(4*s+(s-1),0,"\n");return n.join("")}return e}}},yAxis:[{type:"value",name:"次数",axisLabel:{formatter:e.notPercentage?"{value}%":"{value}"}}],series:o(e,t)};return"3"==t&&a.yAxis.push({type:"value",name:"累计百分比",axisLabel:{formatter:"{value}%"}}),a}function s(e){for(var t=[],a=0;a<e.series[0].data.length;a++){t[a]=0;for(var n=0;n<e.series.length;n++)t[a]+=Number(e.series[n].data[a])}return{data:t,type:"bar",barWidth:20}}function r(e){var t=[];return e.series.map(function(e){var a=e.data.reduce(function(e,t){return Number(e)+Number(t)});t.push(a)}),{data:t,type:"bar",barWidth:20}}function i(e,t){switch(t){case"1":return e.legend.data;case"2":return e.xAxis.data;case"3":return"generateTableTwo"==e.tag?l(r(e),e.legend.data)[1]:l(s(e),e.xAxis.data)[1]}}function o(e,t){switch(t){case"1":return r(e);case"2":return s(e);case"3":return"generateTableTwo"==e.tag?l(r(e),e.legend.data)[0]:l(s(e),e.xAxis.data)[0]}}function l(e,t){for(var a=d.a.deepClone(e.data),n=d.a.deepClone(t),s=0;s<a.length;s++)for(var r=0;r<a.length-1-s;r++)if(parseInt(a[r])<parseInt(a[r+1])){var i=a[r+1];a[r+1]=a[r],a[r]=i;var o=n[r+1];n[r+1]=n[r],n[r]=o}return[[{data:c(a),type:"bar",barCategoryGap:"0%",barWidth:""},{data:u(a),type:"line",yAxisIndex:1}],n]}function c(e){return e.map(function(e){return{value:e,itemStyle:{normal:{borderColor:""}}}})}function u(e){for(var t=e.reduce(function(e,t){return e+t}),a=[],n=0;n<e.length;n++)a[n]=0==n?parseInt(e[n])/t*100:parseInt(e[n])/t*100+parseFloat(a[n-1]);return a.map(function(e){return parseFloat(e.toFixed(2))})}t.a=n;var d=a(47),_=["#fe6b28",["#ffb847"],["#7a6cf7"],["#3398db","#fe6b28"]]},616:function(e,t,a){"use strict";var n={string:function(e){return!e||e.length>600},value:function(e){return!e},number:function(e){return!!(!e||isNaN(Number(e))||e.length>5)},array:function(e){var t=this;return e.map(function(e){return!(e&&!t.string(e))})},phone:function(e){if(!/^1[34578]\d{9}$/.test(e))return!0},chinese:function(e){return new RegExp("[\\u4E00-\\u9FFF]+","g").test(e)}};t.a=n},618:function(e,t){},619:function(e,t){},620:function(e,t){},621:function(e,t){},622:function(e,t,a){function n(e){a(1001)}var s=a(20)(a(642),a(1174),n,null,null);e.exports=s.exports},623:function(e,t){!function(e){function t(){var e,t;e=document.createElement("div"),e.innerHTML=a,a=null,(t=e.getElementsByTagName("svg")[0])&&(t.setAttribute("aria-hidden","true"),t.style.position="absolute",t.style.width=0,t.style.height=0,t.style.overflow="hidden",i(t,document.body))}var a='<svg><symbol id="icon-zhuyi" viewBox="0 0 1024 1024"><path d="M512 0c282.752 0 512 229.248 512 512 0 282.794667-229.248 512-512 512S0 794.794667 0 512C0 229.290667 229.248 0 512 0z m0 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768z m-42.666667-298.538667v-341.333333h85.333334v341.333333h-85.333334z m0 170.666667v-85.333333h85.333334v85.333333h-85.333334z" fill="#FE9901" ></path></symbol><symbol id="icon-charutubiao" viewBox="0 0 1024 1024"><path d="M800 1024C678.4 1024 576 921.6 576 800S678.4 576 800 576s224 102.4 224 224-102.4 224-224 224z m0-384c-89.6 0-160 70.4-160 160s70.4 160 160 160 160-70.4 160-160-70.4-160-160-160zM512 768H384c-38.4 0-64-25.6-64-64V64c0-38.4 25.6-64 64-64h128c38.4 0 64 25.6 64 64v556.8l-6.4 6.4c-25.6 32-44.8 70.4-51.2 115.2L512 768zM384 64v640h76.8c12.8-38.4 25.6-76.8 51.2-108.8V64H384zM192 768H64c-38.4 0-64-25.6-64-64V256c0-38.4 25.6-64 64-64h128c38.4 0 64 25.6 64 64v448c0 38.4-25.6 64-64 64zM64 256v448h128V256H64z m0-32V256v-32z m576 332.8V320c0-38.4 25.6-64 64-64h128c38.4 0 64 25.6 64 64v204.8l-38.4-6.4c-57.6-12.8-121.6-6.4-172.8 19.2l-44.8 19.2zM704 320v140.8c38.4-12.8 83.2-12.8 128-12.8V320h-128z" fill="#CCCCCC" ></path><path d="M704 768h192v64h-192z" fill="#CCCCCC" ></path><path d="M768 704h64v192h-64z" fill="#CCCCCC" ></path></symbol><symbol id="icon-shanchu" viewBox="0 0 1024 1024"><path d="M256 0h512v128H256zM0 128h1024v128H0zM896 1024H128V256h768v768zM256 896h512V384H256v512z" fill="#F36969" ></path><path d="M384 448h64v320H384zM576 448h64v320H576z" fill="#F36969" ></path></symbol><symbol id="icon-hebingxingzhuang" viewBox="0 0 1097 1024"><path d="M928.914286 1024l-14.628572-73.142857c-36.571429-160.914286-168.228571-285.257143-336.457143-307.2V877.714286L0 438.857143l577.828571-438.857143v234.057143c270.628571 0 482.742857 204.8 482.742858 460.8 0 95.085714-29.257143 182.857143-87.771429 263.314286l-43.885714 65.828571zM504.685714 563.2h36.571429c182.857143 14.628571 343.771429 131.657143 409.6 292.571429 21.942857-51.2 36.571429-102.4 36.571428-160.914286 0-219.428571-182.857143-394.971429-416.914285-394.971429h-65.828572V138.971429L109.714286 438.857143l394.971428 299.885714V563.2z" fill="#979797" ></path></symbol><symbol id="icon-gongshi" viewBox="0 0 1024 1024"><path d="M512 1024c-281.6 0-512-230.4-512-512s230.4-512 512-512 512 230.4 512 512-230.4 512-512 512zM512 64C262.4 64 64 262.4 64 512s198.4 448 448 448 448-198.4 448-448-198.4-448-448-448z" fill="#CCCCCC" ></path><path d="M313.6 704V416h-51.2v-44.8h51.2v-32c0-19.2 0-38.4 6.4-51.2 0-12.8 12.8-25.6 25.6-38.4 12.8-6.4 32-12.8 57.6-12.8 12.8 0 32 0 51.2 6.4l-6.4 51.2h-32c-19.2-6.4-32 0-38.4 6.4s-12.8 19.2-12.8 38.4v32h64v44.8h-64V704h-51.2zM441.6 704l121.6-172.8L448 371.2h70.4L569.6 448c6.4 19.2 19.2 32 19.2 38.4 12.8-12.8 19.2-25.6 25.6-38.4l57.6-76.8h64L627.2 531.2l121.6 172.8h-70.4l-64-102.4-19.2-25.6-89.6 128h-64z" fill="#CCCCCC" ></path></symbol><symbol id="icon-shousuolan" viewBox="0 0 1228 1024"><path d="M0 0h1228.8v102.4H0zM409.6 460.8h819.2v102.4H409.6zM0 512l204.8-102.4v204.8zM0 921.6h1228.8v102.4H0z" fill="#bfbfbf" ></path></symbol><symbol id="icon-icon-zengjia" viewBox="0 0 1024 1024"><path d="M448 448V0h128v448h448v128H576v448H448V576H0V448h448z" fill="#06AEA6" ></path></symbol><symbol id="icon-icon-zhibiaoku" viewBox="0 0 1024 1024"><path d="M102.4 0h819.2a102.4 102.4 0 0 1 102.4 102.4v819.2a102.4 102.4 0 0 1-102.4 102.4H102.4a102.4 102.4 0 0 1-102.4-102.4V102.4a102.4 102.4 0 0 1 102.4-102.4z m51.2 409.6v460.8h102.4V409.6H153.6z m204.8-153.6v614.4h102.4V256H358.4z m204.8 256v358.4h102.4v-358.4h-102.4z m204.8 102.4v256h102.4v-256h-102.4z" fill="#06AEA6" ></path></symbol><symbol id="icon-icon-luruzhibiao" viewBox="0 0 1024 1024"><path d="M870.4 972.8l153.6 0 0 51.2-153.6 0 0-51.2Z" fill="#666666" ></path><path d="M665.6 972.8l153.6 0 0 51.2-153.6 0 0-51.2Z" fill="#666666" ></path><path d="M870.4 365.6704L212.0704 1024H102.4a102.4 102.4 0 0 1-102.4-102.4V102.4a102.4 102.4 0 0 1 102.4-102.4h665.6a102.4 102.4 0 0 1 102.4 102.4v263.2704zM204.8 153.6a51.2 51.2 0 1 0 0 102.4h307.2a51.2 51.2 0 0 0 0-102.4H204.8z m0 256a51.2 51.2 0 1 0 0 102.4h204.8a51.2 51.2 0 1 0 0-102.4H204.8z m0 256a51.2 51.2 0 0 0 0 102.4h102.4a51.2 51.2 0 0 0 0-102.4H204.8z" fill="#666666" ></path><path d="M204.8 870.4h153.6v153.6H204.8zM735.4368 635.5968l108.032 108.0832-217.1904 217.2416-108.032-108.0832 217.1904-217.2416z m108.5952-108.5952l108.0832 108.032-72.3968 72.448-108.032-108.032 72.3456-72.448z m-380.416 488.448l18.432-126.4128 108.032 108.032-126.464 18.432z" fill="#666666" ></path></symbol><symbol id="icon-CellCheck" viewBox="0 0 1210 1024"><path d="M139.636364 512L0 651.636364l372.363636 372.363636 837.818182-791.272727L1070.545455 93.090909 372.363636 744.727273z" fill="#06AEA6" ></path></symbol><symbol id="icon-close" viewBox="0 0 1024 1024"><path d="M1024 102.4L921.6 0 512 409.6 102.4 0 0 102.4 409.6 512 0 921.6 102.4 1024 512 614.4l409.6 409.6 102.4-102.4L614.4 512z" fill="#CCCCCC" ></path></symbol><symbol id="icon-shengchengtubiao" viewBox="0 0 1024 1024"><path d="M726.91358 1024C568.888889 1024 442.469136 897.580247 442.469136 739.555556S568.888889 455.111111 726.91358 455.111111 1011.358025 581.530864 1011.358025 739.555556 884.938272 1024 726.91358 1024z m0-505.679012C606.814815 518.320988 505.679012 619.45679 505.679012 739.555556S606.814815 960.790123 726.91358 960.790123s221.234568-101.135802 221.234568-221.234567S847.012346 518.320988 726.91358 518.320988z" fill="#CCCCCC" ></path><path d="M695.308642 707.950617h63.209877v189.62963h-63.209877zM114.283457 432.102716L275.595062 190.261728l52.590617 35.018272L166.874074 467.184198z" fill="#CCCCCC" ></path><path d="M240.82963 242.725926l35.018271-52.590617L517.688889 351.383704l-35.018272 52.653827z" fill="#CCCCCC" ></path><path d="M429.82716 356.061235L857.125926 0l40.454321 48.545185L470.281481 404.54321zM0 12.641975h63.209877v695.308642H0zM619.33037 739.239506l107.267161-107.26716 44.689383 44.689382-107.267161 107.267161z" fill="#CCCCCC" ></path><path d="M682.540247 676.661728l44.689383-44.689382 107.26716 107.26716-44.689383 44.689383zM63.209877 644.740741h316.049382v63.209876H63.209877z" fill="#CCCCCC" ></path></symbol></svg>',n=function(){var e=document.getElementsByTagName("script");return e[e.length-1]}(),s=n.getAttribute("data-injectcss"),r=function(e,t){t.parentNode.insertBefore(e,t)},i=function(e,t){t.firstChild?r(e,t.firstChild):t.appendChild(e)};if(s&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}!function(t){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(t,0);else{var a=function(){document.removeEventListener("DOMContentLoaded",a,!1),t()};document.addEventListener("DOMContentLoaded",a,!1)}else document.attachEvent&&function(e,t){var a=e.document,n=!1,s=function(){n||(n=!0,t())},r=function(){try{a.documentElement.doScroll("left")}catch(e){return void setTimeout(r,50)}s()};r(),a.onreadystatechange=function(){"complete"==a.readyState&&(a.onreadystatechange=null,s())}}(e,t)}(t)}(window)},642:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"shen"}},643:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(82),s=a.n(n),r=a(162),i=a.n(r);t.default={props:{optionsSourse:{type:Object},changeHandle:{type:Function},chartsUnit:{type:Object},readonly:{type:Boolean},finishedHandle:{type:Function}},data:function(){return{chart:{},controllers:[{value:"transpose",label:"切换行/列"},{value:"editorTitle",label:"修改标题"},{value:"delete",label:"删除图表"}]}},computed:{options:function(){return this.chartsUnit[this.optionsSourse.type].func(this.optionsSourse)}},method:{},mounted:function(){var e=this;setTimeout(function(){e.chart=i.a.init(e.$refs.box),e.chart.setOption(e.options),e.chart.on("finished",function(){console.log(5),e.finishedHandle&&e.finishedHandle()})})},beforeUpdate:function(){console.log(66),this.chart.clear(),this.chart.setOption(s()({},this.options,{animation:!1}))},updated:function(){}}},644:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(194);t.default={props:{spreadChart:{type:Object}},components:{IEcharts:n.a},data:function(){return{toggleEdit:!1,spreadTitle:this.spreadChart.title.text,tempTitle:this.spreadChart.title.text}},methods:{editTitle:function(){this.toggleEdit=!this.toggleEdit},saveEdit:function(){var e=this;this.spreadChart.title.text=this.$handleObject.lineFeed(this.spreadTitle,22),this.tempTitle=this.spreadTitle,this.$store.state.indicatorsTable.map(function(t){if(t.tableId==e.spreadChart.id)switch(e.spreadChart.type){case"1":t.xaxisName=e.spreadTitle,e.$emit("eventToParent",{xaxisName:e.spreadTitle});break;case"2":t.yaxisName=e.spreadTitle,e.$emit("eventToParent",{yaxisName:e.spreadTitle});break;case"3":t.platoName=e.spreadTitle,e.$emit("eventToParent",{platoName:e.spreadTitle})}}),this.toggleEdit=!1},cancelEdit:function(){this.toggleEdit=!1,this.spreadTitle=this.tempTitle,this.spreadChart.title.text=this.tempTitle}}}},645:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(210),s=a.n(n),r=a(109),i=a.n(r),o=a(67),l=a.n(o),c=a(194),u=a(1156),d=a.n(u),_=a(237),f=(a.n(_),a(245)),p=(a.n(f),a(249)),h=(a.n(p),a(267)),v=(a.n(h),a(273)),m=(a.n(v),a(272));a.n(m);t.default={props:{chart:{type:Object}},components:{IEcharts:c.a,echartsSpread:d.a},data:function(){return{whichChart:this.chart.mainType,chartsType:{1:"line",2:"bar",0:"pie"},checkList:this.chart.spreadType||[],toggleBaseEChart:"0"!=this.chart.mainType,spreadECharts:[],tableMap:{generateTableOne:{rowName:"月份",colName:"项目"},generateTableTwo:{rowName:"项目",colName:"月份"},generateTableThree:{rowName:"科室",colName:"项目"},generateTableFour:{rowName:"科室",colName:"月份"}}}},computed:{tempChart:function(){return this.chart}},created:function(){this.changeSpreadEChart()},methods:{changeBaseEChart:function(){var e=this;this.toggleBaseEChart="0"!=this.whichChart,this.$store.state.indicatorsTable.map(function(t){t.tableId==e.chart.id&&(t.imageType=e.whichChart)}),this.chart.series.map(function(t){t.type=e.chartsType[e.whichChart]})},eventOnChild:function(e){var t=!0,a=!1,n=void 0;try{for(var r,o=l()(i()(this.tempChart));!(t=(r=o.next()).done);t=!0){var c=r.value;c==i()(e)[0]&&(this.tempChart[c]=s()(e)[0])}}catch(e){a=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(a)throw n}}},changeSpreadEChart:function(){var e=this;this.spreadECharts=[],this.checkList.sort().map(function(t){e.spreadECharts.push(e.toSpreadEChart(e.tempChart,t))}),this.$store.state.indicatorsTable.map(function(t){t.tableId==e.chart.id&&(t.flagList=e.$handleObject.deepClone(e.checkList))})}}}},646:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:["changeHandle","options","name","svg"],data:function(){return{}},methods:{}}},647:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__(108),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from__=__webpack_require__(107),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray__=__webpack_require__(213),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray__),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_extends__=__webpack_require__(82),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_extends___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_extends__),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for__=__webpack_require__(146),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for__),__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys__=__webpack_require__(109),__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_6_handsontable_pro__=__webpack_require__(1007),__WEBPACK_IMPORTED_MODULE_6_handsontable_pro___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_handsontable_pro__),__WEBPACK_IMPORTED_MODULE_7_sheetclip__=__webpack_require__(1152),__WEBPACK_IMPORTED_MODULE_7_sheetclip___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_sheetclip__),__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__=__webpack_require__(660),__WEBPACK_IMPORTED_MODULE_9__util_handleObject__=__webpack_require__(47),__WEBPACK_IMPORTED_MODULE_10_handsontable_pro_dist_handsontable_full_css__=__webpack_require__(989),__WEBPACK_IMPORTED_MODULE_10_handsontable_pro_dist_handsontable_full_css___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_10_handsontable_pro_dist_handsontable_full_css__),__WEBPACK_IMPORTED_MODULE_11__fakeSelect_vue__=__webpack_require__(1158),__WEBPACK_IMPORTED_MODULE_11__fakeSelect_vue___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_11__fakeSelect_vue__),__WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__=__webpack_require__(656),__WEBPACK_IMPORTED_MODULE_13__components_echartsWrapper_vue__=__webpack_require__(1157),__WEBPACK_IMPORTED_MODULE_13__components_echartsWrapper_vue___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_13__components_echartsWrapper_vue__),__WEBPACK_IMPORTED_MODULE_14_vue_echarts_v3_src_full_js__=__webpack_require__(1155),__WEBPACK_IMPORTED_MODULE_15__components_echartsBox_vue__=__webpack_require__(589),__WEBPACK_IMPORTED_MODULE_15__components_echartsBox_vue___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_15__components_echartsBox_vue__);__webpack_exports__.default={components:{FakeSelect:__WEBPACK_IMPORTED_MODULE_11__fakeSelect_vue___default.a,IEcharts:__WEBPACK_IMPORTED_MODULE_14_vue_echarts_v3_src_full_js__.a,Charts:__WEBPACK_IMPORTED_MODULE_15__components_echartsBox_vue___default.a},props:{id:{type:[String,Number],default:""},propTable:{type:Object,default:function(){return{}}},editorAble:{type:Boolean,default:!0},save:{type:Function},delete:{type:Function},allChartsFinished:{type:Function}},data:function data(){var self=this;return{excelCharts:__WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__.a,chartOptionsSourse:self.propTable.imgData?JSON.parse(self.propTable.imgData):[],excelFunctionsOptions:__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default()(__WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__.b).map(function(e){return{value:e,label:__WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__.b[e].name}}),excelChartsOptions:__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default()(__WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__.a).map(function(e){return{value:e,label:__WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__.a[e].name}}),titleEditingIndex:"",drawStep:[],chartStep:[],funcStore:{},funcCache:"",visible:!1,hot1:"",isEdit:!1,saving:!1,tableId:self.propTable.tableId,clipboardCache:[],sheetclip:new __WEBPACK_IMPORTED_MODULE_7_sheetclip___default.a,firstSelectedRow:"",firstSelectedCol:"",lastSelectedRow:"",lastSelectedCol:"",chartTitleEditorCacheValue:"",selectedRow:[],hotSettings:{readOnly:!this.editorAble,data:"string"==typeof self.propTable.tableData?JSON.parse(self.propTable.tableData):self.propTable.tableData,mergeCells:!0,comments:!0,colHeaders:!0,rowHeaders:!0,minCols:10,minRows:8,maxCols:15,colWidths:this.editorAble?120:64,rowHeaderWidth:this.editorAble?52:40,rowHeights:this.editorAble?40:30,columnHeaderHeight:this.editorAble?40:30,autoRowSize:{syncLimit:"40%"},outsideClickDeselects:!1,className:"htCenter htMiddle",afterSelection:function(e,t,a,n){self.selectedRange=[e,t,a,n]},afterSelectionEnd:function(e,t,a,n){if(e>a){var s=[a,e];e=s[0],a=s[1]}if(t>n){var r=[n,t];t=r[0],n=r[1]}var i=self.hot1.getSelected();1===i.length&&(self.selectedRow=[]);for(var o=e;o<=a;o++){self.selectedRow[o]||(self.selectedRow[o]=[]);for(var l=t;l<=n;l++)self.selectedRow[o][l]=1}self.hot1[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("lastSelected")]=i,self.funcStore[e+"-"+t]&&/^=/.test(self.funcStore[e+"-"+t])?self.$refs.funcInput.value=self.funcStore[e+"-"+t]:self.$refs.funcInput.value=""},beforeChange:function beforeChange(changes,sourse){var controlStore=function(e,t){var a=self.funcStore;return!1===t?void delete a[e]:a[e]&&a[e].autoFill?void(a[e]=a[e].autoFill):/^=/.test(t)?void(a[e]=t):void delete a[e]},bracketsComplete=function(e){var t=e.match(/\(/g)?e.match(/\(/g).length:0,a=e.match(/\)/g)?e.match(/\)/g).length:0;if(t-a>0)for(var n=0;n<t-a;n++)e+=")";return e},filterNameFunc=function(e){var t=e;return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default()(__WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__.b).forEach(function(e){if(t.toUpperCase().indexOf(e)>0){var a=new RegExp(e+"\\((\\(.*?\\)|[^\\(\\)])*\\)?","g");t=t.replace(a,function(t){return __WEBPACK_IMPORTED_MODULE_12__excelPlugins_excelStaticData__.b[e].func(t)})}}),t},computeValue=function computeValue(row,col,value){if(controlStore([row+"-"+col],value),/^=/.test(value)){var newVal=filterNameFunc(bracketsComplete(value));try{var thisCell=""+String.fromCharCode(col+65)+(row+1);if(newVal.toUpperCase().indexOf(thisCell)>0)throw"choose self";var expression=newVal.replace(/\=/,"").replace(/([a-z]+)(\d+)/gi,function(e,t,a){return self.hot1.getDataAtCell(a-1,t.toUpperCase().charCodeAt(0)-65)||0});newVal=eval(expression)}catch(e){newVal="#VALUE!","choose self"===e?(self.$alert(self.$createElement("p",{class:"confirm-message"},[self.$createElement("svg",null,[self.$createElement("use",{attrs:{"xlink:href":"#icon-zhuyi"}},null)]),self.$createElement("span",null,"公式中的单元格引用了公式的结果，从而创建了循环引用,请重新选择。")]),"范围选择错误",{confirmButtonText:"确定"}),controlStore([row+"-"+col],!1),newVal=null):"funcRender"!==sourse&&self.$alert(self.$createElement("p",{class:"confirm-message"},[self.$createElement("svg",null,[self.$createElement("use",{attrs:{"xlink:href":"#icon-zhuyi"}},null)]),self.$createElement("span",null,"你是否要输入公式文本?\n                      当第一个字符是 = 时，表格会认为它是公式，为避免这个问题，请在 = 号前输入'，例如：'=1+1，则此时单元格会显示：=1+1")]),"公式输入异常",{confirmButtonText:"确定"})}return"Infinity"===newVal?"#DIV/0!":newVal}return/^'=/.test(value)?value.replace(/^'/,""):value};changes.forEach(function(e,t){var a=changes[t][3],n=changes[t][0],s=changes[t][1],r=computeValue(n,s,a);changes[t][3]=r})},afterBeginEditing:function(e,t){self.quitEditor();var a=self.hot1.getActiveEditor(),n=a.TEXTAREA;self.editArea=n,/^=/.test(n.value)&&(n.value="'"+n.value),self.funcStore[e+"-"+t]&&(n.value=self.funcStore[e+"-"+t]);var s=self.inputNode;s.row=e,s.col=t;var r=function(){/^\=/.test(n.value)&&(self.hot1.destroyEditor(!0),self.drawInput(n.value))};r(),n.addEventListener("input",r)},afterChange:function(e,t){"funcRender"!==t&&self.funcRender(),e&&(self.chartDataUpDate(e),self.isEdit=!0,self.$emit("whetherSave",self.isEdit,self.id))},afterCopy:function(e,t){var a=self.hot1.getPlugin("MergeCells").mergedCellsCollection.mergedCells;self.pasteMergeCache=[],a.filter(function(e){if(e.row>=t[0].startRow&&e.col>=t[0].startCol&&t[0].startRow+e.rowspan-1<=t[0].endRow&&t[0].startCol+e.colspan-1<=t[0].endCol)return self.pasteMergeCache.push({rowReduce:e.row-t[0].startRow,colReduce:e.col-t[0].startCol,rowspan:e.rowspan,colspan:e.colspan}),!0}),self.clipboardCache=self.sheetclip.stringify(e)},afterCut:function(e){self.clipboardCache=self.sheetclip.stringify(e)},afterPaste:function(e,t){self.pasteMergeCache.length&&self.pasteMergeCache.forEach(function(e){self.hot1.getPlugin("MergeCells").merge(t[0].startRow+e.rowReduce,t[0].startCol+e.colReduce,t[0].startRow+e.rowReduce+e.rowspan-1,t[0].startCol+e.colReduce+e.colspan-1)}),self.clipboardCache=self.sheetclip.stringify(e)},afterContextMenuShow:function(e){self.firstSelectedRow=this.getSelectedRange()[0].from.row,self.firstSelectedCol=this.getSelectedRange()[0].from.col,self.lastSelectedRow=this.getSelectedRange()[0].to.row,self.lastSelectedCol=this.getSelectedRange()[0].to.col;for(var t=self.firstSelectedRow;t<=self.lastSelectedRow;t++)for(var a=self.firstSelectedCol;a<=self.lastSelectedCol;a++)self.selectedData[t][a]=this.getDataAtCell(t,a)},beforeAutofillInsidePopulate:function(e,t,a,n,s,r){var i=(a[e.row%a.length][e.col%a[0].length],self.selectedRange),o=[];switch(t){case"left":o=[i[0],i[1]-r.col];break;case"right":o=[i[0],i[1]+1];break;case"up":o=[i[0]-r.row,i[1]];break;case"down":o=[i[0]+1,i[1]];break;default:throw error("direction is undefined")}!function(t){if(t){var a=t.replace(/([A-Z]+)([0-9]+)/gi,function(t,a,n){return String.fromCharCode(a.charCodeAt(0)+e.col+o[1]-i[1])+(+n+e.row+o[0]-i[0])});self.funcStore[o[0]+e.row+"-"+(o[1]+e.col)]={autoFill:a}}}(function(e,t){return!!/^\=/.test(self.funcStore[e+"-"+t])&&self.funcStore[e+"-"+t]}(i[0]+e.row%a.length,i[1]+e.col%a[0].length))},afterMergeCells:function(e){self.hot1.setDataAtCell(e.from.row,e.from.col,this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("mergeData")])},beforeUndo:function(e){console.log(e)}}}},watch:{propTable:function(e,t){var a=this;this.chartOptionsSourse=e.imgData?JSON.parse(e.imgData):[],this.tableId=e.tableId,this.hotSettings=__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_extends___default()({},this.hotSettings,{data:"string"==typeof e.tableData?JSON.parse(e.tableData):e.tableData}),this.hot1.updateSettings({data:this.hotSettings.data}),setTimeout(function(){a.isEdit=!1,a.$emit("whetherSave",a.isEdit,a.id)})},"hotSettings.data":function(e,t){this.isEdit=!0,this.$emit("whetherSave",this.isEdit,this.id)},chartOptionsSourse:function(){this.isEdit=!0,this.$emit("whetherSave",this.isEdit,this.id)}},computed:{selectedData:function(){for(var e=[],t=0;t<12;t++){for(var a=[],n=0;n<20;n++)a.push("");e.push(a)}return e},idName:function(){return"excel"+this.id}},methods:{chartDataUpDate:function(e){var t=this;this.chartOptionsSourse=this.chartOptionsSourse.map(function(a){return"full"===a.range?__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_extends___default()({},a,{data:JSON.parse(t.getExcelData().tableData)}):e.some(function(e){return a.selectedRow[e[0]]&&1===a.selectedRow[e[0]][e[1]]})?__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_extends___default()({},a,{data:t.computeChartData(a.selectedRow,a.range)}):a})},computeChartData:function(e,t){var a;if(t&&1===t.length){var n;return(n=this.hot1).getData.apply(n,__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(t[0]))}var s=e.find(function(e){return e}),r=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default()(e).map(function(e,t){return!e&&t}).filter(function(e){return e}),i=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default()(s).map(function(e,t){return!e&&t}).filter(function(e){return e}),o=[e.findIndex(function(e){return e}),s.findIndex(function(e){return e}),e.length-1,s.length-1];return(a=this.hot1).getData.apply(a,o).filter(function(e,t){return!r.includes(t)}).map(function(e){return e.filter(function(e,t){return!i.includes(t)})})},chartSelect:function(e,t){var a=this.hot1[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("lastSelected")],n=void 0;if(a.length>1){var s=this.selectedRow.find(function(e){return e}),r=s.toString();if(this.selectedRow.some(function(e){return e.toString()!==r}))return this.$alert(this.$createElement("p",{class:"confirm-message"},[this.$createElement("svg",null,[this.$createElement("use",{attrs:{"xlink:href":"#icon-zhuyi"}},null)]),this.$createElement("span",null,"图表的数据范围不能形成一个规则矩形,请重新选择。")]),"范围选择错误",{confirmButtonText:"确定"}),!1;n=this.computeChartData(this.selectedRow)}else{var i;n=(i=this.hot1).getData.apply(i,__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(a[0]))}this.chartOptionsSourse.push({data:n,type:e,title:"图表标题",transpose:!1,range:a,selectedRow:this.selectedRow})},chartSelectFull:function(e){this.chartOptionsSourse.push({data:JSON.parse(this.getExcelData().tableData),type:e,title:"图表标题",transpose:!1,range:"full"})},chartControllerHandle:function(e,t){var a=this;switch(e){case"transpose":this.chartOptionsSourse.splice(t,1,__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_extends___default()({},this.chartOptionsSourse[t],{transpose:!this.chartOptionsSourse[t].transpose}));break;case"editorTitle":this.titleEditingIndex=t;break;case"delete":this.$confirm(this.$createElement("p",{class:"confirm-message"},[this.$createElement("svg",null,[this.$createElement("use",{attrs:{"xlink:href":"#icon-zhuyi"}},null)]),this.$createElement("span",null,"确定要删除该表格吗？")]),{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){a.chartOptionsSourse.splice(t,1)}).catch(function(){return!1});break;default:console.log("chartControllerHandle error")}},quitChartEditor:function(e,t){this.titleEditingIndex="",t&&this.chartOptionsSourse.splice(e,1,__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_extends___default()({},this.chartOptionsSourse[e],{title:this.chartTitleEditorCacheValue}))},titleEditorKeydownHandle:function(e,t){13===e.keyCode&&this.quitChartEditor(t,!0),27===e.keyCode&&this.quitChartEditor(t)},toggleChartsRange:function(e,t){var a=this;if(!this.editorAble)return!1;t?"full"===e.range?this.addDrawStep("full","chartStep"):e.range.forEach(function(e){a.addDrawStep.apply(a,__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(e).concat(["chartStep"]))}):this.chartStep=[],this.drawCanvas()},addDrawStep:function addDrawStep(r,c,r2,c2,type){if(r>r2){var _ref3=[r2,r];r=_ref3[0],r2=_ref3[1]}if(c>c2){var _ref4=[c2,c];c=_ref4[0],c2=_ref4[1]}var _this=this,rowsHeight=_this.hot1.getPlugin("autoRowSize").heights.map(function(e){return e<_this.hotSettings.rowHeights?_this.hotSettings.rowHeights:e});"full"===r&&_this[c].push({render:function render(ctx,color){ctx.strokeStyle=color,ctx.strokeRect(_this.hotSettings.rowHeaderWidth,_this.hotSettings.columnHeaderHeight,_this.$refs.excel.clientWidth-_this.hotSettings.rowHeaderWidth,eval(rowsHeight.join("+")))}}),this[type||"drawStep"].push({render:function render(ctx,color){ctx.strokeStyle=color,ctx.strokeRect(_this.hotSettings.rowHeaderWidth+c*_this.hotSettings.colWidths,_this.hotSettings.columnHeaderHeight+(eval(rowsHeight.slice(0,r).join("+"))||0),(c2-c+1)*_this.hotSettings.colWidths,eval(rowsHeight.slice(r,r2+1).join("+")))}})},funcSelect:function(e){var t=this,a=void 0,n=this.inputNode;a="block"===n.style.display?[n.row,n.col]:this.hot1.getSelectedLast(),n.row=a[0],n.col=a[1],setTimeout(function(){t.drawInput("="+e.toUpperCase()+"(",!0)})},funcRender:function(){var e=this,t=__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default()(this.funcStore).map(function(t){var a=e.funcStore[t],n=t.match(/\d+/g);return[+n[0],+n[1],a]});this.hot1&&this.hot1.setDataAtRowProp(t,"funcRender")},createCanvas:function(e){var t=document.createElement("canvas");return e=e.getElementsByClassName("wtHider")[0],e.appendChild(t),this.canvasNode=t,this.createInput(e),t},quitFunctionEditor:function(){this.drawStep=[];var e=this.canvasNode,t=e.getContext("2d"),a=this.inputNode;a.value="",t.clearRect(0,0,e.width,e.height),a.style.display="none",this.inputDisplay.style.display="none"},quitEditor:function(e,t){var a=this,n=this.inputNode;e&&this.hot1.setDataAtCell(n.row,n.col,n.value),this.quitFunctionEditor();for(var s in n.quitCallbacks)n.quitCallbacks.hasOwnProperty(s)&&n.quitCallbacks[s]();t&&setTimeout(function(){a.hot1.selectCell(n.row,n.col,n.row,n.col)})},createInput:function(e){var t=this,a=document.createElement("textarea"),n=document.createElement("div");a.classList.add("layer-input"),n.classList.add("layer-input-display"),this.inputNode=a,this.inputDisplay=n,e.insertBefore(a,this.canvasNode),e.insertBefore(n,this.canvasNode),a.quitCallbacks={},a.addEventListener("keydown",function(e){13!==e.keyCode||e.altKey||e.ctrlKey||e.shiftKey||(e.preventDefault(),t.quitEditor(!0,a.isSelecting)),27===e.keyCode&&(e.preventDefault(),t.quitEditor(!1,!0))}),a.addEventListener("input",this.drawFromInput),a.changeVal=function(e){a.value=e,t.drawFromInput()}},drawCanvas:function(){var e=["#71a1e6","#008000","#9900cc","#800000","#00cc33","#c60","#c09"],t=this.canvasNode;t.width=t.clientWidth,t.height=t.clientHeight;var a=t.getContext("2d");a.clearRect(0,0,t.width,t.height),this.drawStep.forEach(function(t,n){t.render(a,e[n%7])}),this.chartStep.forEach(function(t,n){t.render(a,e[n%7])})},drawInput:function drawInput(value,startEdit){var _this10=this,Input=this.inputNode,InputDisplay=this.inputDisplay,row=Input.row,col=Input.col,rowsHeight=this.hot1.getPlugin("autoRowSize").heights.map(function(e){return e<_this10.hotSettings.rowHeights?_this10.hotSettings.rowHeights:e});Input.style.top=this.hotSettings.columnHeaderHeight+(eval(rowsHeight.slice(0,row).join("+"))||0)+"px",Input.style.left=this.hotSettings.rowHeaderWidth+col*this.hotSettings.colWidths+"px",Input.style.width=this.hotSettings.colWidths+2+"px",Input.style.height=rowsHeight[row]+"px",InputDisplay.style.top=Input.style.top,InputDisplay.style.left=Input.style.left,InputDisplay.style.width=Input.style.width,InputDisplay.style.height=Input.style.height,Input.changeVal(value),Input.style.display="block",InputDisplay.style.display="block",this.hot1.deselectCell(),Input.focus();var cacheValue=value,selectRange=function(e,t,a,n){return e===a&&t===n?""+String.fromCharCode(t+65)+(e+1):""+String.fromCharCode(Math.min(t,n)+65)+(Math.min(e,a)+1)+":"+String.fromCharCode(Math.max(t,n)+65)+(Math.max(e,a)+1)},selectCall=function e(t,a,n,s){var r=void 0,i=void 0,o=void 0;if(i=Input.value.slice(0,Input.selectionStart),o=Input.value.slice(Input.selectionEnd),e.callback=!1,!Input.selectionStart===Input.selectionEnd)r=Input.value.slice(Input.selectionStart,Input.selectionEnd),/([a-z]\d+\:[a-z]\d+|[a-z]\d+)/i.test(r)&&(e.callback=function(e){Input.changeVal(i+e+o)});else{if(/([a-z]\d+\:[a-z]\d+|[a-z]\d+)$/i.test(i)){var l=i.match(/([a-z]\d+\:[a-z]\d+|[a-z]\d+)$/i)[0],c=new RegExp(l+"$");e.callback=function(e){Input.changeVal(i.replace(c,e)+o)}}(/[\*\/\-\+\(\:\^]{1}$/.test(i)||/^\=$/.test(i))&&(e.callback=function(e){Input.changeVal(i+e+o)})}var u=Input.value.length-Input.selectionStart,d=Input.value.length-Input.selectionEnd,_=selectRange(t,a,n,s);e.callback&&e.callback(_),e.callback&&Input.setSelectionRange(Input.value.length-u,Input.value.length-d),Input.focus()},checkToStartSelect=function(){if(Input.isSelecting=!1,_this10.hot1.removeHook("afterSelectionEnd",selectCall),Input.style.height=Input.scrollHeight+4+"px",_this10.inputDisplay.style.height=Input.style.height,!/^=/.test(Input.value))return!1;Input.isSelecting=!0,_this10.hot1.addHook("afterSelectionEnd",selectCall),Input.quitCallbacks.clearSelect=function(){Input.isSelecting=!1,_this10.hot1.removeHook("afterSelectionEnd",selectCall)}};checkToStartSelect(),Input.addEventListener("input",checkToStartSelect);var clickHandle=function(e){return"block"===Input.style.display&&e.target!==Input&&(_this10.$refs.excel.contains(e.target)?void(Input.isSelecting||_this10.quitEditor(!0)):void _this10.quitEditor(!0,!0))};return setTimeout(function(){return window.addEventListener("click",clickHandle)}),Input},drawFromInput:function(){var e=this;if(!/^=/.test(this.inputNode.value))return this.inputDisplay.innerHTML=this.inputNode.value,!1;var t=this.inputNode.value.replace(/([a-z]+\d+\:[a-z]+\d+|[a-z]+\d+)/gi,"<span>$1</span>");this.inputDisplay.innerHTML=t,this.drawStep=[];try{this.inputNode.value.match(/([a-z]+\d+\:[a-z]+\d+|[a-z]+\d+)/gi).forEach(function(t){if(/\:/.test(t)){var a=t.match(/[a-z]/gi)[0].toUpperCase().charCodeAt(0)-65,n=t.match(/[a-z]/gi)[1].toUpperCase().charCodeAt(0)-65,s=t.match(/\d+/g)[0]-1,r=t.match(/\d+/g)[1]-1;e.addDrawStep(s,a,r,n)}else{var i=t.match(/[a-z]/gi)[0].toUpperCase().charCodeAt(0)-65,o=t.match(/\d+/g)[0]-1;e.addDrawStep(o,i,o,i)}}),this.drawCanvas()}catch(e){console.log(e)}},changeCellType:function(e){for(var t=this,a=t.firstSelectedRow;a<=t.lastSelectedRow;a++)for(var n=t.firstSelectedCol;n<=t.lastSelectedCol;n++)if(t.hotSettings.data[a][n]&&!isNaN(parseFloat(t.hotSettings.data[a][n])))switch(e){case 0:case 1:t.$set(t.hotSettings.data[a],n,t.formatNumber(t.selectedData[a][n],null));break;case 2:t.$set(t.hotSettings.data[a],n,t.formatNumber(t.selectedData[a][n],2));break;case 3:t.$set(t.hotSettings.data[a],n,t.formatPercentage(t.selectedData[a][n],null));break;case 4:t.$set(t.hotSettings.data[a],n,t.formatPercentage(t.selectedData[a][n],2))}},formatNumber:function(e,t){if(e){if(e.toString().indexOf("%")<0)return t?parseFloat(e).toFixed(2):e;var a=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(e).div(1);return t?a.toFixed(2):a}return""},formatPercentage:function(e,t){if(e){if(e.toString().indexOf("%")>0)return t?parseFloat(e).toFixed(2)+"%":parseFloat(e).toFixed(0)+"%";var a=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(e).mul(100);return t?a.toFixed(2)+"%":a+"%"}return""},calculateRow:function(e){var t=this;switch(e){case"add":for(var a=t.firstSelectedRow;a<=t.lastSelectedRow;a++){for(var n=t.selectedData[a][t.firstSelectedCol],s=t.firstSelectedCol+1;s<=t.lastSelectedCol;s++){var r=t.selectedData[a][s]||0;n=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(n).add(r)}t.$set(t.hotSettings.data[a],t.lastSelectedCol+1,n)}break;case"sub":for(var i=t.firstSelectedRow;i<=t.lastSelectedRow;i++){for(var o=t.selectedData[i][t.firstSelectedCol],l=t.firstSelectedCol+1;l<=t.lastSelectedCol;l++){var c=t.selectedData[i][l]||0;o=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(o).sub(c)}t.$set(t.hotSettings.data[i],t.lastSelectedCol+1,o)}break;case"div":for(var u=t.firstSelectedRow;u<=t.lastSelectedRow;u++){for(var d=t.selectedData[u][t.firstSelectedCol],_=t.firstSelectedCol+1;_<=t.lastSelectedCol;_++){var f=t.selectedData[u][_]||0;d=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(d).div(f)}t.$set(t.hotSettings.data[u],t.lastSelectedCol+1,d)}break;case"mul":for(var p=t.firstSelectedRow;p<=t.lastSelectedRow;p++){for(var h=t.selectedData[p][t.firstSelectedCol],v=t.firstSelectedCol+1;v<=t.lastSelectedCol;v++){var m=t.selectedData[p][v]||0;h=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(h).mul(m)}t.$set(t.hotSettings.data[p],t.lastSelectedCol+1,h)}break;case"average":for(var g=t.firstSelectedRow;g<=t.lastSelectedRow;g++){for(var b=t.selectedData[g][t.firstSelectedCol],y=1,C=t.firstSelectedCol+1;C<=t.lastSelectedCol;C++){var E=t.selectedData[g][C]||0;b=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(b).add(E),y++}var w=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(parseFloat(b)).div(y);b.toString().indexOf("%")>0&&(w+="%"),t.$set(t.hotSettings.data[g],t.lastSelectedCol+1,w)}}},calculateCol:function(e){var t=this,a=t.hotSettings.data.length,n=t.hotSettings.data[0].length;switch(t.lastSelectedRow+1===a&&t.hotSettings.data.push(new Array(n)),e){case"add":for(var s=t.firstSelectedCol;s<=t.lastSelectedCol;s++){for(var r=t.selectedData[t.firstSelectedRow][s],i=t.firstSelectedRow+1;i<=t.lastSelectedRow;i++){var o=t.selectedData[i][s]||0;r=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(r).add(o)}t.$set(t.hotSettings.data[t.lastSelectedRow+1],s,r)}break;case"sub":for(var l=t.firstSelectedCol;l<=t.lastSelectedCol;l++){for(var c=t.selectedData[t.firstSelectedRow][l],u=t.firstSelectedRow+1;u<=t.lastSelectedRow;u++){var d=t.selectedData[u][l]||0;c=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(c).sub(d)}t.$set(t.hotSettings.data[t.lastSelectedRow+1],l,c)}break;case"div":for(var _=t.firstSelectedCol;_<=t.lastSelectedCol;_++){for(var f=t.selectedData[t.firstSelectedRow][_],p=t.firstSelectedRow+1;p<=t.lastSelectedRow;p++){var h=t.selectedData[p][_]||0;f=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(f).div(h)}t.$set(t.hotSettings.data[t.lastSelectedRow+1],_,f)}break;case"mul":for(var v=t.firstSelectedCol;v<=t.lastSelectedCol;v++){for(var m=t.selectedData[t.firstSelectedRow][v],g=t.firstSelectedRow+1;g<=t.lastSelectedRow;g++){var b=t.selectedData[g][v]||0;m=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(m).mul(b)}t.$set(t.hotSettings.data[t.lastSelectedRow+1],v,m)}break;case"average":for(var y=t.firstSelectedCol;y<=t.lastSelectedCol;y++){for(var C=t.selectedData[t.firstSelectedRow][y],E=1,w=t.firstSelectedRow+1;w<=t.lastSelectedRow;w++){var I=t.selectedData[w][y]||0;C=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(C).add(I),E++}var D=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__util_Calculation_js__.a)(parseFloat(C)).div(E);C.toString().indexOf("%")>0&&(D+="%"),t.$set(t.hotSettings.data[t.lastSelectedRow+1],y,D)}}},getExcelData:function(){__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.hotSettings.data);return{tableData:__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.hotSettings.data),cellInfo:__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.hot1.getPlugin("MergeCells").mergedCellsCollection.mergedCells),quotaId:this.$route.query.quotaId,tableId:this.tableId}},saveTable:function(){var e=this,t=__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_extends___default()({},this.getExcelData(),{imgData:__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.chartOptionsSourse)});this.saving=!0,this.isEdit=!1,this.save(t).then(function(t){"0"==t.responseCode&&(e.tableId=t.result.tableId,e.saving=!1,e.isEdit=!1,e.$message.success("保存成功！"),e.$emit("whetherSave",e.isEdit,e.id))})},deleteTable:function(){var e=this,t={tableId:this.tableId};this.delete(t).then(function(t){"0"==t.responseCode&&(e.$message.success("删除成功"),e.$emit("whetherSave","del",e.id))})},undo:function(){this.hot1.undo()},redo:function(){this.hot1.redo()},chartsFinishedHandle:function(){this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("finishedCharts")]=this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("finishedCharts")]||0,++this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("finishedCharts")]===this.chartOptionsSourse.length&&(this.allChartsFinished(),this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("finishedCharts")]=0)}},mounted:function(){var e=this,t=document.getElementById(""+this.idName);if(e.hot1=new __WEBPACK_IMPORTED_MODULE_6_handsontable_pro___default.a(t,e.hotSettings),e.hot1.updateSettings({contextMenu:{items:{row_above:{name:"向上插入一行"},row_below:{name:"向下插入一行"},col_left:{name:"向左插入一列"},col_right:{name:"向右插入一列"},remove_row:{name:"删除行"},remove_col:{name:"删除列"},mergeCells:{name:function(){var e=this.getSelectedLast();if(e){var t=this.getPlugin("MergeCells").mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("useMerge")]=!1,"取消合并单元格"}return this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("useMerge")]=!0,"合并单元格"},callback:function(t,a){var n=this,s=[a[0].start.row,a[0].start.col,a[0].end.row,a[0].end.col];if(!this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("useMerge")]){var r;return void(r=this.getPlugin("MergeCells")).unmerge.apply(r,s)}var i=this.getData.apply(this,s),o=[];if(i.forEach(function(e){o=[].concat(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(o),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(e))}),o=o.filter(function(e){return e}),o.length>1)e.$confirm(e.$createElement("p",{class:"confirm-message"},[e.$createElement("svg",null,[e.$createElement("use",{attrs:{"xlink:href":"#icon-zhuyi"}},null)]),e.$createElement("span",null,"合并后的单元格将只保留左/上单元格中的值，确定合并吗？")]),"",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e;n[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("mergeData")]=o[0],(e=n.getPlugin("MergeCells")).merge.apply(e,s)}).catch(function(){return!1});else{var l;this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("mergeData")]=o[0],(l=this.getPlugin("MergeCells")).merge.apply(l,s)}}},cellsType:{key:"types",name:"设置单元格格式",submenu:{items:[{key:"types:normal",name:"常规",callback:function(t,a){e.changeCellType(0),e.hot1.render()}},{key:"types:numbers",name:"数字",callback:function(t,a){e.changeCellType(1),e.hot1.render()}},{key:"types:numbersWithDecimal",name:"数字(保留两位小数)",callback:function(t,a){e.changeCellType(2),e.hot1.render()}},{key:"types:percentage",name:"百分比",callback:function(t,a){e.changeCellType(3),e.hot1.render()}},{key:"types:percentageWithDecimal",name:"百分比(保留两位小数)",callback:function(t,a){e.changeCellType(4),e.hot1.render()}}]}},copy:{name:"复制"},cut:{name:"剪切"},paste:{name:"粘贴",disabled:function(){return 0===e.clipboardCache.length},callback:function(){var t=e.hot1.getPlugin("copyPaste");e.hot1.listen(),t.paste(e.clipboardCache)}}}}}),this.editorAble){var a=this.createCanvas(t);this.canvas=a}else 0===this.chartOptionsSourse.length&&(this.allChartsFinished(),this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("finishedCharts")]=0)},updated:function(){0===this.chartOptionsSourse.length&&(this.allChartsFinished(),this[__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_symbol_for___default()("finishedCharts")]=0)}}},648:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"header",computed:{userName:function(){return window.user?window.user.userName:"管理员"},csrf:function(){return this.$store.state.csrf["X-XSRF-TOKEN"]}},methods:{logout:function(){document.querySelector("#logoutForm").submit()}}}},649:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(1159),s=a.n(n),r=a(1161),i=a.n(r);t.default={components:{wHeader:s.a,wSidebar:i.a},data:function(){return{top:""}},mounted:function(){var e=this;this.$nextTick(function(){document.getElementById("content").addEventListener("scroll",e.onScroll)})},methods:{onScroll:function(){this.top=document.getElementById("content").scrollTop},backToTop:function(){document.getElementById("content").scrollTop=0}}}},650:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(109),s=a.n(n),r=a(67),i=a.n(r);t.default={data:function(){return{}},computed:{currentPath:function(){return this.$route.path.slice(0,15)}},methods:{initItem:function(){var e=!0,t=!1,a=void 0;try{for(var n,r=i()(s()(this.$store.state.oldBaseInfo));!(e=(n=r.next()).done);e=!0){var o=n.value;this.$store.state.oldBaseInfo[o]="quotaDefinitions"==o?[null]:"formulaUnits"==o?"%":""}}catch(e){t=!0,a=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw a}}}}}},651:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(146),s=a.n(n),r=a(665),i=a.n(r),o=a(194),l=a(46),c=a(589),u=a.n(c),d=a(590),_=a.n(d);t.default={props:{previewData:{type:[Object,Boolean]},updatedCallBack:{type:Function}},components:{IEcharts:o.a,EchartsBox:u.a,webExcel:_.a},data:function(){return{indicatorsInfo:"",indicatorsTable:[],indicatorsResult:"",charts:[],spreadCharts:[],qualityPics:[],effectivePics:[],resultDom:"",reasonDOM:"",improveDOM:"",effectDOM:""}},computed:{formula:function(){return this.indicatorsInfo.molecular+" / "+this.indicatorsInfo.denominator+" * "+this.indicatorsInfo.percentage+" "+this.indicatorsInfo.formulaUnits}},watch:{previewData:function(e,t){if(e){var a=i()(e.quotaBaseInfoDOs,1);this.indicatorsInfo=a[0],this.indicatorsTable=e.quotaTables;var n=i()(e.quotaResultAnalysisDOs,1);this.indicatorsResult=n[0],this.resultDom=this.indicatorsResult&&this.indicatorsResult.reasonAnalysis&&JSON.parse(this.indicatorsResult.reasonAnalysis).resultAnalysis||"暂无",this.reasonDOM=this.indicatorsResult&&this.indicatorsResult.reasonAnalysis&&JSON.parse(this.indicatorsResult.reasonAnalysis).reasonAnalysis||"暂无",this.improveDOM=this.indicatorsResult&&this.indicatorsResult.improvementMeasure||"暂无",this.effectDOM=this.indicatorsResult&&this.indicatorsResult.effectiveAnalysis||"暂无文字说明"}}},beforeRouteEnter:function(e,t,a){l.a.previewData({quotaIds:e.query.quotaId}).then(function(e){a(function(t){var a=e.result[0],n=i()(a.quotaBaseInfoDOs,1);t.indicatorsInfo=n[0],t.indicatorsTable=a.quotaTables;var s=i()(a.quotaResultAnalysisDOs,1);t.indicatorsResult=s[0],t.resultDom=t.indicatorsResult.reasonAnalysis&&JSON.parse(t.indicatorsResult.reasonAnalysis).resultAnalysis||"暂无",t.reasonDOM=t.indicatorsResult.reasonAnalysis&&JSON.parse(t.indicatorsResult.reasonAnalysis).reasonAnalysis||"暂无",t.improveDOM=t.indicatorsResult.improvementMeasure||"暂无",t.effectDOM=t.indicatorsResult.effectiveAnalysis||"暂无文字说明"})})},methods:{htmlToCanvas:function(){this.pagination(),window.print()},pagination:function(){for(var e=document.getElementsByClassName("pdf-pagination"),t=0,a=0;a<e.length;a++)1500-(e[a].offsetTop-t)<=e[a].offsetHeight&&(t=e[a].offsetTop,e[a-1].className=e[a-1].className+" pagination")},allChartsFinished:function(){this[s()("allChartsFinished")]=this[s()("allChartsFinished")]||0,++this[s()("allChartsFinished")]===this.indicatorsTable.length&&(this.previewData&&this.updatedCallBack(document.getElementById("preview")),this[s()("allChartsFinished")]=0)}},updated:function(){this.previewData&&0===this.indicatorsTable.length&&this.$nextTick(function(){this.updatedCallBack(document.getElementById("preview"))})}}},652:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(210),s=a.n(n),r=a(109),i=a.n(r),o=a(67),l=a.n(o),c=a(82),u=a.n(c),d=a(106),_=a(46),f=a(204),p=a.n(f);a(47);t.default={data:function(){return{floorId:"",deptId:"",indicatorDef:"",defaultSign:"%",signs:[{key:"%",mark:"%"},{key:"‰",mark:"‰"}],validate:{floorId:!1,departmentId:!1,quotaName:!1,quotaTypeId:!1,molecular:!1,denominator:!1,percentage:!1,quotaDefinitions:[]},stepNum:""}},computed:u()({},a.i(d.a)(["floors","depts","types"]),{oldBaseInfo:function(){return this.$store.state.oldBaseInfo}}),beforeRouteEnter:function(e,t,a){e.query.quotaId?_.a.getOldBaseInfo(e.query.quotaId).then(function(e){a(function(t){if(e.responseData){var a=!0,n=!1,s=void 0;try{for(var r,o=l()(i()(t.$store.state.oldBaseInfo));!(a=(r=o.next()).done);a=!0){var c=r.value;t.$store.state.oldBaseInfo[c]=e.responseData[c]}}catch(e){n=!0,s=e}finally{try{!a&&o.return&&o.return()}finally{if(n)throw s}}}})}):a()},methods:{addQuotaDefinition:function(){if(this.oldBaseInfo.quotaDefinitions.length>=10)return void this.$message.error("指标定义请不要超过10条！");this.oldBaseInfo.quotaDefinitions.push(null)},deleteQuotaDefinition:function(e){this.oldBaseInfo.quotaDefinitions.splice(e,1)},gotoStep:function(e){var t=this;this.validate={floorId:this.$validate.value(this.oldBaseInfo.floorId),departmentId:this.$validate.value(this.oldBaseInfo.departmentId),quotaName:this.$validate.string(this.oldBaseInfo.quotaName),quotaTypeId:this.$validate.value(this.oldBaseInfo.quotaTypeId),quotaDefinitions:this.$validate.array(this.oldBaseInfo.quotaDefinitions),molecular:this.$validate.string(this.oldBaseInfo.molecular),denominator:this.$validate.string(this.oldBaseInfo.denominator),percentage:this.$validate.number(this.oldBaseInfo.percentage)};var a=!0,n=!1,r=void 0;try{for(var i,o=l()(s()(this.validate));!(a=(i=o.next()).done);a=!0){var c=i.value;if(c.constructor==Array){var u=!0,d=!1,_=void 0;try{for(var f,h=l()(c);!(u=(f=h.next()).done);u=!0){if(f.value)return!1}}catch(e){d=!0,_=e}finally{try{!u&&h.return&&h.return()}finally{if(d)throw _}}}else if(c)return!1}}catch(e){n=!0,r=e}finally{try{!a&&o.return&&o.return()}finally{if(n)throw r}}this.stepNum=2;var v={denominator:this.oldBaseInfo.denominator,departmentId:this.oldBaseInfo.departmentId,floorId:this.oldBaseInfo.floorId,molecular:this.oldBaseInfo.molecular,percentage:this.oldBaseInfo.percentage,quotaName:this.oldBaseInfo.quotaName,quotaTypeId:this.oldBaseInfo.quotaTypeId,quotaDefinitions:this.oldBaseInfo.quotaDefinitions,quotaId:this.$route.query.quotaId||"",formulaUnits:this.oldBaseInfo.formulaUnits};p.a.start(),this.$route.query.quotaId?this.$service.editBaseInfo(v).then(function(a){"0"==a.responseCode?t.$router.push({name:"entryStep"+e,query:{quotaId:t.$route.query.quotaId,isEdit:t.$route.query.isEdit}}):p.a.end()}):this.$service.createBaseInfo(v).then(function(a){"0"==a.responseCode?t.$router.push({name:"entryStep"+e,query:{quotaId:a.responseData.quotaId}}):p.a.end()})}}}},653:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(82),s=a.n(n),r=a(145),i=a.n(r),o=a(46),l=a(590),c=a.n(l);t.default={components:{webExcel:c.a},data:function(){return{tableData:[[{x:2,y:1,content:"xx"},{x:1,y:1,content:"xx2"}],[{x:1,y:1,content:"yy"}]],indicatorsTable:[],args:[],currentPage:1}},computed:{currentTableData:function(){return this.indicatorsTable[this.currentPage-1]}},beforeRouteEnter:function(e,t,a){o.a.getOldTable(e.query.quotaId).then(function(e){a(function(t){e.result&&(t.indicatorsTable=e.result)})})},methods:{unSaveAlert:function(){this.$alert(this.$createElement("p",{class:"confirm-message"},[this.$createElement("svg",null,[this.$createElement("use",{attrs:{"xlink:href":"#icon-zhuyi"}},null)]),this.$createElement("span",null,"您对表格有所修改，但尚未保存，请点击表格右上角进行保存！")]),"",{confirmButtonText:"知道了"})},confirmGotoStep:function(e){this.args.some(function(e){return!0===e})?this.unSaveAlert():this.gotoStep(e)},gotoStep:function(e){var t=this.$route.query.isEdit?i()({quotaId:this.$route.query.quotaId},{isEdit:this.$route.query.isEdit}):{quotaId:this.$route.query.quotaId};this.$router.push({name:"entryStep"+e,query:t})},dependEdit:function(e,t){"del"!=e?this.$set(this.args,parseInt(t),e):this.args.splice(t,1)},addTable:function(){this.indicatorsTable.push({tableData:function(e,t){for(var a=[],n=0;n<8;n++){for(var s=[],r=0;r<10;r++)s.push("");a.push(s)}return a}(),cellInfo:!0,tableId:"",new:!0,tableName:"表格名称"})},changePage:function(e){if(this.args.some(function(e){return!0===e}))return this.unSaveAlert(),!1;this.currentPage=e},changePageProxy:function(e){this.currentPage=e},save:function(e){var t=this,a=this.currentPage-1;return e=s()({},e,{sort:a}),this.indicatorsTable[a].new?this.$service.saveTable(e).then(function(e){if("0"==e.responseCode)return t.indicatorsTable.splice(a,1,e.result),e}):this.$service.updateTable(e).then(function(e){if("0"==e.responseCode)return t.indicatorsTable=e.result.filter(function(e){return"n"===e.isDeleted}),e})},vif:function(e){return console.log(e,this.currentPage-1),e===this.currentPage-1},del:function(e){var t=this,a=this.currentPage-1;return e=s()({},e,{sort:a},{quotaId:this.$route.query.quotaId}),this.$service.deleteTable(e).then(function(e){if("0"==e.responseCode)return t.indicatorsTable.splice(a,1),t.currentPage=Math.min(a+1,t.indicatorsTable.length)||1,e})}},mounted:function(){var e=this;this.$refs.pagonation.$el.addEventListener("click",function(t){e.args.some(function(e){return!0===e})&&(t.stopPropagation(),e.unSaveAlert())},!0)}}},654:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(215),s=a.n(n),r=a(212),i=a.n(r),o=a(108),l=a.n(o),c=a(145),u=a.n(c),d=a(991),_=(a.n(d),a(992)),f=(a.n(_),a(990)),p=(a.n(f),a(1180)),h=(a.n(p),a(46)),v=a(47);t.default={data:function(){return{tempData:{},reason:"",improve:"",result:"",loading:!1,qualityAnalysisUid:[],effectiveAnalysisUid:[],effectIsClicked:!1,filelist1:[],filelist2:[],oldResult:{resultAnalysis:"",effectiveAnalysis:"",improvementMeasure:"",reasonAnalysis:""},editorOption:{placeholder:"请输入内容",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["image"]]}},headers:{Accept:"application/json, text/plain, */*","X-XSRF-TOKEN":"c3a26c4a-6493-443e-a61e-48e92d68d077"}}},computed:{},beforeRouteEnter:function(e,t,a){console.log(e),e.query.isEdit?h.a.getOldResult(e.query.quotaId).then(function(e){a(function(t){if(e.responseData){var a=v.a.deepClone(e.responseData);a.resultAnalysis=JSON.parse(a.reasonAnalysis).resultAnalysis,a.reasonAnalysis=JSON.parse(a.reasonAnalysis).reasonAnalysis,t.oldResult=a}})}):a()},methods:{gotoStep:function(e){var t=this.$route.query.isEdit?u()({quotaId:this.$route.query.quotaId},{isEdit:this.$route.query.isEdit}):{quotaId:this.$route.query.quotaId};this.$router.push({name:"entryStep"+e,query:t})},save:function(){var e=this,t={effectiveAnalysis:this.oldResult.effectiveAnalysis,improvementMeasure:this.oldResult.improvementMeasure,quotaId:this.$route.query.quotaId,reasonAnalysis:l()({reasonAnalysis:this.oldResult.reasonAnalysis,resultAnalysis:this.oldResult.resultAnalysis})};this.loading=!0,this.$route.query.isEdit?this.$service.saveOldEntryInfo(t).then(function(t){"0"==t.responseCode&&(e.$message.success("保存成功！"),e.$router.push({path:"/indicator/libs"})),e.loading=!1}):this.$service.saveNewEntryInfo(t).then(function(t){"0"==t.responseCode&&(e.$message.success("保存成功！"),e.$router.push({path:"/indicator/libs"})),e.loading=!1})},uploadedCallback:function(e,t,a){if(0!=e.responseCode||0!=e.code)return void this.$message.error(e.responseMessage);this.$message.success(e.responseMessage),this.addImgRange=this.$refs[this.cacheEditorRefName].quill.getSelection(),console.log(this.$refs),console.log(this.cacheEditorRefName),this.$refs[this.cacheEditorRefName].quill.insertEmbed(null!=this.addImgRange?this.addImgRange.index:0,"image","/getphotobyte?fileId="+e.results.fileId),this.$refs[this.cacheEditorRefName].quill.setSelection(null!=this.addImgRange?this.addImgRange.index+1:1,1)},beforeUpload:function(e){var t="image/jpeg"==e.type||"image/png"==e.type;return t||this.$message.error("上传图片只能是jpg/jpeg/png格式！"),t}},components:{quillEditor:p.quillEditor},mounted:function(){var e=this,t=function(t){return function(){var a=i()(s.a.mark(function a(n){var r;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e.addImgRange=e.$refs[t].quill.getSelection(),e.cacheEditorRefName=t,n&&(r=e.$refs.imgUpload,r.$el.click());case 3:case"end":return a.stop()}},a,this)}));return function(e){return a.apply(this,arguments)}}()};console.log(e.$refs),e.$refs.editor.quill.getModule("toolbar").addHandler("image",t("editor")),e.$refs.editor2.quill.getModule("toolbar").addHandler("image",t("editor2")),e.$refs.editor3.quill.getModule("toolbar").addHandler("image",t("editor3")),e.$refs.editor4.quill.getModule("toolbar").addHandler("image",t("editor4"))}}},655:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(299),s=a.n(n),r=a(215),i=a.n(r),o=a(146),l=a.n(o),c=a(212),u=a.n(c),d=a(82),_=a.n(d),f=a(106),p=a(591),h=a.n(p),v=a(46),m=a(661),g=a(320),b=a.n(g);t.default={components:{Preview:h.a},data:function(){return{tableData:[],indicator:"",floorId:"",deptId:"",person:"",dateRange:[],tableLoading:!0,indicatorDialogVisible:!1,visible2:!1,params:{},totalPages:0,pageSize:10,curPage:1,delId:"",previewData:!1,previewDatas:!1}},computed:_()({},a.i(f.a)(["floors","depts"]),{tableIndex:function(){}}),created:function(){this.loadIndicators()},methods:{search:function(){this.curPage=1,this.loadIndicators()},reset:function(){this.indicator="",this.floorId="",this.deptId="",this.person="",this.dateRange=[],this.pageSize=10,this.curPage=1,this.loadIndicators()},deleteRow:function(e){this.indicatorDialogVisible=!0,this.delId=e.quotaId},edit:function(e){this.$router.push({path:"/indicator/entryStep1",query:{quotaId:e.quotaId,isEdit:!0}})},confirmDel:function(){var e=this;this.indicatorDialogVisible=!1,this.tableLoading=!0,this.$service.deleteIndicator(this.delId).then(function(t){0!=t.responseCode?(e.tableLoading=!1,e.$message.error(t.responseMessage)):(e.$message.success("删除成功！"),e.loadIndicators())})},loadIndicators:function(){var e=this;this.tableLoading=!0,this.params={quotaName:this.indicator,floorId:this.floorId,departmentId:this.deptId,userName:this.person,recordStartDate:null!=this.dateRange[0]&&0!=this.dateRange.length?this.$dateHandle.dateArrayFormat(this.dateRange)[0]+" 00:00:00":"",recordEndDate:null!=this.dateRange[0]&&0!=this.dateRange.length?this.$dateHandle.dateArrayFormat(this.dateRange)[1]+" 23:59:59":"",startIndex:this.curPage-1,pageSize:this.pageSize},this.$service.getIndicators(this.params).then(function(t){e.tableLoading=!1;var a=[t.responseData.resultList,t.responseData.totalCount];e.tableData=a[0],e.totalPages=a[1]})},handleSizeChange:function(e){this.pageSize=e,this.loadIndicators()},handleCurrentChange:function(e){this.curPage=e,this.loadIndicators()},handleSelectionChange:function(e){this.selectedUrl=e.map(function(e){return e.quotaId})},addPdf:function(e){var t=this;return u()(i.a.mark(function n(){var s,r,o;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("---addPdf---"),n.next=3,a.i(m.a)(e);case 3:s=n.sent,r=t,o=t.zip,o.file(r[l()("pdfIndex")]+".pdf",s),r[l()("pdfIndex")]++,t.previewData=t.previewDatas.next().value,console.log("this.previewData： ",t.previewData),t.previewData||o.generateAsync({type:"blob"}).then(function(e){r[l()("pdfIndex")]=void 0;var t=document.createElement("a");t.href=window.URL.createObjectURL(e),t.download="pdf",t.click(),window.URL.revokeObjectURL(t.href),r.loadingInstance.close()});case 11:case"end":return n.stop()}},n,t)}))()},pdf:function(){var e=this;this.loadingInstance=s.a.service({fullscreen:!0,text:"pdf生成中……"}),v.a.previewData({quotaIds:this.selectedUrl}).then(function(t){function a(){var e,a;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e=t.result,a=0;case 2:if(!(a<e.length)){n.next=8;break}return n.next=5,e[a];case 5:a++,n.next=2;break;case 8:return n.abrupt("return",!1);case 9:case"end":return n.stop()}},n,this)}var n=i.a.mark(a);e.previewDatas=a(),e.previewData=e.previewDatas.next().value,e.zip=new b.a,e.pdfIndex=1,e[l()("pdfIndex")]=1})}}}},656:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return excelFunctions}),__webpack_require__.d(__webpack_exports__,"a",function(){return excelCharts});var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray__=__webpack_require__(213),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__=__webpack_require__(67),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_array_from__=__webpack_require__(107),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_array_from___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_array_from__),__WEBPACK_IMPORTED_MODULE_3_echarts__=__webpack_require__(162),__WEBPACK_IMPORTED_MODULE_3_echarts___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_echarts__),disposeRange=function(e){var t=e.toUpperCase().match(/([A-Z]+|[0-9]+)/g),a=t[1],n=t[0].charCodeAt(0),s=t[3],r=t[2].charCodeAt(0),i=__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_array_from___default()({length:s-a+1},function(e,t){return+a+t}),o=__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_array_from___default()({length:r-n+1},function(e,t){return String.fromCharCode(+n+t)}),l=[];return i.forEach(function(e){o.forEach(function(t){l.push(t+e)})}),l},excelFunctions={SUM:{name:"求和",func:function(e){return e.replace(/sum/i,"").replace(/[a-z]+\d+\:[a-z]+\d+/gi,function(e){return"("+disposeRange(e).join("+")+")"}).replace(/,/g,"+")}},AVERAGE:{name:"求平均数",func:function(e){var t=e.replace(/AVERAGE/i,"").replace(/[a-z]+\d+\:[a-z]+\d+/gi,function(e){return"("+disposeRange(e).join("+")+")"}).replace(/,/g,"+");return"("+t+"/"+t.match(/[a-z]+\d+/gi).length+")"}}},transpose=function(e){return e[0].map(function(t,a){var n=[],s=!0,r=!1,i=void 0;try{for(var o,l=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default()(e);!(s=(o=l.next()).done);s=!0){var c=o.value;n=[].concat(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default()(n),[c[a]])}}catch(e){r=!0,i=e}finally{try{!s&&l.return&&l.return()}finally{if(r)throw i}}return n})},checkData=function(e){var t=[],a=[],n=[],s=!0,r=!1,i=void 0;try{for(var o,l=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default()(e);!(s=(o=l.next()).done);s=!0){var c=o.value,u=!0,d=!1,_=void 0;try{for(var f,p=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default()(c);!(u=(f=p.next()).done);u=!0){var h=f.value;/^\d+(\.\d+)?$/.test(String(h))?t.push(h):/^\d+(\.\d+)?%$/.test(String(h))?a.push(h):n.push(h)}}catch(e){d=!0,_=e}finally{try{!u&&p.return&&p.return()}finally{if(d)throw _}}}}catch(e){r=!0,i=e}finally{try{!s&&l.return&&l.return()}finally{if(r)throw i}}return n.length>0?{type:"error",msg:"您选中的单元格包含了不合法的字符，请确保除首行首列外，其余的单元格均为数字或百分数"}:0===t.length?{type:"precent"}:{type:"mix"}},chartDataFilter=function(e){var t=e.filter(function(e){return""!==e.join("")});if(0===t.length)return{column:[],row:[],data:[]};t=transpose(transpose(t).filter(function(e){return""!==e.join("")}));var a=t.map(function(e){return e[0]}),n=t[0],s=t,r=function(e){return/^\d+(\.\d+)?%?$/.test(String(e))};""===t[0][0]||null===t[0][0]?(s=s.slice(1).map(function(e){return e.slice(1)}),n=n.slice(1),a=a.slice(1)):r(n[n.length-1])?r(a[a.length-1])?a=a.map(function(e,t){return"系列"+(t+1)}):(n=n.slice(1),s=s.map(function(e){return e.slice(1)})):(a=a.slice(1),s=s.slice(1),r(a[a.length-1])?a=a.map(function(e,t){return"系列"+(t+1)}):(n=n.slice(1),s=s.map(function(e){return e.slice(1)}))),s=s.map(function(e){return e.map(function(e){return""===e?0:e})});var i=checkData(s);return"error"===i.type?i.msg:{column:a,row:n,data:s,type:i.type}},excelCharts={line:{name:"折线图",func:function(e){var t=chartDataFilter(e.transpose?transpose(e.data):e.data);return{title:{top:10,left:"center",text:e.title},legend:{padding:[0,5],bottom:5,data:t.column,formatter:function(e){return __WEBPACK_IMPORTED_MODULE_3_echarts___default.a.format.truncateText(e,120,"14px Microsoft Yahei","…")},tooltip:{show:!0}},tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:t.row},yAxis:{type:"value"},series:t.data.map(function(e,a){return{data:e,type:"line",name:t.column[a]}})}}},bar:{name:"柱状图（簇形）",func:function(e){var t=chartDataFilter(e.transpose?transpose(e.data):e.data);return{title:{top:10,left:"center",text:e.title},legend:{padding:[0,5],bottom:5,data:t.column,formatter:function(e){return __WEBPACK_IMPORTED_MODULE_3_echarts___default.a.format.truncateText(e,120,"14px Microsoft Yahei","…")},tooltip:{show:!0}},tooltip:{trigger:"axis"},calculable:!0,xAxis:[{type:"category",data:t.row}],yAxis:[{type:"value"}],series:t.data.map(function(e,a){return{data:e,type:"bar",name:t.column[a]}})}}},pie:{name:"饼图",func:function(e){var t=chartDataFilter(e.transpose?transpose(e.data):e.data);return console.log(t),{title:{top:10,left:"center",text:e.title},legend:{padding:[0,5],bottom:5,data:t.row},tooltip:{trigger:"item",formatter:"{b} : {c} ({d}%)"},series:[{data:t.data[0].map(function(e,a){return{value:e,name:t.row[a]}}),type:"pie",radius:"50%"}]}}},pareto:{name:"柏拉图",func:function func(dataSourse){var filtedData=chartDataFilter(dataSourse.transpose?transpose(dataSourse.data):dataSourse.data),sumArr=transpose(filtedData.data).map(function(ele){return eval(ele.join("+"))}),sum=eval(sumArr.join("+")),proportion=sumArr.map(function(e){return e/sum}),sortArr=sumArr.map(function(e,t){return{name:filtedData.row[t],value:e,proportion:proportion[t]}});sortArr.sort(function(e,t){return e.value<t.value});var sortedProportion=sortArr.map(function(e){return e.proportion});return sortedProportion.reduce(function(e,t,a){return sortedProportion[a]=e+t,e+t}),{tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}},formatter:function(e){return console.log(e),e[1].data=(100*e[1].data).toFixed(2)+"%",e[0].name+": "+e[0].data+"<br /> "+e[1].data}},legend:{padding:[0,5],bottom:5,data:sortArr.map(function(e){return e.name})},xAxis:[{type:"category",data:filtedData.row,axisPointer:{type:"shadow"}}],yAxis:[{type:"value"},{type:"value",name:"占比",min:0,max:1,axisLabel:{formatter:function(e){return 100*e+" %"}}}],series:[{type:"bar",data:sortArr.map(function(e){return e.value}),barCategoryGap:0,itemStyle:{borderColor:"rgba(0,0,0,0.3)",borderWidth:1}},{type:"line",data:sortedProportion,yAxisIndex:1}]}}}}},657:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(618),s=(a.n(n),a(617)),r=a.n(s),i=a(29),o=a(622),l=a.n(o),c=a(611),u=a(612),d=a(46),_=a(47),f=a(613),p=a(614),h=a(615),v=a(616),m=a(621),g=(a.n(m),a(620)),b=(a.n(g),a(204)),y=a.n(b),C=a(619),E=(a.n(C),a(106),a(623));a.n(E);i.default.config.productionTip=!1,i.default.use(r.a),i.default.prototype.$service=d.a,i.default.prototype.$handleObject=_.a,i.default.prototype.$dateHandle=f.a,i.default.prototype.$validate=v.a,i.default.prototype.toBaseEChart=p.a,i.default.prototype.toSpreadEChart=h.a;var w={};window._csrf||(window._csrf={headerName:"X-XSRF-TOKEN",token:"global"});var I=window._csrf.headerName,D=window._csrf.token;w[I]=D,u.a.commit("CSRF",w),c.a.beforeEach(function(e,t,a){y.a.start(),a()}),c.a.afterEach(function(e,t,a){y.a.done()}),new i.default({el:"#app",router:c.a,store:u.a,template:"<App/>",components:{App:l.a},beforeCreate:function(){u.a.dispatch("loadDepts"),u.a.dispatch("loadFloors"),u.a.dispatch("loadTypes")}})},658:function(e,t,a){"use strict";t.a={userInfoAddr:"/user/info/get",floorsAddr:"/quality/floor/list",deptsAddr:"/quality/department/list",typesAddr:"/quality/quotaType/list",createBaseInfoAddr:"/quality/quotaBaseInfo/create",editBaseInfoAddr:"/quality/quotaBaseInfo/edit",generateTableAddr:"/quality/quotaTable/generateQuotaTable",oldBaseInfoAddr:"/quality/quotaBaseInfo/detail?quotaId=",oldTableInfoAddr:"/quality/quotaTable/getNewQuotaTable?quotaId=",saveTableAddr:"/quality/quotaTable/saveQuotaTable",updateTableAddr:"/quality/quotaTable/updateQuotaTable",deleteTableAddr:"/quality/quotaTable/deleteNewQuotaTable",saveOldEntryInfoAddr:"/quality/result/analysis/edit",saveNewEntryInfoAddr:"/quality/result/analysis/create",saveOldChartsAddr:"/quality/quotaTable/updateQuotaTableElement",fileUploadAddr:"/file/upload",oldResultAddr:"/quality/result/analysis/detail?quotaId=",indicatorsAddr:"/quality/quotaBaseInfo/list?",deleteIndicatorAddr:"/quality/quotaBaseInfo/delete?quotaId=",previewAddr:"/quality/pdf/view?"}},659:function(e,t,a){"use strict";var n=a(211),s=a.n(n),r=a(300),i=a.n(r),o=a(624),l=a.n(o);l.a.interceptors.response.use(function(e){return"0"!=e.data.responseCode&&i.a.error(e.data.responseMessage),e.data},function(e){switch(e.response.status){case 401:window.location.href="/login";break;case 404:i.a.error("找不到网络资源！"+e.response.status);break;case 500:i.a.error("服务器错误！"+e.response.status);break;case-1:i.a.error("服务器无响应！"+e.response.status)}return console.log(e.response),s.a.reject(e.response)}),t.a=l.a},660:function(e,t,a){"use strict";var n=function(e){return new s(e)},s=function(e){this.value=e},r=function(e){var t=i(e).toString(),a=0;return t.indexOf(".")>0&&(a=t.split(".")[1].length),a},i=function(e){return e.toString().indexOf("%")>0?parseFloat(e)/100:e};s.prototype.add=function(e){var t=r(this.value),a=r(e),n=t>a?t:a,s=(Math.pow(10,n)*i(this.value)+Math.pow(10,n)*i(e))/Math.pow(10,n);return this.value.toString().indexOf("%")>0&&e.toString().indexOf("%")>0?100*s+"%":s},s.prototype.sub=function(e){var t=r(this.value),a=r(e),n=t>a?t:a,s=(Math.pow(10,n)*i(this.value)-Math.pow(10,n)*i(e))/Math.pow(10,n);return this.value.toString().indexOf("%")>0&&e.toString().indexOf("%")>0?100*s+"%":s},s.prototype.div=function(e){var t=r(this.value),a=r(e),n=t>a?t:a,s=Math.pow(10,n)*i(this.value)/(Math.pow(10,n)*i(e));return this.value.toString().indexOf("%")>0&&e.toString().indexOf("%")>0?100*s+"%":s},s.prototype.mul=function(e){var t=r(this.value),a=r(e),n=t>a?t:a,s=Math.pow(10,n)*i(this.value)*Math.pow(10,n)*i(e)/Math.pow(10,2*n);return this.value.toString().indexOf("%")>0&&e.toString().indexOf("%")>0?100*s+"%":s},t.a=n},661:function(e,t,a){"use strict";var n=a(1021),s=a.n(n),r=a(1038),i=a.n(r),o=a(320);a.n(o);t.a=function(e){return s()(e,{allowTaint:!0}).then(function(e){var t=e.width,a=e.height,n=t/592.28*841.89,s=a,r=0,o=592.28/t*a,l=e.toDataURL("image/jpeg",1),c=new i.a("","pt","a4");if(s<n)c.addImage(l,"JPEG",0,0,595.28,o);else for(;s>0;)c.addImage(l,"JPEG",0,r,595.28,o),s-=n,r-=841.89,s>0&&c.addPage();return c.output("blob")})}},989:function(e,t){},990:function(e,t){},991:function(e,t){},992:function(e,t){},993:function(e,t){},994:function(e,t){},995:function(e,t){},996:function(e,t){},997:function(e,t){},998:function(e,t){},999:function(e,t){}},[657]);
//# sourceMappingURL=app.e18ac57686463858ea4d.js.map